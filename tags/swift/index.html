<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Tag: swift - onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/gumroad">Gumroad</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">swift</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-28T21:34:39.000Z" title="2021-02-28T21:34:39.000Z">2021-02-28</time><span class="level-item">a few seconds read (About 48 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-name-Boolean-property-in-Swift/">How to name Boolean property in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/787">#787</a></strong></p>
<p>In Swift, property, especially for Boolean flagging, uses the regular verb form for the third person. There are few exceptions, such as <code>enable</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSManagedObjectContext</span>.automaticallyMergesChangesFromParent</span><br><span class="line"><span class="type">UIView</span>.clipsToBounds</span><br><span class="line"><span class="type">UIView</span>.translatesAutoresizingMaskIntoConstraints</span><br><span class="line"><span class="type">SwiftUI</span>.<span class="type">Transaction</span>.disablesAnimations</span><br><span class="line"><span class="type">UIScrollView</span>.scrollsToTop</span><br><span class="line"><span class="type">NSView</span>.isHidden</span><br><span class="line"><span class="type">UndoManager</span>.enableUndoRegistration</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-02-28 22:34:53</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-28T21:15:24.000Z" title="2021-02-28T21:15:24.000Z">2021-02-28</time><span class="level-item">a minute read (About 135 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-with-block-configure-in-Swift/">How to use with block configure in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/786">#786</a></strong></p>
<p>Sometimes we need to update some properties between objects, for example</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">book.name = updatedBook.name</span><br><span class="line">book.page = updatedBook.page</span><br><span class="line">book.publishedAt = updatedBook.publishedAt</span><br></pre></td></tr></table></figure>

<p>Repeating the caller <code>book</code> is tedious and error-prone. In Kotlin, there is <a href="https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/with.html">with</a> block which is handy to access the receiver properties and methods without referring to it.</p>
<figure class="highlight kt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">with(book) &#123;</span><br><span class="line">    name = updatedBook.name</span><br><span class="line">    page = updatedBook.page</span><br><span class="line">    publishedAt = updatedBook.publishedAt</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In Swift, there are no such thing, we can write some extension like</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Book</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">update</span><span class="params">(with anotherBook: Book)</span></span> &#123;</span><br><span class="line">        name = anotherBook.name</span><br><span class="line">        page = anotherBook.page</span><br><span class="line">        publishedAt = anotherBook.publishedAt</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Or simply, we can just use <code>forEach</code> with just that book</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[book].forEach &#123;</span><br><span class="line">    $<span class="number">0</span>.name = updatedBook.name</span><br><span class="line">    $<span class="number">0</span>.page = updatedBook.page</span><br><span class="line">    $<span class="number">0</span>.publishedAt = updatedBook.publishedAt</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-26T12:14:41.000Z" title="2021-02-26T12:14:41.000Z">2021-02-26</time><span class="level-item">7 minutes read (About 1088 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Core-Data/">How to use Core Data</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/785">#785</a></strong></p>
<h2 id="Some-links-to-learn"><a href="#Some-links-to-learn" class="headerlink" title="Some links to learn"></a>Some links to learn</h2><h3 id="Core-Data"><a href="#Core-Data" class="headerlink" title="Core Data"></a>Core Data</h3><ul>
<li><p><a href="https://www.donnywals.com/responding-to-changes-in-a-managed-object-context/">Responding to changes in a managed object context</a></p>
<blockquote>
<p>Calling mergeChanges on a managed object context will automatically refresh any managed objects that have changed. This ensures that your context always contains all the latest information. Note that you don‚Äôt have to call mergeChanges on a viewContext when you set its automaticallyMergesChangesFromParent property to true. In that case, Core Data will handle the merge on your behalf.</p>
</blockquote>
</li>
<li><p><a href="https://developer.apple.com/documentation/coredata/using_core_data_in_the_background">Using Core Data in the Background</a></p>
<blockquote>
<p>Managed objects retrieved from a context are bound to the same queue that the context is bound to.</p>
</blockquote>
</li>
<li><p><a href="https://davedelong.com/blog/2018/05/09/the-laws-of-core-data/">The Laws of Core Data</a></p>
<blockquote>
<p>The ability to have a child MOC is neat in some corner cases. Let‚Äôs review the core functionality of MOCs in order to understand those cases:</p>
</blockquote>
</li>
</ul>
<blockquote>
<ul>
<li>MOCs load objects from its source (a PSC or another MOC)</li>
<li>MOCs save objects to its source (a PSC or another MOC)</li>
<li>MOCs enforce graph integrity when they save</li>
</ul>
<p>Use Core Data as a local cache</p>
</blockquote>
<ul>
<li><p><a href="https://medium.com/ios-os-x-development/10-core-principles-to-use-coredata-without-blowing-your-head-off-5ed11c623c6b">10 core principles to use CoreData without blowing your head off</a></p>
</li>
<li><p><a href="https://www.avanderlee.com/swift/core-data-performance/">Core Data Performance: 6 tips you should know</a></p>
</li>
<li><p><a href="https://holko.pl/2016/06/23/core-data/">Core Data in iOS 10</a></p>
</li>
<li><p><a href="https://www.donnywals.com/fetching-objects-from-core-data-in-a-swiftui-project/">Fetching objects from Core Data in a SwiftUI project</a></p>
<blockquote>
<p>While you can fetch data from Core Data with @FetchRequest just fine, I tend to avoid it in my apps. The main reason for this is that I‚Äôve always tried to separate my Core Data code from the rest of my application as much as possible.</p>
</blockquote>
</li>
<li><p><a href="https://developer.apple.com/documentation/coredata/nsmanagedobjectcontext/1845237-automaticallymergeschangesfrompa">automaticallyMergesChangesFromParent</a></p>
<blockquote>
<p>A Boolean value that indicates whether the context automatically merges changes saved to its persistent store coordinator or parent context.</p>
</blockquote>
</li>
<li><p><a href="https://developer.apple.com/documentation/coredata/nsfetchrequest">NSFetchRequest</a></p>
<blockquote>
<p>When you execute an instance of NSFetchRequest, it always accesses the underlying persistent stores to retrieve the latest results.</p>
</blockquote>
</li>
<li><p><a href="https://code-craftsman.fr/2015/08/04/saving-core-data-objects/">Saving CoreData objects</a></p>
<blockquote>
<p>This can be misleading. When one see parent store he can understand the parent persitent store of my context hierarchy. However, what is meant by parent store is either: the persistentStoreCoordinator or the parentContext<br>So, if your context was setup with a parent context, changes are commited to his parent but no further. To save it to the persistent store, you‚Äôll need to call save() on contexts all the way up in the hierarchy until you reach the persistent store.</p>
</blockquote>
</li>
<li><p><a href="https://developer.apple.com/documentation/coredata/nsmanagedobjectcontext?language=objc#1653971">NSManagedObjectContext Parent Store</a></p>
</li>
</ul>
<blockquote>
<p>When you save changes in a context, the changes are only committed ‚Äúone store up.‚Äù If you save a child context, changes are pushed to its parent. Changes are not saved to the persistent store until the root context is saved. (A root managed object context is one whose parent context is nil.)</p>
</blockquote>
<ul>
<li><p><a href="https://developer.apple.com/documentation/coredata/nsmanagedobjectcontext/1506672-fetch">NSManagedObjectContext fetch</a></p>
<blockquote>
<p>An object that meets the criteria specified by request (it is an instance of the entity specified by the request, and it matches the request‚Äôs predicate if there is one) and that has been inserted into a context but which is not yet saved to a persistent store, is retrieved if the fetch request is executed on that context.</p>
</blockquote>
</li>
<li><p><a href="https://stackoverflow.com/questions/33533750/core-data-nsbatchdeleterequest-appears-to-leave-objects-in-context">NSBatchDeleteRequest mergeChanges</a></p>
<blockquote>
<p>Changes are not reflected in the context‚Äù. So what you‚Äôre seeing is normal. Batch updates work directly on the persistent store file instead of going through the managed object context, so the context doesn‚Äôt know about them. When you delete the objects by fetching and then deleting, you‚Äôre working through the context, so it knows about the changes you‚Äôre making (in fact it‚Äôs performing those changes for you).</p>
</blockquote>
</li>
<li><p><a href="https://stackoverflow.com/questions/25172760/does-modifying-a-managed-object-in-a-parent-context-propagate-down-to-child-cont">Does modifying a managed object in a parent context propagate down to child contexts when performing a child fetch in Core Data?</a></p>
</li>
</ul>
<blockquote>
<p>mainContext would fetch all the way to the persistent store. Fetches and objectWithID: only go as many levels as they need to.<br>It‚Äôs important to remember that when a context is created it‚Äôs a ‚Äúsnapshot‚Äù of the state of it‚Äôs parent. Subsequent changes to the parent will not be visible in the child unless the child is somehow invalidated</p>
</blockquote>
<h3 id="CloudKit"><a href="#CloudKit" class="headerlink" title="CloudKit"></a>CloudKit</h3><ul>
<li><a href="https://developer.apple.com/documentation/coredata/consuming_relevant_store_changes">Consuming Relevant Store Changes</a></li>
<li><a href="https://fluffy.es/toggle-icloud-sync-nspersistentcloudkitcontainer/">Toggle iCloud sync on/off for NSPersistentCloudKitContainer</a></li>
</ul>
<h3 id="NSFetchedResultsController"><a href="#NSFetchedResultsController" class="headerlink" title="NSFetchedResultsController"></a>NSFetchedResultsController</h3><ul>
<li><a href="https://developer.apple.com/documentation/coredata/nsfetchedresultscontroller">NSFetchedResultsController</a></li>
<li><a href="https://stackoverflow.com/questions/40892147/update-nsfetchedresultscontroller-using-performbackgroundtask">Update NSFetchedResultsController using performBackgroundTask</a></li>
<li><a href="https://cocoacasts.com/exploring-the-fetched-results-controller-delegate-protocol/">Exploring the Fetched Results Controller Delegate Protocol</a></li>
</ul>
<h2 id="How-to-fetch-with-background-context"><a href="#How-to-fetch-with-background-context" class="headerlink" title="How to fetch with background context"></a>How to fetch with background context</h2><p>TLDR: Use  NSFetchedResultsController in backgroundContext</p>
<ul>
<li>If use Core Data as cache: convert to struct</li>
<li>If use NSManagedObject: use FetchRequest on viewContext</li>
</ul>
<h3 id="Approach-1-Treat-Core-Data-as-cache"><a href="#Approach-1-Treat-Core-Data-as-cache" class="headerlink" title="Approach 1: Treat Core Data as cache"></a>Approach 1: Treat Core Data as cache</h3><p>Pros</p>
<ul>
<li>backgroundContext.automaticallyMergesChangesFromParent</li>
<li>Use 1 shared background context to load and updates changes</li>
<li>Convert NSManagedObject to struct</li>
<li>Our struct can have additional logic and properties</li>
<li>Does not need to care about faulting</li>
</ul>
<p>Cons</p>
<ul>
<li>Need to update <code>objectId</code> When context.save, NSManagedObject ‚Äòs <code>objecteId</code> is updated</li>
<li>Need to reload when underlying NSManagedObject changes</li>
<li>Need to handle relationship</li>
</ul>
<p>Instead of plain NSFetchRequest, can use NSFetchedResultsController on background context. In its <code>controllerDidChangeContent</code> convert to struct</p>
<h3 id="Approach-2-viewContext-to-persistent-coordinator"><a href="#Approach-2-viewContext-to-persistent-coordinator" class="headerlink" title="Approach 2: viewContext to persistent coordinator"></a>Approach 2: viewContext to persistent coordinator</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewContext -&gt; persistent coordinator &lt;- backgroundContext</span><br></pre></td></tr></table></figure>

<p>Pros</p>
<ul>
<li>viewContext.automaticallyMergesChangesFromParent</li>
<li>viewContext and background Context stems from persistent container</li>
<li>background context changes object</li>
<li>viewContext read only</li>
</ul>
<p>Cons</p>
<ul>
<li>viewContext blocks main thread</li>
</ul>
<h3 id="Approach-3-viewContext-to-background-context"><a href="#Approach-3-viewContext-to-background-context" class="headerlink" title="Approach 3: viewContext to background context"></a>Approach 3: viewContext to background context</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewContext -&gt; backgroundContext -&gt; persistent coordinator</span><br></pre></td></tr></table></figure>

<p>Pros</p>
<ul>
<li>viewContext.automaticallyMergesChangesFromParent</li>
<li>viewContext reads from backgroundContext, no main queue block</li>
<li>backgroundContext changes</li>
</ul>
<p>Cons</p>
<ul>
<li>???</li>
</ul>
<p>Read more</p>
<ul>
<li><a href="https://github.com/JohnEstropia/CoreStore#architecture">CoreStore architecture</a></li>
</ul>
<h3 id="Approach-4-background-context-gt-mainContext-gt-backgroundContext-gt-persistent-coordinator"><a href="#Approach-4-background-context-gt-mainContext-gt-backgroundContext-gt-persistent-coordinator" class="headerlink" title="Approach 4: background context -&gt; mainContext -&gt; backgroundContext -&gt; persistent coordinator"></a>Approach 4: background context -&gt; mainContext -&gt; backgroundContext -&gt; persistent coordinator</h3><p><a href="https://stackoverflow.com/questions/35961936/child-nsmanagedobjectcontext-update-from-parent">https://stackoverflow.com/questions/35961936/child-nsmanagedobjectcontext-update-from-parent</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">RootContext (private queue) - saves to persistent store</span><br><span class="line">MainContext (main queue) child of RootContext - use for UI (FRC)</span><br><span class="line">WorkerContext (private queue) - child of MainContext - use for updates &amp; inserts</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-02-28 07:58:23</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-25T21:42:08.000Z" title="2021-02-25T21:42:08.000Z">2021-02-25</time><span class="level-item">a minute read (About 172 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-listen-to-remote-changes-in-CloudKit-CoreData/">How to listen to remote changes in CloudKit CoreData</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/783">#783</a></strong></p>
<h2 id="Remove-chane-notification"><a href="#Remove-chane-notification" class="headerlink" title="Remove chane notification"></a>Remove chane notification</h2><p>Read <a href="https://developer.apple.com/documentation/coredata/consuming_relevant_store_changes">Consuming Relevant Store Changes</a></p>
<blockquote>
<p>If the import happens through a batch operation, the save to the store doesn‚Äôt generate an NSManagedObjectContextDidSave notification, and the view misses these relevant updates. Alternatively, the background context may save changes to the store that don‚Äôt affect the current view‚Äîfor example, inserting, modifying, or deleting Shape objects. These changes do generate context save events, so your view context processes them even though it doesn‚Äôt need to.</p>
</blockquote>
<p>Also, the doc mention <code>NSPersistentStoreRemoteChangeNotificationOptionKey</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> remoteChangeKey = <span class="string">"NSPersistentStoreRemoteChangeNotificationOptionKey"</span></span><br><span class="line">        description?.setOption(<span class="literal">true</span> <span class="keyword">as</span> <span class="type">NSNumber</span>,</span><br><span class="line">                                   forKey: remoteChangeKey)</span><br><span class="line"></span><br><span class="line"><span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(</span><br><span class="line">    <span class="keyword">self</span>,</span><br><span class="line">    selector: #selector(fetchChanges),</span><br><span class="line">    name: <span class="type">NSNotification</span>.<span class="type">Name</span>(</span><br><span class="line">        rawValue: <span class="string">"NSPersistentStoreRemoteChangeNotification"</span>), </span><br><span class="line">        object: persistentContainer.persistentStoreCoordinator</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>In the app, the value of <code>NSPersistentStoreRemoteChangeNotificationPostOptionKey</code> is <code>NSPersistentStoreRemoteChangeNotificationOptionKey</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> container = <span class="type">NSPersistentCloudKitContainer</span>(name: name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> description = container.persistentStoreDescriptions.first <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">assertionFailure</span>()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">description.setOption(</span><br><span class="line">    <span class="literal">true</span> <span class="keyword">as</span> <span class="type">NSNumber</span>,</span><br><span class="line">    forKey: <span class="type">NSPersistentHistoryTrackingKey</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">description.setOption(</span><br><span class="line">    <span class="literal">true</span> <span class="keyword">as</span> <span class="type">NSNumber</span>,</span><br><span class="line">    forKey: <span class="type">NSPersistentStoreRemoteChangeNotificationPostOptionKey</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>Updated at</strong> 2021-02-25 22:42:37</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-25T20:56:27.000Z" title="2021-02-25T20:56:27.000Z">2021-02-25</time><span class="level-item">a few seconds read (About 52 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-listen-to-Published-outside-of-SwiftUI-view/">How to listen to Published outside of SwiftUI view</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/782">#782</a></strong></p>
<p>Use <code>$</code> to access <code>Publisher</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Store</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> showsSideWindow: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> anyCancellables = <span class="type">Set</span>&lt;<span class="type">AnyCancellable</span>&gt;()</span><br><span class="line"></span><br><span class="line">store.$showsSideWindow</span><br><span class="line">    .removeDuplicates()</span><br><span class="line">    .throttle(<span class="keyword">for</span>: <span class="number">0.2</span>, scheduler: <span class="type">RunLoop</span>.main, latest: <span class="literal">true</span>)</span><br><span class="line">    .receive(on: <span class="type">RunLoop</span>.main)</span><br><span class="line">    .sink(receiveValue: &#123; shows <span class="keyword">in</span></span><br><span class="line">        preferenceManager.reloadPosition(shows: shows)</span><br><span class="line">    &#125;)</span><br><span class="line">    .store(<span class="keyword">in</span>: &amp;anyCancellables)</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-02-25 21:56:42</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-25T07:51:07.000Z" title="2021-02-25T07:51:07.000Z">2021-02-25</time><span class="level-item">2 minutes read (About 264 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-filter-non-numeric-digit-from-String-in-Swift/">How to filter non numeric digit from String in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/781">#781</a></strong></p>
<p>This sounds like an easy task, but a quick search on Stackoverflow results in this with highest votes <a href="https://stackoverflow.com/questions/29971505/filter-non-digits-from-string">https://stackoverflow.com/questions/29971505/filter-non-digits-from-string</a></p>
<h2 id="CharacterSet-decimalDigits-contains-more-than-just-digits"><a href="#CharacterSet-decimalDigits-contains-more-than-just-digits" class="headerlink" title="CharacterSet.decimalDigits contains more than just digits"></a>CharacterSet.decimalDigits contains more than just digits</h2><p>This splits a string by inverted set of <code>decimalDigits</code> and join them back.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> digits: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> components(separatedBy: <span class="type">CharacterSet</span>.decimalDigits.inverted)</span><br><span class="line">            .joined()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Reading <a href="https://developer.apple.com/documentation/foundation/nscharacterset/1408239-decimaldigits">decimalDigits</a></p>
<blockquote>
<p>Informally, this set is the set of all characters used to represent the decimal values 0 through 9. These characters include, for example, the decimal digits of the Indic scripts and Arabic.</p>
</blockquote>
<p>So <code>decimalDigits</code> does not only contain digits, but also some scripts in other languages. For normal cases this should not be a problem. As <a href="https://ravron.com/2019/07/how-many-decimal-digits-are-there-anyways/">How many decimal digits are there, anyways?
</a> there are 610 valid characters in <code>CharacterSet.decimalDigits</code>. So be aware</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="type">CharacterSet</span>.decimalDigits</span><br><span class="line"></span><br><span class="line"><span class="comment">// U+0031 DIGIT ONE</span></span><br><span class="line">s.<span class="built_in">contains</span>(<span class="string">"1"</span>)  <span class="comment">// true as expected</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// U+1D7D9 MATHEMATICAL DOUBLE-STRUCK DIGIT ONE</span></span><br><span class="line">s.<span class="built_in">contains</span>(<span class="string">"ùüô"</span>)  <span class="comment">// true!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// U+0967 DEVANAGARI DIGIT ONE</span></span><br><span class="line">s.<span class="built_in">contains</span>(<span class="string">"‡•ß"</span>)  <span class="comment">// true!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// U+1811 MONGOLIAN DIGIT ONE</span></span><br><span class="line">s.<span class="built_in">contains</span>(<span class="string">"·†ë"</span>)  <span class="comment">// true!</span></span><br></pre></td></tr></table></figure>

<h2 id="Trimming"><a href="#Trimming" class="headerlink" title="Trimming"></a>Trimming</h2><p>Another method is trimmingCharacters. Note that this removes only characters at the start and end of the string.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string.trimmingCharacters(<span class="keyword">in</span>: <span class="type">CharacterSet</span>(charactersIn: <span class="string">"0123456789"</span>).inverted)</span><br></pre></td></tr></table></figure>

<h2 id="Just-filter"><a href="#Just-filter" class="headerlink" title="Just filter"></a>Just filter</h2><p>A boring but correct solution is to filter characters anywhere in the string.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string.<span class="built_in">filter</span>(<span class="string">"0123456789"</span>.<span class="built_in">contains</span>)</span><br></pre></td></tr></table></figure>

<p>This is more performant than <code>components</code> then <code>join</code> below</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string.components(separatedBy: <span class="type">CharacterSet</span>(charactersIn: <span class="string">"0123456789"</span>).inverted).joined()</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-02-25 08:52:11</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-24T20:13:56.000Z" title="2021-02-24T20:13:56.000Z">2021-02-24</time><span class="level-item">a few seconds read (About 68 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-build-container-view-in-SwiftUI/">How to build container view in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/780">#780</a></strong></p>
<p>To make a container view that accepts child content, we use <code>ViewBuilder</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ContainerView</span>&lt;<span class="title">Content</span>: <span class="title">View</span>&gt;: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> content: <span class="type">Content</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(@<span class="type">ViewBuilder</span> content: () -&gt; <span class="type">Content</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.content = content()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From Swift 5.4, it can synthesize the <code>init</code>, so we can declare <code>resultBuilder</code> for stored property</p>
<pre><code class="swift"><span class="class"><span class="keyword">struct</span> <span class="title">AwesomeContainerView</span>&lt;<span class="title">Content</span>: <span class="title">View</span>&gt;: <span class="title">View</span> </span>{
    @<span class="type">ViewBuilder</span>
    <span class="keyword">let</span> content: <span class="type">Content</span>

    <span class="keyword">var</span> body: some <span class="type">View</span> {
        content
    }
}</code></pre>
<hr>
<p><strong>Updated at</strong> 2021-02-24 21:22:49</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-24T08:12:22.000Z" title="2021-02-24T08:12:22.000Z">2021-02-24</time><span class="level-item">a minute read (About 135 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-tune-performance-with-ButtonBehavior-in-SwiftUI/">How to tune performance with ButtonBehavior in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/779">#779</a></strong></p>
<p>With Xcode 12.4, macOS 11.0 app. Every time we switch the system dark and light mode, the CPU goes up to 100%. Instruments show that there‚Äôs an increasing number of <code>ButtonBehavior</code></p>
<img width="1792" alt="Screenshot 2021-02-24 at 10 12 05" src="https://user-images.githubusercontent.com/2284279/108977356-bfc63580-7688-11eb-9414-075670b76a4f.png">

<h3 id="Suspect-State-in-a-row-in-LazyVStack"><a href="#Suspect-State-in-a-row-in-LazyVStack" class="headerlink" title="Suspect State in a row in LazyVStack"></a>Suspect State in a row in LazyVStack</h3><p>Every cell has its own toggle state</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Cell</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">ToggleState</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> general</span><br><span class="line">        <span class="keyword">case</span> request</span><br><span class="line">        <span class="keyword">case</span> response</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> item: <span class="type">Item</span></span><br><span class="line">    @<span class="type">State</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> toggleState: <span class="type">ToggleState</span> = .general</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toggleButton</span><span class="params">(text: String, state: ToggleState)</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123; <span class="keyword">self</span>.toggleState = state &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(text)</span><br><span class="line">                .foregroundColor(state == toggleState ? <span class="type">Color</span>.label : <span class="type">Color</span>.secondary)</span><br><span class="line">                .fontWeight(state == toggleState ? .bold : .regular)</span><br><span class="line">        &#125;</span><br><span class="line">        .buttonStyle(<span class="type">BorderlessButtonStyle</span>())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Removing the buttons fix the problem. The workaround is to use <code>Text</code> with <code>onTapGesture</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Text</span>(text)</span><br><span class="line">    .foregroundColor(state == toggleState ? <span class="type">Color</span>.label : <span class="type">Color</span>.secondary)</span><br><span class="line">    .fontWeight(state == toggleState ? .bold : .regular)</span><br><span class="line">    .onTapGesture &#123;</span><br><span class="line">        <span class="keyword">self</span>.toggleState = state</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-02-24 10:10:41</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-23T20:27:59.000Z" title="2021-02-23T20:27:59.000Z">2021-02-23</time><span class="level-item">a few seconds read (About 34 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-GroupBox-in-SwiftUI/">How to use GroupBox in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/778">#778</a></strong></p>
<p>For now using <code>GroupBox</code> has these issues in macOS</p>
<ul>
<li>Prevents dragging scroll indicator to scroll</li>
<li>Switch from light to dark mode may cause 100% CPU usage</li>
</ul>
<hr>
<p><strong>Updated at</strong> 2021-02-23 22:02:25</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-18T09:11:04.000Z" title="2021-02-18T09:11:04.000Z">2021-02-18</time><span class="level-item">a minute read (About 115 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-suppress-selector-warning-in-Swift/">How to suppress selector warning in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/777">#777</a></strong></p>
<p>Sometimes we need to use dynamic selector and that triggers warning in Swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Selector</span>(<span class="string">"updateWithCount:"</span>) <span class="comment">// Use '#selector' instead of explicitly constructing a 'Selector'</span></span><br></pre></td></tr></table></figure>

<p>In ObjC we can use clang macro to suppress, like below</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma clang diagnostic push</span></span><br><span class="line"><span class="meta">#pragma clang diagnostic ignored <span class="meta-string">"-Wdeprecated-implementations"</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>) deprecated_objc_method_override &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#pragma clang diagnostic pop</span></span><br></pre></td></tr></table></figure>

<p>But in Swift, we can just use a dummy NSObject that has the needed methods, like</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Dummy</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="meta">@objc</span> <span class="function"><span class="keyword">func</span> <span class="title">update</span><span class="params">(<span class="built_in">count</span>: Int)</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>#selector</code> is just a safer way to construct Selector, they all yield same result as String</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Selector</span>(<span class="string">"updateWithCount:"</span>) <span class="comment">// updateWithCount:</span></span><br><span class="line">#selector(<span class="type">Dummy</span>.update(<span class="built_in">count</span>:)) <span class="comment">// updateWithCount:</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-02-18 10:11:13</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-17T19:25:20.000Z" title="2021-02-17T19:25:20.000Z">2021-02-17</time><span class="level-item">a minute read (About 177 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-simple-search-bar-in-SwiftUI/">How to make simple search bar in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/776">#776</a></strong></p>
<p>We need to use a custom Binding to trigger <code>onChange</code> as <code>onEditingChanged</code> is only called when the user selects the <code>textField</code>, and <code>onCommit</code> is only called when return or done button on keyboard is tapped.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> EasySwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SearchBar</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">Binding</span></span><br><span class="line">    <span class="keyword">var</span> searchText: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> onChange: () -&gt; <span class="type">Void</span></span><br><span class="line">    @<span class="type">State</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> showsCancelButton: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">HStack</span> &#123;</span><br><span class="line">            textField</span><br><span class="line">            cancelButton</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> searchTextBinding: <span class="type">Binding</span>&lt;<span class="type">String</span>&gt; &#123;</span><br><span class="line">        <span class="type">Binding</span>&lt;<span class="type">String</span>&gt;(<span class="keyword">get</span>: &#123;</span><br><span class="line">            searchText</span><br><span class="line">        &#125;, <span class="keyword">set</span>: &#123; newValue <span class="keyword">in</span></span><br><span class="line">            <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">                searchText = newValue</span><br><span class="line">                onChange()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> textField: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="type">SFSymbol</span>.magnifyingglass.rawValue)</span><br><span class="line"></span><br><span class="line">            <span class="type">TextField</span>(<span class="string">"Search"</span>, text: searchTextBinding, onEditingChanged: &#123; isEditing <span class="keyword">in</span></span><br><span class="line">                withAnimation &#123;</span><br><span class="line">                    <span class="keyword">self</span>.showsCancelButton = <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">                onChange()</span><br><span class="line">            &#125;, onCommit: &#123;</span><br><span class="line">                <span class="comment">// No op</span></span><br><span class="line">            &#125;)</span><br><span class="line">            .foregroundColor(.primary)</span><br><span class="line"></span><br><span class="line">            <span class="type">Button</span>(action: &#123;</span><br><span class="line">                <span class="keyword">self</span>.searchText = <span class="string">""</span></span><br><span class="line">            &#125;) &#123;</span><br><span class="line">                <span class="type">Image</span>(systemName: <span class="type">SFSymbol</span>.xmarkCircleFill.rawValue)</span><br><span class="line">                    .opacity(searchText == <span class="string">""</span> ? <span class="number">0</span> : <span class="number">1</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding(<span class="type">EdgeInsets</span>(top: <span class="number">8</span>, leading: <span class="number">6</span>, bottom: <span class="number">8</span>, trailing: <span class="number">6</span>))</span><br><span class="line">        .foregroundColor(.secondary)</span><br><span class="line">        .background(<span class="type">Color</span>(.systemBackground))</span><br><span class="line">        .cornerRadius(<span class="number">10.0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="type">ViewBuilder</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> cancelButton: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> showsCancelButton  &#123;</span><br><span class="line">            <span class="type">Button</span>(<span class="string">"Cancel"</span>) &#123;</span><br><span class="line">                <span class="type">UIApplication</span>.shared.endEditing(<span class="literal">true</span>)</span><br><span class="line">                withAnimation &#123;</span><br><span class="line">                    <span class="keyword">self</span>.searchText = <span class="string">""</span></span><br><span class="line">                    <span class="keyword">self</span>.showsCancelButton = <span class="literal">false</span></span><br><span class="line">                &#125;</span><br><span class="line">                onChange()</span><br><span class="line">            &#125;</span><br><span class="line">            .foregroundColor(<span class="type">Color</span>(.systemBlue))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">endEditing</span><span class="params">(<span class="number">_</span> force: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.windows</span><br><span class="line">            .<span class="built_in">filter</span>&#123;$<span class="number">0</span>.isKeyWindow&#125;</span><br><span class="line">            .first?</span><br><span class="line">            .endEditing(force)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-10T05:25:27.000Z" title="2021-02-10T05:25:27.000Z">2021-02-10</time><span class="level-item">3 minutes read (About 417 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-add-home-screen-quick-action-in-SwiftUI/">How to add home screen quick action in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/774">#774</a></strong></p>
<p>Start by defining your quick actions. You can use <code>UIApplicationShortcutIcon(type:)</code> for predefined icons, or use <code>UIApplicationShortcutIcon(systemImageName:)</code> for SFSymbol</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">QuickAction</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> readPasteboard</span><br><span class="line">    <span class="keyword">case</span> clear</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> shortcutItem: <span class="type">UIApplicationShortcutItem</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> .readPasteboard:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">UIApplicationShortcutItem</span>(</span><br><span class="line">                type: rawValue,</span><br><span class="line">                localizedTitle: <span class="string">"Read Pasteboard"</span>,</span><br><span class="line">                localizedSubtitle: <span class="string">""</span>,</span><br><span class="line">                icon: <span class="type">UIApplicationShortcutIcon</span>(type: .add),</span><br><span class="line">                userInfo: <span class="literal">nil</span></span><br><span class="line">            )</span><br><span class="line">        <span class="keyword">case</span> .clear:</span><br><span class="line">            <span class="keyword">return</span> <span class="type">UIApplicationShortcutItem</span>(</span><br><span class="line">                type: rawValue,</span><br><span class="line">                localizedTitle: <span class="string">"Clear Pasteboard"</span>,</span><br><span class="line">                localizedSubtitle: <span class="string">""</span>,</span><br><span class="line">                icon: <span class="type">UIApplicationShortcutIcon</span>(systemImageName: <span class="type">SFSymbol</span>.wind.rawValue),</span><br><span class="line">                userInfo: <span class="literal">nil</span></span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Add a service to store selected quick action. I usually make this conform to <code>ObservableObject</code> to be able to bind to SwiftUI views later</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">QuickActionService</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> shortcutItem: <span class="type">UIApplicationShortcutItem?</span></span><br></pre></td></tr></table></figure>

<p>Expose AppDelegate and SceneDelegate to your SwiftUI <code>App</code>. Listen to <code>scenePhase</code> to add dynamic items</p>
<p>From <a href="https://developer.apple.com/documentation/uikit/menus_and_shortcuts/add_home_screen_quick_actions">Define Dynamic Quick Actions</a></p>
<blockquote>
<p>Set dynamic screen quick actions at any point, but the sample sets them in the sceneWillResignActive(_:) function of the scene delegate. During the transition to a background state is a good time to update any dynamic quick actions, because the system executes this code before the user returns to the Home Screen.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@main</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PastePaliOSApp</span>: <span class="title">App</span> </span>&#123;</span><br><span class="line">    @<span class="type">UIApplicationDelegateAdaptor</span>(<span class="type">AppDelegate</span>.<span class="keyword">self</span>)</span><br><span class="line">    <span class="keyword">var</span> appDelegate</span><br><span class="line">    @<span class="type">Environment</span>(\.scenePhase)</span><br><span class="line">    <span class="keyword">var</span> scenePhase</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">Scene</span> &#123;</span><br><span class="line">        <span class="type">WindowGroup</span> &#123;</span><br><span class="line">            main</span><br><span class="line">        &#125;</span><br><span class="line">        .onChange(of: scenePhase) &#123; scenePhase <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> scenePhase &#123;</span><br><span class="line">            <span class="keyword">case</span> .background:</span><br><span class="line">                addDynamicQuickActions()</span><br><span class="line">            <span class="keyword">case</span> .active:</span><br><span class="line">                <span class="type">QuickActionService</span>.shared.perform()</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">addDynamicQuickActions</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="type">UIApplication</span>.shared.shortcutItems = [</span><br><span class="line">            <span class="type">QuickAction</span>.readPasteboard.shortcutItem,</span><br><span class="line">            <span class="type">QuickAction</span>.clear.shortcutItem</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Quick actions are notified in 2 cases</p>
<ul>
<li>If the app isn‚Äôt already loaded, it‚Äôs launched and passes details of the shortcut item in through the <code>connectionOptions</code> parameter of the <code>scene(_:willConnectTo:options:)</code> function in AppDelegate</li>
<li>If your app is already loaded, the system calls the <code>windowScene(_:performActionFor:completionHandler:)</code> function of your SceneDelegate</li>
</ul>
<p>Therefore we need to handle both cases.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AppDelegate</span>: <span class="title">NSObject</span>, <span class="title">UIApplicationDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> application: UIApplication,</span></span></span><br><span class="line"><span class="function"><span class="params">        configurationForConnecting connectingSceneSession: UISceneSession,</span></span></span><br><span class="line"><span class="function"><span class="params">        options: UIScene.ConnectionOptions</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span> -&gt; <span class="type">UISceneConfiguration</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> shortcutItem = options.shortcutItem &#123;</span><br><span class="line">            <span class="type">QuickActionService</span>.shared.shortcutItem = shortcutItem</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> sceneConfiguration = <span class="type">UISceneConfiguration</span>(</span><br><span class="line">            name: <span class="string">"Default"</span>,</span><br><span class="line">            sessionRole: connectingSceneSession.role</span><br><span class="line">        )</span><br><span class="line">        sceneConfiguration.delegateClass = <span class="type">SceneDelegate</span>.<span class="keyword">self</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sceneConfiguration</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">SceneDelegate</span>: <span class="title">UIResponder</span>, <span class="title">UIWindowSceneDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">windowScene</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> windowScene: UIWindowScene,</span></span></span><br><span class="line"><span class="function"><span class="params">        performActionFor shortcutItem: UIApplicationShortcutItem,</span></span></span><br><span class="line"><span class="function"><span class="params">        completionHandler: @escaping <span class="params">(Bool)</span></span></span> -&gt; <span class="type">Void</span></span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="type">QuickActionService</span>.shared.shortcutItem = shortcutItem</span><br><span class="line">        completionHandler(<span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><p>For more please consult official Apple docs and design</p>
<ul>
<li><a href="https://developer.apple.com/documentation/uikit/menus_and_shortcuts/add_home_screen_quick_actions">Add Home Screen Quick Actions</a></li>
<li><a href="https://developer.apple.com/design/human-interface-guidelines/ios/system-capabilities/home-screen-actions/">HIG - Home Screen Quick Actions</a></li>
</ul>
<hr>
<p><strong>Updated at</strong> 2021-02-10 06:43:19</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-08T18:40:48.000Z" title="2021-02-08T18:40:48.000Z">2021-02-08</time><span class="level-item">a minute read (About 115 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-EquatableView-in-SwiftUI/">How to use EquatableView in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/773">#773</a></strong></p>
<p>From <a href="https://twitter.com/jsh8080/status/1206617106160246784">John Harper ‚Äòs tweet</a></p>
<blockquote>
<p>SwiftUI assumes any Equatable.== is a true equality check, so for POD views it compares each field directly instead (via reflection). For non-POD views it prefers the view‚Äôs == but falls back to its own field compare if no ==. EqView is a way to force the use of ==.</p>
</blockquote>
<blockquote>
<p>When it does the per-field comparison the same rules are applied recursively to each field (to choose direct comparison or == if defined). (POD = plain data, see Swift‚Äôs _isPOD() function.)</p>
</blockquote>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://swiftui-lab.com/equatableview/">https://swiftui-lab.com/equatableview/</a></li>
<li><a href="https://swiftwithmajid.com/2020/01/22/optimizing-views-in-swiftui-using-equatableview/">https://swiftwithmajid.com/2020/01/22/optimizing-views-in-swiftui-using-equatableview/</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-08T18:34:20.000Z" title="2021-02-08T18:34:20.000Z">2021-02-08</time><span class="level-item">a minute read (About 124 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-add-new-property-in-Codable-struct-in-SwiftUI/">How to add new property in Codable struct in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/772">#772</a></strong></p>
<p>I use Codable structs in my apps for preferences, and bind them to SwiftUI views. If we add new properties to existing Codable, it can‚Äôt decode with old saved json as we require new properties. We can either do cutom decoding with container, but this can result in lots more code and mistakes if we have many properties inside our struct.</p>
<p>The quick workaround is to declare new properties as optional, and use a computed property to wrap that. The good news is Binding works with computed properties too, from the outside all looks like struct properties to SwiftUI</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Preference</span>: <span class="title">Codable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> _redacts: <span class="type">Bool?</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> redacts: <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; _redacts ?? <span class="literal">false</span> &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123; _redacts = newValue &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-06T21:23:02.000Z" title="2021-02-06T21:23:02.000Z">2021-02-06</time><span class="level-item">a few seconds read (About 32 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-handle-escape-in-NSTextField-in-SwiftUI/">How to handle escape in NSTextField in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/770">#770</a></strong></p>
<p>Handle <code>cancelOperation</code> somewhere up in responder chain</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyWindow</span>: <span class="title">NSWindow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> keyHandler = <span class="type">KeyHandler</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">cancelOperation</span><span class="params">(<span class="number">_</span> sender: <span class="keyword">Any</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.cancelOperation(sender)</span><br><span class="line">        keyHandler.onEvent(.esc)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-06T19:54:05.000Z" title="2021-02-06T19:54:05.000Z">2021-02-06</time><span class="level-item">a few seconds read (About 98 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fit-ScrollView-to-content-in-SwiftUI/">How to fit ScrollView to content in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/769">#769</a></strong></p>
<p>If we place <code>ScrollView</code> inside HStack or VStack, it takes all remaining space. To fit ScrollView to its content, we need to get its content size and constrain ScrollView size.</p>
<p>Use a <code>GeometryReader</code> as Scrollview content background, and get the local frame</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HSearchBar</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> scrollViewContentSize: <span class="type">CGSize</span> = .zero</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            searchButton</span><br><span class="line">            <span class="type">ScrollView</span>(.horizontal, showsIndicators: <span class="literal">false</span>) &#123;</span><br><span class="line">                <span class="type">HStack</span>(spacing: <span class="number">12</span>) &#123;</span><br><span class="line">                    <span class="type">ForEach</span>(store.collections) &#123; collection <span class="keyword">in</span></span><br><span class="line">                        collectionCell(collection)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                .background(</span><br><span class="line">                    <span class="type">GeometryReader</span> &#123; geo -&gt; <span class="type">Color</span> <span class="keyword">in</span></span><br><span class="line">                        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">                            scrollViewContentSize = geo.size</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span> <span class="type">Color</span>.clear</span><br><span class="line">                    &#125;</span><br><span class="line">                )</span><br><span class="line">            &#125;</span><br><span class="line">            .frame(</span><br><span class="line">                maxWidth: scrollViewContentSize.width</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-03T09:57:43.000Z" title="2021-02-03T09:57:43.000Z">2021-02-03</time><span class="level-item">a few seconds read (About 97 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-modal-window-in-SwiftUI-for-macOS/">How to show modal window in SwiftUI for macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/768">#768</a></strong></p>
<p>Use custom <code>NSWindow</code>, set <code>level</code> in <code>becomeKey</code> and call <code>NSApp.runModal</code> to show modal</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ModalWindow</span>: <span class="title">NSWindow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">becomeKey</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.becomeKey()</span><br><span class="line"></span><br><span class="line">        level = .statusBar</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">close</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.close()</span><br><span class="line"></span><br><span class="line">        <span class="type">NSApp</span>.stopModal()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> window = <span class="type">ModalWindow</span>(</span><br><span class="line">    contentRect: .zero,</span><br><span class="line">    styleMask: [.titled, .closable],</span><br><span class="line">    backing: .buffered,</span><br><span class="line">    <span class="keyword">defer</span>: <span class="literal">false</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">window.titlebarAppearsTransparent = <span class="literal">true</span></span><br><span class="line">window.title = <span class="string">"Manage collections"</span></span><br><span class="line"></span><br><span class="line">window.center()</span><br><span class="line">window.isReleasedWhenClosed = <span class="literal">false</span></span><br><span class="line"><span class="keyword">self</span>.window = window</span><br><span class="line"><span class="keyword">let</span> view = <span class="type">CollectionSettingsView</span>(store: <span class="type">Store</span>.shared)</span><br><span class="line">    .padding()</span><br><span class="line">    .frame(</span><br><span class="line">        width: <span class="type">Constants</span>.settingsViewWidth,</span><br><span class="line">        height: <span class="number">350</span>,</span><br><span class="line">        alignment: .topLeading</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">let</span> hosting = <span class="type">NSHostingView</span>(rootView: view)</span><br><span class="line">window.contentView = hosting</span><br><span class="line">hosting.autoresizingMask = [.width, .height]</span><br><span class="line"></span><br><span class="line"><span class="type">NSApp</span>.runModal(<span class="keyword">for</span>: window)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-02-02T12:08:31.000Z" title="2021-02-02T12:08:31.000Z">2021-02-02</time><span class="level-item">3 minutes read (About 434 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-ViewBuilder-in-SwiftUI/">How to use ViewBuilder in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/767">#767</a></strong></p>
<p>SwiftUI ‚Äòs <a href="https://developer.apple.com/documentation/swiftui/viewbuilder">ViewBuilder</a> is a custom parameter attribute that constructs views from closures.</p>
<p>It is available in <code>body</code> and most SwiftUI modifiers</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">protocol</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">associatedtype</span> <span class="type">Body</span> : <span class="type">View</span></span><br><span class="line">    @<span class="type">ViewBuilder</span> <span class="keyword">var</span> body: <span class="type">Self</span>.<span class="type">Body</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">contextMenu</span>&lt;MenuItems&gt;<span class="params">(@ViewBuilder menuItems: <span class="params">()</span></span></span> -&gt; <span class="type">MenuItems</span>) -&gt; some <span class="type">View</span> <span class="keyword">where</span> <span class="type">MenuItems</span> : <span class="type">View</span></span><br></pre></td></tr></table></figure>

<p>In these <code>ViewBuilder</code> enabled places we can perform conditional logic to construct views. For example here in our SampleView, we have <code>switch</code> statement in <code>body</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SampleView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Position</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> top, bottom, <span class="keyword">left</span>, <span class="keyword">right</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> position: <span class="type">Position</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> position &#123;</span><br><span class="line">        <span class="keyword">case</span> .top:</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="type">SFSymbol</span>.person.rawValue)</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="type">EmptyView</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> profile: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="literal">true</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">Image</span>(systemName: <span class="type">SFSymbol</span>.person.rawValue)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>ViewBuilder</code> applies to both property and function. If we want to have the same logic style as in <code>body</code> in our custom property or methods, we can annotate with <code>ViewBuilder</code>. This works like magic, SwiftUI can determine the types of our expression.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">SampleView</span> </span>&#123;</span><br><span class="line">    @<span class="type">ViewBuilder</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">profile2</span><span class="params">(position: Position)</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> position &#123;</span><br><span class="line">        <span class="keyword">case</span> .top:</span><br><span class="line">            <span class="type">Image</span>(systemName: <span class="type">SFSymbol</span>.person.rawValue)</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="type">EmptyView</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Use-ViewBuilder-to-construct-View"><a href="#Use-ViewBuilder-to-construct-View" class="headerlink" title="Use ViewBuilder to construct View"></a>Use ViewBuilder to construct View</h3><p>We can use <code>ViewBuiler</code> as our parameter that constructs View. For example we can build an <code>IfLet</code> that construct View with optional check.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">IfLet</span>&lt;<span class="title">T</span>, <span class="title">Content</span>: <span class="title">View</span>&gt;: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> value: <span class="type">T?</span></span><br><span class="line">    <span class="keyword">let</span> content: (<span class="type">T</span>) -&gt; <span class="type">Content</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(<span class="number">_</span> value: <span class="type">T?</span>, @<span class="type">ViewBuilder</span> content: @escaping (<span class="type">T</span>) -&gt; <span class="type">Content</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.value = value</span><br><span class="line">        <span class="keyword">self</span>.content = content</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> value = value &#123;</span><br><span class="line">            content(value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>With <code>ViewBuilder</code> we can apply logic inside our closure</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">EmailView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> email: <span class="type">String?</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">IfLet</span>(email) &#123; email <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> email.isEmpty &#123;</span><br><span class="line">                <span class="type">Circle</span>()</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">Text</span>(email)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Use-ViewBuilder-where-we-can‚Äôt-use-closure"><a href="#Use-ViewBuilder-where-we-can‚Äôt-use-closure" class="headerlink" title="Use ViewBuilder where we can‚Äôt use closure"></a>Use ViewBuilder where we can‚Äôt use closure</h3><p>In some modifers like <code>overlay</code>, SwiftUI expects a View, not a closure that returns a View. There we cannot use additional logic</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    @inlinable <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">overlay</span>&lt;Overlay&gt;<span class="params">(<span class="number">_</span> overlay: Overlay, alignment: Alignment = .center)</span></span> -&gt; some <span class="type">View</span> <span class="keyword">where</span> <span class="type">Overlay</span> : <span class="type">View</span></span><br></pre></td></tr></table></figure>

<p>The below won‚Äôt work as we can‚Äôt do conditional statement in overlay modifier</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MessageView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> showsHUD: <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"Message"</span>)</span><br><span class="line">            .overlay(</span><br><span class="line">                <span class="keyword">if</span> showsHUD &#123;</span><br><span class="line">                    <span class="type">Text</span>(<span class="string">"HUD"</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>But we can make something like <code>MakeView</code> that provides a <code>ViewBuilder</code> closure</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">MakeView</span>&lt;<span class="title">Content</span>: <span class="title">View</span>&gt;: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> content: <span class="type">Content</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(@<span class="type">ViewBuilder</span> make: () -&gt; <span class="type">Content</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.content = make()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        content</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So we can use a conditional statement in any modifier that does not accept ViewModifier</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MessageView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> showsHUD: <span class="type">Bool</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(<span class="string">"Message"</span>)</span><br><span class="line">            .overlay(</span><br><span class="line">                <span class="type">MakeView</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> showsHUD &#123;</span><br><span class="line">                        <span class="type">Text</span>(<span class="string">"HUD"</span>)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-30T04:37:41.000Z" title="2021-01-30T04:37:41.000Z">2021-01-30</time><span class="level-item">a few seconds read (About 79 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-custom-Key-for-NSCache/">How to use custom Key for NSCache</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/766">#766</a></strong></p>
<p>Need to use a class, best is to subclass from <code>NSObject</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cache = <span class="type">NSCache</span>&lt;<span class="type">Key</span>, <span class="type">UIImage</span>&gt;()</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Key</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">isEqual</span><span class="params">(<span class="number">_</span> object: <span class="keyword">Any</span>?)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> other = object <span class="keyword">as</span>? <span class="type">Key</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> url == other.url</span><br><span class="line">            &amp;&amp; size == other.size</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> hash: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> url.hashValue ^ <span class="type">Int</span>(size.width) ^ <span class="type">Int</span>(size.height)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> url: <span class="type">URL</span></span><br><span class="line">    <span class="keyword">let</span> size: <span class="type">CGSize</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(url: <span class="type">URL</span>, size: <span class="type">CGSize</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.url = url</span><br><span class="line">        <span class="keyword">self</span>.size = size</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-29T21:33:04.000Z" title="2021-01-29T21:33:04.000Z">2021-01-29</time><span class="level-item">a few seconds read (About 72 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-multiple-popover-in-SwiftUI/">How to show multiple popover in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/765">#765</a></strong></p>
<p>In SwiftUI currently, it‚Äôs not possible to attach multiple <code>.popover</code> to the same View. But we can use condition to show different content</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ClipboardCell</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">PopoverStyle</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> raw</span><br><span class="line">        <span class="keyword">case</span> preview</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @<span class="type">Binding</span></span><br><span class="line">    <span class="keyword">var</span> showsPopover: <span class="type">Bool</span></span><br><span class="line">    @<span class="type">Binding</span></span><br><span class="line">    <span class="keyword">var</span> popoverStyle: <span class="type">PopoverStyle</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            header</span><br><span class="line">            content</span><br><span class="line">                .popover(isPresented: $showsPopover) &#123;</span><br><span class="line">                    <span class="keyword">switch</span> popoverStyle &#123;</span><br><span class="line">                    <span class="keyword">case</span> .raw:</span><br><span class="line">                        <span class="type">ViewRawView</span>(item: item)</span><br><span class="line">                    <span class="keyword">case</span> .preview:</span><br><span class="line">                        <span class="type">PreviewView</span>(item: item)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            footer</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-29T19:44:48.000Z" title="2021-01-29T19:44:48.000Z">2021-01-29</time><span class="level-item">a minute read (About 188 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-handle-keyDown-in-SwiftUI-for-macOS/">How to handle keyDown in SwiftUI for macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/764">#764</a></strong></p>
<p>Use a custom <code>KeyAwareView</code> that uses an <code>NSView</code> that checks for <code>keyDown</code> method. In case we can‚Äôt handle certain keys, call <code>super.keyDown(with: event)</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> KeyboardShortcuts</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">KeyAwareView</span>: <span class="title">NSViewRepresentable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> onEvent: (<span class="type">Event</span>) -&gt; <span class="type">Void</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">makeNSView</span><span class="params">(context: Context)</span></span> -&gt; <span class="type">NSView</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">KeyView</span>()</span><br><span class="line">        view.onEvent = onEvent</span><br><span class="line">        <span class="type">DispatchQueue</span>.main.async &#123;</span><br><span class="line">            view.window?.makeFirstResponder(view)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">updateNSView</span><span class="params">(<span class="number">_</span> nsView: NSView, context: Context)</span></span> &#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">KeyAwareView</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Event</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> upArrow</span><br><span class="line">        <span class="keyword">case</span> downArrow</span><br><span class="line">        <span class="keyword">case</span> leftArrow</span><br><span class="line">        <span class="keyword">case</span> rightArrow</span><br><span class="line">        <span class="keyword">case</span> space</span><br><span class="line">        <span class="keyword">case</span> delete</span><br><span class="line">        <span class="keyword">case</span> cmdC</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">class</span> <span class="title">KeyView</span>: <span class="title">NSView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> onEvent: (<span class="type">KeyAwareView</span>.<span class="type">Event</span>) -&gt; <span class="type">Void</span> = &#123; <span class="number">_</span> <span class="keyword">in</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> acceptsFirstResponder: <span class="type">Bool</span> &#123; <span class="literal">true</span> &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">keyDown</span><span class="params">(with event: NSEvent)</span></span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="type">Int</span>(event.keyCode) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span>.delete.rawValue:</span><br><span class="line">            onEvent(.delete)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span>.upArrow.rawValue:</span><br><span class="line">            onEvent(.upArrow)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span>.downArrow.rawValue:</span><br><span class="line">            onEvent(.downArrow)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span>.leftArrow.rawValue:</span><br><span class="line">            onEvent(.leftArrow)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span>.rightArrow.rawValue:</span><br><span class="line">            onEvent(.rightArrow)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span>.space.rawValue:</span><br><span class="line">            onEvent(.space)</span><br><span class="line">        <span class="keyword">case</span> <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span>.<span class="built_in">c</span>.rawValue <span class="keyword">where</span> event.modifierFlags.<span class="built_in">contains</span>(.command):</span><br><span class="line">            onEvent(.cmdC)</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">super</span>.keyDown(with: event)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then we can place this as a background</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LazyVStack</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">.background(<span class="type">KeyAwareView</span>(onEvent: &#123;&#125;))</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-01-29 20:55:39</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-28T19:23:25.000Z" title="2021-01-28T19:23:25.000Z">2021-01-28</time><span class="level-item">3 minutes read (About 393 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-extend-custom-View-in-SwiftUI/">How to extend custom View in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/763">#763</a></strong></p>
<p>I usually break down a big struct into smaller views and extensions. For example I have a <code>ClipboardCell</code> that has a lot of <code>onReceive</code> so I want to move these to another component.</p>
<p>One way to do that is to extend <code>ClipboardCell</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ClipboardCell</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> isSelected: <span class="type">Bool</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> showsPreview: <span class="type">Bool</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> showsViewRaw: <span class="type">Bool</span></span><br><span class="line">    <span class="keyword">let</span> onCopy: () -&gt; <span class="type">Void</span></span><br><span class="line">    <span class="keyword">let</span> onDelete: () -&gt; <span class="type">Void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">ClipboardCell</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">onReceiveKeyboard</span><span class="params">()</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.onReceive(</span><br><span class="line">            <span class="type">NotificationCenter</span>.<span class="keyword">default</span></span><br><span class="line">                .publisher(<span class="keyword">for</span>: .didKeyboardCopyItem)</span><br><span class="line">                .receive(on: <span class="type">RunLoop</span>.main),</span><br><span class="line">            perform: &#123; note <span class="keyword">in</span></span><br><span class="line">                onCopy()</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>but then when we want to use this, we get <code>some View has no member onReceiveKeyboard</code> as <code>self</code> after some Swift modifier becomes <code>some View</code>, unless we call <code>onReceiveKeyboard</code> first</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ClipboardCell</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">self</span></span><br><span class="line">       .padding()</span><br><span class="line">       .onReceiveKeyboard()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Use-ViewModifier"><a href="#Use-ViewModifier" class="headerlink" title="Use ViewModifier"></a>Use ViewModifier</h3><p>The SwiftUI is to use <code>ViewModifier</code> where we can inject Binding and functions</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ClipboardCellOnKeyboardModifier</span>: <span class="title">ViewModifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> isSelected: <span class="type">Bool</span></span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> showsPreview: <span class="type">Bool</span></span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> showsViewRaw: <span class="type">Bool</span></span><br><span class="line">    <span class="keyword">let</span> onCopy: () -&gt; <span class="type">Void</span></span><br><span class="line">    <span class="keyword">let</span> onDelete: () -&gt; <span class="type">Void</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">body</span><span class="params">(content: Content)</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        content.onReceive(</span><br><span class="line">            <span class="type">NotificationCenter</span>.<span class="keyword">default</span></span><br><span class="line">                .publisher(<span class="keyword">for</span>: .didKeyboardCopyItem)</span><br><span class="line">                .receive(on: <span class="type">RunLoop</span>.main),</span><br><span class="line">            perform: &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> isSelected <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">                onCopy()</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">`</span><br></pre></td></tr></table></figure>

<p>Then we can consume it and pass parameters</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ClipboardCell</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">self</span></span><br><span class="line">       .padding()</span><br><span class="line">       .modifier(</span><br><span class="line">           <span class="type">ClipboardCellOnKeyboardModifier</span>(</span><br><span class="line">               showsPreview: <span class="type">Binding</span>&lt;<span class="type">Bool</span>&gt;(<span class="keyword">get</span>: &#123;&#125;, <span class="keyword">set</span>: &#123;&#125;) ,</span><br><span class="line">               showsViewRaw: <span class="type">Binding</span>&lt;<span class="type">Bool</span>&gt;(<span class="keyword">get</span>: &#123;&#125;, <span class="keyword">set</span>: &#123;&#125;) </span><br><span class="line">           )</span><br><span class="line">       )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Pass-State-and-Binding"><a href="#Pass-State-and-Binding" class="headerlink" title="Pass State and Binding"></a>Pass State and Binding</h3><p>For now SwiftUI seems to have a bug that ViewModifier does not listen to <code>onReceive</code>, we can extend generic <code>View</code> and pass parameters instead</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">onClipboardCellReceiveKeyboard</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        isSelected: Bool,</span></span></span><br><span class="line"><span class="function"><span class="params">        showsPreview: Binding&lt;Bool&gt;,</span></span></span><br><span class="line"><span class="function"><span class="params">        showsViewRaw: Binding&lt;Bool&gt;,</span></span></span><br><span class="line"><span class="function"><span class="params">        onCopy: <span class="params">()</span></span></span> -&gt; <span class="type">Void</span>,</span><br><span class="line">        onDelete: () -&gt; <span class="type">Void</span></span><br><span class="line">    ) -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.onReceive(</span><br><span class="line">            <span class="type">NotificationCenter</span>.<span class="keyword">default</span></span><br><span class="line">                .publisher(<span class="keyword">for</span>: .didKeyboardCopyItem)</span><br><span class="line">                .receive(on: <span class="type">RunLoop</span>.main),</span><br><span class="line">            perform: &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> isSelected <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">                onCopy()</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br></pre></td></tr></table></figure>

<h3 id="Use-ObservableObject"><a href="#Use-ObservableObject" class="headerlink" title="Use ObservableObject"></a>Use ObservableObject</h3><p>Another way is to use an <code>ObservableObject</code> and encapsulate logic and state in there, and share this across views that want to consume this set of data, just like a ViewModel</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsHolder</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> items: [<span class="type">ClipboardItem</span>] = []</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> selectedItems = <span class="type">Set</span>&lt;<span class="type">ClipboardItem</span>&gt;()</span><br><span class="line">    @<span class="type">Published</span> <span class="keyword">var</span> agos: [<span class="type">UUID</span>: <span class="type">String</span>] = [:]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">updateAgos</span><span class="params">()</span></span> &#123;</span><br><span class="line">        agos.removeAll()</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> items &#123;</span><br><span class="line">            agos[item.id] = <span class="type">Formattes</span>.ago(date: item.createdAt)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">update</span><span class="params">(items: [ClipboardItem])</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.items = items</span><br><span class="line">            .sorted(by: &#123; $<span class="number">0</span>.createdAt &gt; $<span class="number">1</span>.createdAt &#125;)</span><br><span class="line">        updateAgos()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ClipboardCell</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">StateObject</span> <span class="keyword">var</span> itemsHolder = <span class="type">ItemsHolder</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        list.onReceive(</span><br><span class="line">            <span class="type">NotificationCenter</span>.<span class="keyword">default</span></span><br><span class="line">                .publisher(<span class="keyword">for</span>: .didKeyboardCopyItem)</span><br><span class="line">                .receive(on: <span class="type">RunLoop</span>.main),</span><br><span class="line">            perform: &#123; note <span class="keyword">in</span></span><br><span class="line">                itemsHolder.onCopy()</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-01-29 12:51:52</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-26T05:33:34.000Z" title="2021-01-26T05:33:34.000Z">2021-01-26</time><span class="level-item">2 minutes read (About 305 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Sparkle-for-macOS-app/">How to use Sparkle for macOS app</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/762">#762</a></strong></p>
<h2 id="Install-Sparkle"><a href="#Install-Sparkle" class="headerlink" title="Install Sparkle"></a>Install Sparkle</h2><ul>
<li>For now, the latest stable version is 1.24.0 which supports CocoaPods OK, but still, have issues with SPM. Support non sandboxed apps</li>
<li>Version 2.0.0 is in beta and supports sandboxed apps</li>
</ul>
<p>To install, use CocoaPods</p>
<figure class="highlight rb"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">platform <span class="symbol">:osx</span>, <span class="string">'11.0'</span></span><br><span class="line"></span><br><span class="line">target <span class="string">'MyApp'</span> <span class="keyword">do</span></span><br><span class="line">  <span class="comment"># Comment the next line if you don't want to use dynamic frameworks</span></span><br><span class="line">  use_frameworks!</span><br><span class="line"></span><br><span class="line">  pod <span class="string">'Sparkle'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="Sign"><a href="#Sign" class="headerlink" title="Sign"></a>Sign</h2><p>In your target, choose <code>Signing &amp; Capability</code> tab, change Signing Certificate from <code>Locally</code> to <code>Development</code> for code sign to work for embedded frameworks</p>
<h2 id="Specify-SUUpdater"><a href="#Specify-SUUpdater" class="headerlink" title="Specify SUUpdater"></a>Specify SUUpdater</h2><p>Follow Sparkle <a href="https://sparkle-project.org/documentation/">documentation</a>, let‚Äôs add an Object to Application Scene in Main.storyboard and specify <code>SUUpdater</code> class</p>
<p>In AppDelegate</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">checkForUpdates</span><span class="params">(<span class="number">_</span> sender: <span class="keyword">Any</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> updater = <span class="type">SUUpdater</span>.shared()</span><br><span class="line">    updater?.checkForUpdates(<span class="keyword">self</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Additionally, we can add an NSMenuItem and drag it to our <code>SUUpdater</code> object <code>checkForUpdates</code> method</p>
<p>In Info.plist, add SUFeedURL with a link to your cast file</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>SUFeedURL<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>https://onmyway133.com/MyAppCast.xml<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Configure-cast-file"><a href="#Configure-cast-file" class="headerlink" title="Configure cast file"></a>Configure cast file</h2><p>I usually upload my cast to S3 or GitHub. For GitHub with raw URL, remember that there is 5 minutes cache by default</p>
<p>If you follow sample cast file <a href="https://sparkle-project.org/files/sparkletestcast.xml">https://sparkle-project.org/files/sparkletestcast.xml</a></p>
<p>Notice that <code>sparkle:version=&quot;2.0&quot;</code> is <code>CFBundleVersion</code> which is your build number. You need to also specify <code>sparkle:shortVersionString</code> which is CFBundleShortVersionString your version number</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sparkle:shortVersionString="2.0.1"</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rss</span> <span class="attr">version</span>=<span class="string">"2.0"</span> <span class="attr">xmlns:sparkle</span>=<span class="string">"http://www.andymatuschak.org/xml-namespaces/sparkle"</span>  <span class="attr">xmlns:dc</span>=<span class="string">"http://purl.org/dc/elements/1.1/"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">channel</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Sparkle Test App Changelog<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span>&gt;</span>http://sparkle-project.org/files/sparkletestcast.xml<span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">description</span>&gt;</span>Most recent changes with links to updates.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">language</span>&gt;</span>en<span class="tag">&lt;/<span class="name">language</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Version 2.0<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">description</span>&gt;</span></span><br><span class="line">          &lt;![CDATA[</span><br><span class="line">            &lt;ul&gt;</span><br><span class="line">              &lt;li&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit.&lt;/li&gt;</span><br><span class="line">              &lt;li&gt;Suspendisse sed felis ac ante ultrices rhoncus. Etiam quis elit vel nibh placerat facilisis in id leo.&lt;/li&gt;</span><br><span class="line">              &lt;li&gt;Vestibulum nec tortor odio, nec malesuada libero. Cras vel convallis nunc.&lt;/li&gt;</span><br><span class="line">              &lt;li&gt;Suspendisse tristique massa eget velit consequat tincidunt. Praesent sodales hendrerit pretium.&lt;/li&gt;</span><br><span class="line">            &lt;/ul&gt;</span><br><span class="line">          ]]&gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pubDate</span>&gt;</span>Sat, 26 Jul 2014 15:20:11 +0000<span class="tag">&lt;/<span class="name">pubDate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">enclosure</span> <span class="attr">url</span>=<span class="string">"https://sparkle-project.org/files/Sparkle%20Test%20App.zip"</span> <span class="attr">sparkle:version</span>=<span class="string">"2.0"</span> <span class="attr">length</span>=<span class="string">"107758"</span> <span class="attr">type</span>=<span class="string">"application/octet-stream"</span> <span class="attr">sparkle:dsaSignature</span>=<span class="string">"MCwCFCdoW13VBGJWIfIklKxQVyetgxE7AhQTVuY9uQT0KOV1UEk21epBsGZMPg=="</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">channel</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rss</span>&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-01-26 06:34:38</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-21T12:31:00.000Z" title="2021-01-21T12:31:00.000Z">2021-01-21</time><span class="level-item">a few seconds read (About 103 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-ScrollViewReader-in-SwiftUI/">How to use ScrollViewReader in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/761">#761</a></strong></p>
<p>Explicitly specify <code>id</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ScrollView</span> &#123;</span><br><span class="line">    <span class="type">ScrollViewReader</span> &#123; proxy <span class="keyword">in</span></span><br><span class="line">        <span class="type">LazyVStack</span>(spacing: <span class="number">10</span>) &#123;</span><br><span class="line">            <span class="type">ForEach</span>(items) &#123; item <span class="keyword">in</span></span><br><span class="line">                <span class="type">Cell</span>(item: item)</span><br><span class="line">                    .id(item.id)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">        .onReceiveKeyboard(onNext: &#123;</span><br><span class="line">            onNext()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> item = selectedItem &#123;</span><br><span class="line">                proxy.scrollTo(item.id, anchor: .center)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, onPrevious: &#123;</span><br><span class="line">            onPrevious()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> item = selectedItem &#123;</span><br><span class="line">                proxy.scrollTo(item.id, anchor: .center)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I usually extract <code>ScrollViewReader</code> into a helper function that use <code>onChange</code> to react to state changes</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">func</span> <span class="title">scrollViewReader</span>&lt;Content: View&gt;<span class="params">(@ViewBuilder content: @escaping <span class="params">()</span></span></span> -&gt; <span class="type">Content</span>) -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">ScrollViewReader</span> &#123; proxy <span class="keyword">in</span></span><br><span class="line">        content()</span><br><span class="line">            .onChange(of: itemsHolder.focusItem) &#123; item <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">guard</span> <span class="keyword">let</span> item = item <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">                withAnimation &#123;</span><br><span class="line">                    proxy.scrollTo(item.id, anchor: .center)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-02-21 19:14:01</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-21T12:03:16.000Z" title="2021-01-21T12:03:16.000Z">2021-01-21</time><span class="level-item">2 minutes read (About 245 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-handle-keyDown-in-NSResponder/">How to handle keyDown in NSResponder</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/760">#760</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> AppKit</span><br><span class="line"><span class="keyword">import</span> Omnia</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyWindow</span>: <span class="title">NSWindow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">keyDown</span><span class="params">(with event: NSEvent)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.keyDown(with: event)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> isKey(<span class="type">NSDeleteCharacter</span>, event: event) &#123;</span><br><span class="line">            <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.post(<span class="type">Notification</span>(name: .didKeyboardDeleteItem))</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> isKey(<span class="type">NSUpArrowFunctionKey</span>, event: event) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"up"</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> isKey(<span class="type">NSDownArrowFunctionKey</span>, event: event) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"down"</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> isKey(<span class="type">NSLeftArrowFunctionKey</span>, event: event) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"left"</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> isKey(<span class="type">NSRightArrowFunctionKey</span>, event: event) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"right"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">isKey</span><span class="params">(<span class="number">_</span> key: Int, event: NSEvent)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> scalar = <span class="type">UnicodeScalar</span>(key) &#123;</span><br><span class="line">            <span class="keyword">return</span> event.characters == <span class="type">String</span>(scalar)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Another way is to listen to</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSEvent</span>.addLocalMonitorForEvents(matching: .keyDown) &#123; event <span class="keyword">in</span></span><br><span class="line">       <span class="keyword">if</span> handled(with: $<span class="number">0</span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> event</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>Or create our own inspector</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyWindow</span>: <span class="title">NSWindow</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">keyDown</span><span class="params">(with event: NSEvent)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> !<span class="type">EventService</span>.shared.inspect(event) &#123;</span><br><span class="line">            <span class="keyword">super</span>.keyDown(with: event)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> canBecomeKey: <span class="type">Bool</span>  &#123; <span class="literal">true</span> &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> canBecomeMain: <span class="type">Bool</span> &#123; <span class="literal">true</span> &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> acceptsFirstResponder: <span class="type">Bool</span> &#123; <span class="literal">true</span> &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">becomeFirstResponder</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123; <span class="literal">true</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> AppKit</span><br><span class="line"><span class="keyword">import</span> Omnia</span><br><span class="line"><span class="keyword">import</span> KeyboardShortcuts</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">EventService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> shared = <span class="type">EventService</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> combos: [<span class="type">Combo</span>] = []</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> debouncer = <span class="type">Debouncer</span>(delay: <span class="number">0.1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">register</span><span class="params">(<span class="number">_</span> combo: Combo)</span></span> &#123;</span><br><span class="line">        combos.append(combo)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">inspect</span><span class="params">(<span class="number">_</span> event: NSEvent)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> combo <span class="keyword">in</span> combos &#123;</span><br><span class="line">            <span class="keyword">if</span> combo.match(event) &#123;</span><br><span class="line">                <span class="keyword">self</span>.debouncer.run &#123;</span><br><span class="line">                    combo.action()</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">EventService</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Combo</span> </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> modifier: <span class="type">NSEvent</span>.<span class="type">ModifierFlags?</span></span><br><span class="line">        <span class="keyword">let</span> keyCode: <span class="type">KeyboardShortcuts</span>.<span class="type">Key</span></span><br><span class="line">        <span class="keyword">let</span> action: () -&gt; <span class="type">Void</span></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">func</span> <span class="title">match</span><span class="params">(<span class="number">_</span> event: NSEvent)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> modifier = modifier,</span><br><span class="line">               !event.modifierFlags.<span class="built_in">contains</span>(modifier) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> event.keyCode != keyCode.rawValue &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2021-01-25 20:05:08</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-21T11:12:50.000Z" title="2021-01-21T11:12:50.000Z">2021-01-21</time><span class="level-item">a few seconds read (About 73 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-handle-NSSearchToolbarItem-in-macOS-11/">How to handle NSSearchToolbarItem in macOS 11</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/758">#758</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NSToolbarItem</span>.<span class="title">Identifier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">let</span> searchItem: <span class="type">NSToolbarItem</span>.<span class="type">Identifier</span> = <span class="type">NSToolbarItem</span>.<span class="type">Identifier</span>(<span class="string">"SearchItem"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> searchItem = <span class="type">NSSearchToolbarItem</span>(itemIdentifier: .searchItem)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AppDelegate</span>: <span class="title">NSToolbarDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toolbar</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> toolbar: NSToolbar,</span></span></span><br><span class="line"><span class="function"><span class="params">        itemForItemIdentifier itemIdentifier: NSToolbarItem.Identifier,</span></span></span><br><span class="line"><span class="function"><span class="params">        willBeInsertedIntoToolbar flag: Bool</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span> -&gt; <span class="type">NSToolbarItem?</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> itemIdentifier &#123;</span><br><span class="line">        <span class="keyword">case</span> .searchItem:</span><br><span class="line">            searchItem.searchField.delegate = <span class="keyword">self</span></span><br><span class="line">            <span class="keyword">return</span> searchItem</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">AppDelegate</span>: <span class="title">NSSearchFieldDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">control</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> control: NSControl,</span></span></span><br><span class="line"><span class="function"><span class="params">        textView: NSTextView,</span></span></span><br><span class="line"><span class="function"><span class="params">        doCommandBy commandSelector: Selector</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (commandSelector == #selector(<span class="type">NSResponder</span>.insertNewline(<span class="number">_</span>:))) &#123;</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">"enter"</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-20T21:10:39.000Z" title="2021-01-20T21:10:39.000Z">2021-01-20</time><span class="level-item">a minute read (About 152 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-do-launch-at-login-for-macOS-apps/">How to do launch at login for macOS apps</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/757">#757</a></strong></p>
<ul>
<li>Use <a href="https://developer.apple.com/documentation/servicemanagement/1501557-smloginitemsetenabled?language=swift">SMLoginItemSetEnabled</a> from Service Management framework</li>
<li>Use a helper background app that checks and invokes our main application</li>
<li>Copy our helper app into <code>Library/LoginItems</code></li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">helper_dir=<span class="string">"<span class="variable">$BUILT_PRODUCTS_DIR</span>/<span class="variable">$CONTENTS_FOLDER_PATH</span>/Library/LoginItems"</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AppDelegate</span>: <span class="title">NSObject</span>, <span class="title">NSApplicationDelegate</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">func</span> <span class="title">applicationDidFinishLaunching</span><span class="params">(<span class="number">_</span> notification: Notification)</span></span> &#123;</span><br><span class="line">		<span class="keyword">let</span> bundleId = <span class="type">Bundle</span>.main.bundleIdentifier!</span><br><span class="line">		<span class="comment">// <span class="doctag">TODO:</span> Make this more strict by only replacing at the end</span></span><br><span class="line">		<span class="keyword">let</span> mainBundleId = bundleId.replacingOccurrences(of: <span class="string">"-LaunchAtLoginHelper"</span>, with: <span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// Ensure the app is not already running</span></span><br><span class="line">		<span class="keyword">guard</span> <span class="type">NSRunningApplication</span>.runningApplications(withBundleIdentifier: mainBundleId).isEmpty <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="type">NSApp</span>.terminate(<span class="literal">nil</span>)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">let</span> pathComponents = (<span class="type">Bundle</span>.main.bundlePath <span class="keyword">as</span> <span class="type">NSString</span>).pathComponents</span><br><span class="line">		<span class="keyword">let</span> mainPath = <span class="type">NSString</span>.path(withComponents: <span class="type">Array</span>(pathComponents[<span class="number">0</span>...(pathComponents.<span class="built_in">count</span> - <span class="number">5</span>)]))</span><br><span class="line">		<span class="type">NSWorkspace</span>.shared.launchApplication(mainPath)</span><br><span class="line">		<span class="type">NSApp</span>.terminate(<span class="literal">nil</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://jogendra.dev/implementing-launch-at-login-feature-in-macos-apps">https://jogendra.dev/implementing-launch-at-login-feature-in-macos-apps</a></li>
<li><a href="https://github.com/sindresorhus/LaunchAtLogin/blob/master/Sources/LaunchAtLogin/copy-helper.sh">https://github.com/sindresorhus/LaunchAtLogin/blob/master/Sources/LaunchAtLogin/copy-helper.sh</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-20T20:55:35.000Z" title="2021-01-20T20:55:35.000Z">2021-01-20</time><span class="level-item">a few seconds read (About 82 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-overlapped-navigation-titles-in-SwiftUI/">How to fix overlapped navigation titles in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/756">#756</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NavigationLink</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">fixOverlap</span><span class="params">()</span></span> -&gt; <span class="type">AnyView</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">UIDevice</span>.current.userInterfaceIdiom == .phone &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">self</span>.isDetailLink(<span class="literal">false</span>).erase()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">self</span>.erase()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://www.dabblingbadger.com/blog/2020/12/11/a-quick-fix-for-overlapping-navigation-titles-in-swiftui">https://www.dabblingbadger.com/blog/2020/12/11/a-quick-fix-for-overlapping-navigation-titles-in-swiftui</a><blockquote>
<p> As far as I can tell, this bug only shows up if you: 1) have the navigation title displayMode of a destination view set to .large and 2) have added items to the navigation bar using the .navigationBarItems modifier.</p>
</blockquote>
</li>
</ul>
<hr>
<p><strong>Updated at</strong> 2021-01-20 21:59:41</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-20T04:42:57.000Z" title="2021-01-20T04:42:57.000Z">2021-01-20</time><span class="level-item">a few seconds read (About 26 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-NSWindow-style-and-NSToolbar-in-AppKit/">How to use NSWindow style and NSToolbar in AppKit</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/755">#755</a></strong></p>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://github.com/martinlexow/SwiftUIWindowStyles">https://github.com/martinlexow/SwiftUIWindowStyles</a></li>
<li><a href="https://github.com/lukakerr/NSWindowStyles">https://github.com/lukakerr/NSWindowStyles</a></li>
<li><a href="https://github.com/marioaguzman/toolbar">https://github.com/marioaguzman/toolbar</a></li>
</ul>
<hr>
<p><strong>Updated at</strong> 2021-01-21 12:46:04</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2021-01-20T04:30:37.000Z" title="2021-01-20T04:30:37.000Z">2021-01-20</time><span class="level-item">a few seconds read (About 16 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-NSSplitViewController-in-AppKit/">How to use NSSplitViewController in AppKit</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/754">#754</a></strong></p>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://github.com/KevinGutowski/SplitConfigurations">https://github.com/KevinGutowski/SplitConfigurations</a></li>
</ul>
<hr>
<p><strong>Updated at</strong> 2021-01-20 05:30:46</p>
</div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/tags/swift/page/0/">Previous</a></div><div class="pagination-next"><a href="/tags/swift/page/2/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/tags/swift/">1</a></li><li><a class="pagination-link" href="/tags/swift/page/2/">2</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/tags/swift/page/13/">13</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">734</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">54</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://wwdctogether.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">WWDC Together</span></span><span class="level-right"><span class="level-item tag">wwdctogether.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-28T21:34:39.000Z">2021-02-28</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-name-Boolean-property-in-Swift/">How to name Boolean property in Swift</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-28T21:15:24.000Z">2021-02-28</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-with-block-configure-in-Swift/">How to use with block configure in Swift</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-26T12:14:41.000Z">2021-02-26</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-Core-Data/">How to use Core Data</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-26T08:09:09.000Z">2021-02-26</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-force-resolve-Swift-Package-in-Xcode/">How to force resolve Swift Package in Xcode</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-25T21:42:08.000Z">2021-02-25</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-listen-to-remote-changes-in-CloudKit-CoreData/">How to listen to remote changes in CloudKit CoreData</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">32</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">31</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">38</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featured/"><span class="tag">featured</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">174</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">51</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">137</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">24</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">365</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">103</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tweet/"><span class="tag">tweet</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">25</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2021 Khoa Pham</span>¬†¬†Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>¬†&amp;¬†<a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">√ó</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>