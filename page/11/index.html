<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/gumroad">Gumroad</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-21T08:55:27.000Z" title="2019-10-21T08:55:27.000Z">2019-10-21</time><span class="level-item">3 minutes read (About 486 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-error-message-like-Snack-Bar-in-iOS/">How to show error message like Snack Bar in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/472">#472</a></strong></p>
<h2 id="Build-error-view"><a href="#Build-error-view" class="headerlink" title="Build error view"></a>Build error view</h2><p>Use convenient code from <a href="https://github.com/onmyway133/Omnia">Omnia</a></p>
<p>To make view height dynamic, pin <code>UILabel</code> to edges and center</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorMessageView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> box: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = <span class="type">R</span>.color.primary</span><br><span class="line">        view.layer.cornerRadius = <span class="number">6</span></span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> label: <span class="type">UILabel</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line">        label.styleAsText()</span><br><span class="line">        label.textColor = <span class="type">R</span>.color.darkText</span><br><span class="line">        label.numberOfLines = <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> label</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubviews([box, label])</span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            box.pinEdges(view: <span class="keyword">self</span>, inset: <span class="type">UIEdgeInsets</span>.all(<span class="number">16</span>)),</span><br><span class="line">            label.pinEdges(view: box, inset: <span class="type">UIEdgeInsets</span>.all(<span class="number">8</span>))</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            box.heightAnchor.constraint(greaterThanOrEqualToConstant: <span class="number">48</span>)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            label.centerYAnchor.constraint(equalTo: centerYAnchor)</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Show-and-hide"><a href="#Show-and-hide" class="headerlink" title="Show and hide"></a>Show and hide</h2><p>Use Auto Layout and basic UIView animation. Use debouncer to avoid <code>hide</code> gets called for the new <code>show</code>. Use debouncer instead of <code>DispatchQueue.main.asyncAfter</code> because it can cancel the previous <code>DispatchWorkItem</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorMessageHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> view: <span class="type">UIView</span></span><br><span class="line">    <span class="keyword">let</span> errorMessageView = <span class="type">ErrorMessageView</span>()</span><br><span class="line">    <span class="keyword">let</span> debouncer = <span class="type">Debouncer</span>(delay: <span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(view: <span class="type">UIView</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.view = view</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">show</span><span class="params">(text: String)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.errorMessageView.label.text = text</span><br><span class="line">        view.addSubview(errorMessageView)</span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            errorMessageView.leftAnchor.constraint(equalTo: view.leftAnchor),</span><br><span class="line">            errorMessageView.rightAnchor.constraint(equalTo: view.rightAnchor),</span><br><span class="line">            errorMessageView.bottomAnchor.constraint(equalTo: view.safeAreaLayoutGuide.bottomAnchor)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        toggle(shows: <span class="literal">true</span>)</span><br><span class="line">        debouncer.run &#123;</span><br><span class="line">            <span class="keyword">self</span>.hide()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">hide</span><span class="params">()</span></span> &#123;</span><br><span class="line">        toggle(shows: <span class="literal">false</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">toggle</span><span class="params">(shows: Bool)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.errorMessageView.alpha = shows ? <span class="number">0</span> : <span class="number">1.0</span></span><br><span class="line">        <span class="type">UIView</span>.animate(withDuration: <span class="number">0.25</span>, animations: &#123;</span><br><span class="line">            <span class="keyword">self</span>.errorMessageView.alpha = shows ? <span class="number">1.0</span> : <span class="number">0</span></span><br><span class="line">        &#125;, completion: &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> shows &#123;</span><br><span class="line">                <span class="keyword">self</span>.view.bringSubviewToFront(<span class="keyword">self</span>.errorMessageView)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">self</span>.errorMessageView.removeFromSuperview()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Handle-keyboard"><a href="#Handle-keyboard" class="headerlink" title="Handle keyboard"></a>Handle keyboard</h2><p>If we add this error message on UIView in ViewController and we use <a href="https://onmyway133.github.io/blog/How-to-handle-keyboard-for-UITextField-in-scrolling-UIStackView-in-iOS/">KeyboardHandler</a> to scroll the entire view, then this snack bar will move up as well</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ErrorMessageHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> errorMessageView = <span class="type">ErrorMessageView</span>()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> view = <span class="type">UIView</span>()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> bottomOffset: <span class="type">CGFloat</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">on</span><span class="params">(view: UIView, bottomOffset: CGFloat)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.view = view</span><br><span class="line">        <span class="keyword">self</span>.bottomOffset = bottomOffset</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="UIView-animation-completion"><a href="#UIView-animation-completion" class="headerlink" title="UIView animation completion"></a>UIView animation completion</h2><p>One tricky thing is that if we call <code>hide</code> and then <code>show</code> immediately, the completion of <code>hide</code> will be called after and then remove the view.</p>
<p>When we start animation again, the previous animation is not finished, so we need to check</p>
<p>Read <a href="https://developer.apple.com/documentation/uikit/uiview/1622451-animate">UIView.animate</a></p>
<blockquote>
<p>completion<br>A block object to be executed when the animation sequence ends. This block has no return value and takes a single Boolean argument that indicates whether or not the animations actually finished before the completion handler was called. If the duration of the animation is 0, this block is performed at the beginning of the next run loop cycle. This parameter may be NULL.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">toggle</span><span class="params">(shows: Bool)</span></span> &#123;</span><br><span class="line">    <span class="keyword">self</span>.errorMessageView.alpha = shows ? <span class="number">0</span> : <span class="number">1.0</span></span><br><span class="line">    <span class="type">UIView</span>.animate(withDuration: <span class="number">0.25</span>, delay: <span class="number">0</span>, options: .curveEaseInOut, animations: &#123;</span><br><span class="line">        <span class="keyword">self</span>.errorMessageView.alpha = shows ? <span class="number">1.0</span> : <span class="number">0</span></span><br><span class="line">    &#125;, completion: &#123; finished <span class="keyword">in</span></span><br><span class="line">        <span class="keyword">if</span> shows &#123;</span><br><span class="line">            <span class="keyword">self</span>.view.bringSubviewToFront(<span class="keyword">self</span>.errorMessageView)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> finished &#123;</span><br><span class="line">            <span class="keyword">self</span>.errorMessageView.removeFromSuperview()</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// No op</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-18T11:26:07.000Z" title="2019-10-18T11:26:07.000Z">2019-10-18</time><span class="level-item">a few seconds read (About 53 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-hide-tab-bar-when-push-in-iOS/">How to hide tab bar when push in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/471">#471</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> navigationController = <span class="type">UINavigationController</span>(rootViewController: viewControllerA)</span><br><span class="line">navigationController.pushViewController(viewControllerB, animated: <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<p>In view controller B, need to set <code>hidesBottomBarWhenPushed</code> in init</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">ViewControllerB</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> mainView = <span class="type">EditPaymentMethodView</span>()</span><br><span class="line">    <span class="keyword">var</span> scenario: <span class="type">PaymentMethodScenario!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line"></span><br><span class="line">        hidesBottomBarWhenPushed = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-17T12:05:36.000Z" title="2019-10-17T12:05:36.000Z">2019-10-17</time><span class="level-item">a few seconds read (About 42 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-add-trailing-image-to-UILabel-in-iOS/">How to add trailing image to UILabel in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/470">#470</a></strong></p>
<p>Use <code>NSTextAttachment</code> inside <code>NSAttributedString</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UILabel</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addTrailing</span><span class="params">(image: UIImage)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> attachment = <span class="type">NSTextAttachment</span>()</span><br><span class="line">        attachment.image = image</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> attachmentString = <span class="type">NSAttributedString</span>(attachment: attachment)</span><br><span class="line">        <span class="keyword">let</span> string = <span class="type">NSMutableAttributedString</span>(string: <span class="keyword">self</span>.text!, attributes: [:])</span><br><span class="line"></span><br><span class="line">        string.append(attachmentString)</span><br><span class="line">        <span class="keyword">self</span>.attributedText = string</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-17T09:13:07.000Z" title="2019-10-17T09:13:07.000Z">2019-10-17</time><span class="level-item">a minute read (About 140 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-handle-different-states-in-a-screen-in-iOS/">How to handle different states in a screen in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/469">#469</a></strong></p>
<p>If there are lots of logics and states inside a screen, it is best to introduce parent and child container, and switch child depends on state. Each child acts as a State handler.</p>
<p>In less logic case, we can introduce a Scenario class that holds the state. So the <code>ViewController</code> can be very slim. The thing with State is that all possible scenarios are clear and required to be handled</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDetailScenario</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">State</span> </span>&#123;</span><br><span class="line">        <span class="keyword">case</span> unknown</span><br><span class="line">        <span class="keyword">case</span> getUser(<span class="type">Email</span>)</span><br><span class="line">        <span class="keyword">case</span> newUser(<span class="type">Email</span>)</span><br><span class="line">        <span class="keyword">case</span> existingUser(<span class="type">User</span>)</span><br><span class="line">        <span class="keyword">case</span> failure(<span class="type">Error</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> state: <span class="type">State</span> = .unknown(<span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.reload()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">reload</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> state &#123;</span><br><span class="line">        <span class="keyword">case</span> .unknown:</span><br><span class="line">            handleUnknown()</span><br><span class="line">        <span class="keyword">case</span> .getUser(<span class="keyword">let</span> email):</span><br><span class="line">            handleGetUser(email: email)</span><br><span class="line">        <span class="keyword">case</span> .newUser(<span class="keyword">let</span> email):</span><br><span class="line">            handleNewUser(email: email)</span><br><span class="line">        <span class="keyword">case</span> .existingUser(<span class="keyword">let</span> user):</span><br><span class="line">            handleExistingUser(user: user</span><br><span class="line">        <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">            logError(error)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-17T07:01:27.000Z" title="2019-10-17T07:01:27.000Z">2019-10-17</time><span class="level-item">2 minutes read (About 239 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-reload-data-without-using-onAppear-in-SwiftUI-in-watchOS/">How to reload data without using onAppear in SwiftUI in watchOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/468">#468</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/swiftui/text/3276931-onappear">onAppeear</a></p>
<blockquote>
<p>Adds an action to perform when the view appears.</p>
</blockquote>
<p>In theory, this should be triggered every time this view appears. But in practice, it is only called when it is pushed on navigation stack, not when we return to it.</p>
<p>So if user goes to a bookmark in a bookmark list, unbookmark an item and go back to the bookmark list, <code>onAppear</code> is not called again and the list is not updated.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BookmarksView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> service: <span class="type">Service</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> items: [<span class="type">AnyItem</span>]</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> storeContainer: <span class="type">StoreContainer</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(items)  &#123; item <span class="keyword">in</span></span><br><span class="line">            makeItemRow(item: item)</span><br><span class="line">                .padding([.top, .bottom], <span class="number">4</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .onAppear(perform: &#123;</span><br><span class="line">            <span class="keyword">self</span>.items = storeContainer.bookmarks(service: service).<span class="built_in">map</span>(&#123; <span class="type">AnyItem</span>(item: $<span class="number">0</span>) &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So instead of relying on UI state, we should rely on data state, by listening to <code>onReceive</code> and update our local <code>@State</code> </p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BookmarksView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> service: <span class="type">Service</span></span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> items: [<span class="type">AnyItem</span>]</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> storeContainer: <span class="type">StoreContainer</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(items)  &#123; item <span class="keyword">in</span></span><br><span class="line">            makeItemRow(item: item)</span><br><span class="line">                .padding([.top, .bottom], <span class="number">4</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        .onAppear(perform: &#123;</span><br><span class="line">            <span class="keyword">self</span>.reload()</span><br><span class="line">        &#125;)</span><br><span class="line">        .onReceive(storeContainer.objectWillChange, perform: &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.reload()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">reload</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.items = storeContainer.bookmarks(service: service).<span class="built_in">map</span>(&#123; <span class="type">AnyItem</span>(item: $<span class="number">0</span>) &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Inside our <code>ObservableObject</code>, we need to trigger changes notification</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StoreContainer</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> objectWillChange = <span class="type">PassthroughSubject</span>&lt;(), <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">bookmark</span><span class="params">(item: ItemProtocol)</span></span> &#123;</span><br><span class="line">        <span class="keyword">defer</span> &#123;</span><br><span class="line">            objectWillChange.send(())</span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">unbookmark</span><span class="params">(item: ItemProtocol)</span></span> &#123;</span><br><span class="line">        <span class="keyword">defer</span> &#123;</span><br><span class="line">            objectWillChange.send(())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2020-10-03 10:43:47</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-17T06:03:56.000Z" title="2019-10-17T06:03:56.000Z">2019-10-17</time><span class="level-item">a minute read (About 188 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-EnvironmentObject-in-SwiftUI-for-watchOS/">How to use EnvironmentObject in SwiftUI for watchOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/467">#467</a></strong></p>
<p>Declare top dependencies in ExtensionDelegate</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExtensionDelegate</span>: <span class="title">NSObject</span>, <span class="title">WKExtensionDelegate</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> storeContainer = <span class="type">StoreContainer</span>()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">applicationDidEnterBackground</span><span class="params">()</span></span> &#123;</span><br><span class="line">        storeContainer.save()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Reference that in <code>HostingController</code>. Note that we need to change from generic <code>MainView</code> to <code>WKHostingController&lt;AnyView&gt;</code> as <code>environmentObject</code> returns <code>View</code> protocol</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HostingController</span>: <span class="title">WKHostingController</span>&lt;<span class="title">AnyView</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> storeContainer: <span class="type">StoreContainer!</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">awake</span><span class="params">(withContext context: <span class="keyword">Any</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.awake(withContext: context)</span><br><span class="line">        <span class="keyword">self</span>.storeContainer = (<span class="type">WKExtension</span>.shared().delegate <span class="keyword">as</span>! <span class="type">ExtensionDelegate</span>).storeContainer</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> body: <span class="type">AnyView</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">MainView</span>()</span><br><span class="line">            .environmentObject(storeContainer)</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In theory, the environment object will be propagated down the view hierarchy, but in practice it throws error. So a workaround now is to just pass that environment object down manually</p>
<blockquote>
<p>Fatal error: No ObservableObject of type SomeType found<br>A View.environmentObject(_:) for StoreContainer.Type may be missing as an ancestor of this view</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">EnvironmentObject</span> <span class="keyword">var</span> storeContainer: <span class="type">StoreContainer</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123;</span><br><span class="line">            <span class="type">List</span>(services.<span class="built_in">map</span>(&#123; <span class="type">AnyService</span>($<span class="number">0</span>) &#125;)) &#123; anyService <span class="keyword">in</span></span><br><span class="line">                <span class="type">NavigationLink</span>(destination:</span><br><span class="line">                    <span class="type">ItemsView</span>(service: anyService.service)</span><br><span class="line">                        .navigationBarTitle(anyService.service.name)</span><br><span class="line">                        .onDisappear(perform: &#123;</span><br><span class="line">                            anyService.service.requestCancellable?.cancel()</span><br><span class="line">                        &#125;)</span><br><span class="line">                        .environmentObject(storeContainer)</span><br><span class="line">                ) &#123;</span><br><span class="line">                    <span class="type">HStack</span> &#123;</span><br><span class="line">                        <span class="type">Image</span>(anyService.service.name)</span><br><span class="line">                            .resizable()</span><br><span class="line">                            .frame(width: <span class="number">30</span>, height: <span class="number">30</span>, alignment: .leading)</span><br><span class="line">                        <span class="type">Text</span>(anyService.service.name)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;.listStyle(<span class="type">CarouselListStyle</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<p><strong>Updated at</strong> 2020-06-26 03:54:01</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-16T06:05:05.000Z" title="2019-10-16T06:05:05.000Z">2019-10-16</time><span class="level-item">a few seconds read (About 27 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-structure-classes/">How to structure classes</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/466">#466</a></strong></p>
<p>iOS</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">View Controller -&gt; View Model | Logic Handler -&gt; Data Handler -&gt; Repo</span><br></pre></td></tr></table></figure>

<p>Android</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Activity -&gt; Fragment -&gt; View Model | Logic Handler -&gt; Data Handler -&gt; Repo</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-14T19:41:28.000Z" title="2019-10-14T19:41:28.000Z">2019-10-14</time><span class="level-item">a minute read (About 128 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-generic-store-for-Codable-in-Swift/">How to make generic store for Codable in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/465">#465</a></strong></p>
<p>Use <a href="https://github.com/onmyway133/EasyStash">EasyStash</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> EasyStash</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Store</span>&lt;<span class="title">T</span>: <span class="title">Codable</span> &amp; <span class="title">ItemProtocol</span>&gt;: <span class="title">Codable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> items = [<span class="type">T</span>]()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">bookmark</span><span class="params">(item: T)</span></span> &#123;</span><br><span class="line">        items.append(item)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">unbookmark</span><span class="params">(item: T)</span></span> &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> index = items.firstIndex(<span class="keyword">where</span>: &#123; $<span class="number">0</span>.itemId == item.itemId &#125;) <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        items.remove(at: index)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isBookmark</span><span class="params">(item: T)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> items.<span class="built_in">contains</span>(<span class="keyword">where</span>: &#123; $<span class="number">0</span>.itemId == item.itemId &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> EasyStash</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">StoreContainer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> food: <span class="type">Store</span>&lt;<span class="type">Food</span>&gt;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> shared = <span class="type">StoreContainer</span>()</span><br><span class="line">    <span class="keyword">let</span> storage = <span class="keyword">try</span>! <span class="type">Storage</span>(options: <span class="type">Options</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        food = <span class="keyword">try</span>? storage.load(forKey: <span class="string">"food"</span>, <span class="keyword">as</span>: <span class="type">Store</span>&lt;<span class="type">Food</span>&gt;.<span class="keyword">self</span>) ?? <span class="type">Store</span>&lt;<span class="type">Food</span>&gt;()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If Swift has problem compiling because of generic, use try catch to declare in multiple steps in stead of <code>??</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">init</span>() &#123;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.food = <span class="keyword">try</span> storage.load(forKey: <span class="string">"food"</span>, <span class="keyword">as</span>: <span class="type">Store</span>&lt;<span class="type">Food</span>&gt;.<span class="keyword">self</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.food = <span class="type">Store</span>&lt;<span class="type">Food</span>&gt;()</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-14T11:57:55.000Z" title="2019-10-14T11:57:55.000Z">2019-10-14</time><span class="level-item">a few seconds read (About 23 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-declare-escaping-in-completion-in-callback-in-Swift/">How to declare escaping in completion in callback in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/464">#464</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">Completion</span> = (<span class="type">Result</span>&lt;<span class="type">User</span>, <span class="type">Error</span>&gt;) -&gt; <span class="type">Void</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">validate</span><span class="params">(completion: @escaping Completion, then: <span class="params">(String, String, @escaping Completion)</span></span></span> -&gt; <span class="type">Void</span>) &#123;&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-14T06:49:31.000Z" title="2019-10-14T06:49:31.000Z">2019-10-14</time><span class="level-item">a few seconds read (About 33 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-zoom-to-fit-many-coordinates-in-Google-Maps-in-iOS/">How to zoom to fit many coordinates in Google Maps in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/463">#463</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">zoom</span><span class="params">(location1: CLLocation, location2: CLLocation)</span></span> &#123;</span><br><span class="line">    <span class="keyword">let</span> bounds = <span class="type">GMSCoordinateBounds</span>(coordinate: location1.coordinate, coordinate: location2.coordinate)</span><br><span class="line">    <span class="keyword">let</span> update = <span class="type">GMSCameraUpdate</span>.fit(bounds, withPadding: <span class="number">16</span>)</span><br><span class="line">    mapView.animate(with: update)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-11T11:22:09.000Z" title="2019-10-11T11:22:09.000Z">2019-10-11</time><span class="level-item">a minute read (About 115 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Codable-to-store-preferences-in-Swift/">How to use Codable to store preferences in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/462">#462</a></strong></p>
<p>Using object, we dont need to care about <code>nil</code> vs <code>false</code> like in UserDefaults, our object is the source of truth</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StoringHandler</span>&lt;<span class="title">T</span>: <span class="title">Codable</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> key: <span class="type">Storage</span>.<span class="type">Keys</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> storage = <span class="type">Deps</span>.storage</span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(key: <span class="type">Storage</span>.<span class="type">Keys</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.key = key</span><br><span class="line">        load()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> object: <span class="type">T?</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> object = object &#123;</span><br><span class="line">                <span class="keyword">try</span>? storage.save(object: object, key: key)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">try</span>? storage.clear(key: key)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">load</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.object = <span class="keyword">try</span>? storage.load(key: key, <span class="keyword">as</span>: <span class="type">T</span>.<span class="keyword">self</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then subclass <code>StoringHandler</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OnboardInfo</span>: <span class="title">Codable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> hasOnboarded: <span class="type">Bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">OnboardingHandler</span>: <span class="title">StoringHandler</span>&lt;<span class="title">OnboardInfo</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> storage = <span class="type">Deps</span>.storage</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> hasOnboarded: <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> object?.hasOnboarded ?? <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            object = <span class="type">OnboardInfo</span>(hasOnboarded: newValue)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-11T11:17:14.000Z" title="2019-10-11T11:17:14.000Z">2019-10-11</time><span class="level-item">2 minutes read (About 271 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-custom-UIAlertController-in-iOS/">How to custom UIAlertController in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/461">#461</a></strong></p>
<p>With <a href="https://developer.apple.com/documentation/uikit/uialertcontroller">UIAlertController</a> we can add buttons and textfields, and just that</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addAction</span><span class="params">(UIAlertAction)</span></span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addTextField</span><span class="params">(configurationHandler: <span class="params">(<span class="params">(UITextField)</span></span></span></span> -&gt; <span class="type">Void</span>)?)</span><br></pre></td></tr></table></figure>

<p>To add custom content to UIAlertController, there are some workarounds</p>
<h3 id="Add-content-onto-UITextField"><a href="#Add-content-onto-UITextField" class="headerlink" title="Add content onto UITextField"></a>Add content onto UITextField</h3><p>Restyle <code>UITextField</code> and add custom content</p>
<h3 id="Subclass-UIAlertController-and-handle-UI-in-viewWillAppear"><a href="#Subclass-UIAlertController-and-handle-UI-in-viewWillAppear" class="headerlink" title="Subclass UIAlertController and handle UI in viewWillAppear"></a>Subclass UIAlertController and handle UI in viewWillAppear</h3><p>By subclassing we can tweak the whole view hierarchy and listen to events like layout subviews, but this can be very fragile.</p>
<h3 id="Make-custom-UIViewController-that-looks-like-UIAlertController"><a href="#Make-custom-UIViewController-that-looks-like-UIAlertController" class="headerlink" title="Make custom UIViewController that looks like UIAlertController"></a>Make custom UIViewController that looks like UIAlertController</h3><p>This is the correct way but takes too much time to imitate UIAlertController, and have to deal with UIVisualEffectView, resize view for different screen sizes and dark mode</p>
<h3 id="Add-view-to-UIAlertController-view"><a href="#Add-view-to-UIAlertController-view" class="headerlink" title="Add view to UIAlertController view"></a>Add view to UIAlertController view</h3><p>We can detect <code>UILabel</code> to add our custom view below it, using <a href="https://onmyway133.github.io/blog/How-to-find-subview-recursively-in-Swift/">How to find subview recursively in Swift</a></p>
<p>But a less work approach is to add it above buttons, this is easily achieved by offsetting bottom.</p>
<img width="295" alt="alert" src="https://user-images.githubusercontent.com/2284279/66654203-ff2de680-ec39-11e9-995a-60435532f184.png">

<p>The trick is here is to have line breaks in message to leave space for our custom view.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> controller = <span class="type">UIAlertController</span>(</span><br><span class="line">    title: title,</span><br><span class="line">    message: message + <span class="type">String</span>(repeating: <span class="string">"\n"</span>, <span class="built_in">count</span>: <span class="number">10</span>),</span><br><span class="line">    preferredStyle: .alert</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> continueAction = <span class="type">UIAlertAction</span>(</span><br><span class="line">    title: <span class="type">R</span>.string.localizable.<span class="keyword">continue</span>(),</span><br><span class="line">    style: .<span class="keyword">default</span>) &#123; <span class="number">_</span> <span class="keyword">in</span></span><br><span class="line">        action()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cancelAction = <span class="type">UIAlertAction</span>(title: <span class="type">R</span>.string.localizable.cancel(), style: .cancel)</span><br><span class="line">controller.addAction(cancelAction)</span><br><span class="line">controller.addAction(continueAction)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> customView = <span class="type">UIView</span>()</span><br><span class="line">customView.backgroundColor = <span class="type">UIColor</span>.green</span><br><span class="line"></span><br><span class="line">controller.view.addSubview(customView)</span><br><span class="line"><span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">    customView.leftAnchor.constraint(equalTo: controller.view.leftAnchor),</span><br><span class="line">    customView.rightAnchor.constraint(equalTo: controller.view.rightAnchor),</span><br><span class="line">    customView.bottomAnchor.constraint(equalTo: controller.view.bottomAnchor, constant: -<span class="number">50</span>),</span><br><span class="line">    customView.heightAnchor.constraint(equalToConstant: <span class="number">100</span>)</span><br><span class="line">])</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-11T09:06:50.000Z" title="2019-10-11T09:06:50.000Z">2019-10-11</time><span class="level-item">a few seconds read (About 43 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-find-subview-recursively-in-Swift/">How to find subview recursively in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/460">#460</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">findRecursively</span>&lt;T: UIView&gt;<span class="params">(type: T.<span class="keyword">Type</span>, match: <span class="params">(T)</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; <span class="type">T?</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> view <span class="keyword">in</span> subviews &#123;</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> subview = view <span class="keyword">as</span>? <span class="type">T</span>, match(subview) &#123;</span><br><span class="line">                <span class="keyword">return</span> subview</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> view.findRecursively(type: type, match: match)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-11T06:54:23.000Z" title="2019-10-11T06:54:23.000Z">2019-10-11</time><span class="level-item">9 minutes read (About 1419 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-deal-with-multiple-scenarios-with-Push-Notification-in-iOS/">How to deal with multiple scenarios with Push Notification in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/459">#459</a></strong></p>
<p>Here are my notes when working with Push Notification</p>
<h3 id="How-to-register"><a href="#How-to-register" class="headerlink" title="How to register"></a>How to register</h3><p><strong>Register to receive push notification</strong></p>
<p>registerForRemoteNotificationTypes is deprecated in iOS 8+</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UIApplication</span>.sharedApplication().registerForRemoteNotifications()</span><br></pre></td></tr></table></figure>

<p><strong>Register to alert user through UI</strong></p>
<blockquote>
<p>If your app displays alerts, play sounds, or badges its icon, you must call this method during your launch cycle to request permission to alert the user in these ways</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> types: <span class="type">UIUserNotificationType</span> = [.<span class="type">Badge</span>, .<span class="type">Sound</span>, .<span class="type">Alert</span>]</span><br><span class="line"><span class="keyword">let</span> categories = <span class="type">Set</span>&lt;<span class="type">UIUserNotificationCategory</span>&gt;()</span><br><span class="line"><span class="keyword">let</span> settings = <span class="type">UIUserNotificationSettings</span>(forTypes: types, categories: categories)</span><br><span class="line"></span><br><span class="line"><span class="type">UIApplication</span>.sharedApplication().registerUserNotificationSettings(settings)</span><br></pre></td></tr></table></figure>

<p>You dont need to wait for registerUserNotificationSettings to callback before calling registerForRemoteNotifications</p>
<p>From iOS 10, use <code>UNNotifications</code> framework <a href="https://onmyway133.github.io/blog/How-to-register-for-alert-push-notification-in-iOS/">https://onmyway133.github.io/blog/How-to-register-for-alert-push-notification-in-iOS/</a></p>
<h3 id="When-to-register"><a href="#When-to-register" class="headerlink" title="When to register"></a><strong>When to register</strong></h3><p>From <a href="https://developer.apple.com/library/mac/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/IPhoneOSClientImp.html">Registering, Scheduling, and Handling User Notifications</a></p>
<blockquote>
<p>Never cache a device token; always get the token from the system whenever you need it. If your app previously registered for remote notifications, calling the registerForRemoteNotifications method again does not incur any additional overhead, and iOS returns the existing device token to your app delegate immediately. In addition, iOS calls your delegate method any time the device token changes, not just in response to your app registering or re-registering<br>The user can change the notification settings for your app at any time using the Settings app. Because settings can change, always call the registerUserNotificationSettings: at launch time and use the application:didRegisterUserNotificationSettings: method to get the response. If the user disallows specific notification types, avoid using those types when configuring local and remote notifications for your app.</p>
</blockquote>
<p><strong>didReceiveRemoteNotification</strong></p>
<p>About application:didReceiveRemoteNotification:</p>
<blockquote>
<p>Implement the application:didReceiveRemoteNotification:fetchCompletionHandler: method instead of this one whenever possible. If your delegate implements both methods, the app object calls the application:didReceiveRemoteNotification:fetchCompletionHandler: method.<br>If the app is not running when a remote notification arrives, the method launches the app and provides the appropriate information in the launch options dictionary. The app does not call this method to handle that remote notification. Instead, your implementation of the application:willFinishLaunchingWithOptions: or application:didFinishLaunchingWithOptions: method needs to get the remote notification payload data and respond appropriately.</p>
</blockquote>
<p>About application:didReceiveRemoteNotification:fetchCompletionHandler:</p>
<p>This is for silent push notification with <code>content-available</code></p>
<blockquote>
<p>Unlike the application:didReceiveRemoteNotification: method, which is called only when your app is running in the foreground, the system calls this method when your app is running in the foreground or background<br>In addition, if you enabled the remote notifications background mode, the system launches your app (or wakes it from the suspended state) and puts it in the background state when a push notification arrives. However, the system does not automatically launch your app if the user has force-quit it. In that situation, the user must relaunch your app or restart the device before the system attempts to launch your app automatically again.<br>If the user opens your app from the system-displayed alert, the system may call this method again when your app is about to enter the foreground so that you can update your user interface and display information pertaining to the notification.</p>
</blockquote>
<h3 id="How-to-handle"><a href="#How-to-handle" class="headerlink" title="How to handle"></a>How to handle</h3><p>Usually, the use of push notification is to display a specific article, a specific DetailViewControllerin your app. So the good practices are</p>
<ul>
<li><p>When the app is in foreground: Gently display some kind of alert view and ask the user whether he would like to go to that specific page or not</p>
</li>
<li><p>When user is brought from background to foreground, or from terminated to foreground: Just navigate to that specific page. For example, if you use UINavigationController, you can set that specific page the top most ViewController, if you use UITabBarController, you can set that specific page the selected tab, something like that</p>
</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- <span class="function"><span class="keyword">func</span> <span class="title">handlePushNotification</span><span class="params">(userInfo: NSDictionary)</span></span> &#123;</span><br><span class="line">    <span class="comment">// Check applicationState</span></span><br><span class="line">	<span class="keyword">if</span> (applicationState == <span class="type">UIApplicationStateActive</span>) &#123;</span><br><span class="line">        <span class="comment">// Application is running in foreground</span></span><br><span class="line">        showAlertForPushNotification(userInfo)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (applicationState == <span class="type">UIApplicationStateBackground</span> || applicationState == <span class="type">UIApplicationStateInactive</span>) &#123;</span><br><span class="line">    <span class="comment">// Application is brought from background or launched after terminated</span></span><br><span class="line">        handlePushNotification(userInfo)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here we create another method handlePushNotification to handle push notification. When you receive push notification, 3 cases can occur</p>
<h3 id="Case-1-Foreground"><a href="#Case-1-Foreground" class="headerlink" title="Case 1: Foreground"></a>Case 1: Foreground</h3><p><strong>Loud push</strong></p>
<ul>
<li><p>No system alert</p>
</li>
<li><p>application:didReceiveRemoteNotification:fetchCompletionHandler: is called</p>
</li>
</ul>
<p><strong>Silent push</strong></p>
<ul>
<li><p>No system alert</p>
</li>
<li><p>application:didReceiveRemoteNotification:fetchCompletionHandler: is called</p>
</li>
</ul>
<h3 id="Case-2-Background"><a href="#Case-2-Background" class="headerlink" title="Case 2: Background"></a>Case 2: Background</h3><p><strong>Loud push</strong></p>
<ul>
<li><p>System alert</p>
</li>
<li><p>No method called</p>
</li>
<li><p>Tap notification and application:didReceiveRemoteNotification:fetchCompletionHandler: is called</p>
</li>
<li><p>Tap on App Icon and nothing is called</p>
</li>
</ul>
<p><strong>Silent push</strong></p>
<ul>
<li><p>No system alert</p>
</li>
<li><p>application:didReceiveRemoteNotification:fetchCompletionHandler: is called. If app is suspended, its state changed to UIApplicationStateBackground</p>
</li>
<li><p>Tap notification and application:didReceiveRemoteNotification:fetchCompletionHandler: is called</p>
</li>
<li><p>Tap on App Icon and nothing is called</p>
</li>
</ul>
<h3 id="Case-3-Terminated"><a href="#Case-3-Terminated" class="headerlink" title="Case 3: Terminated"></a>Case 3: Terminated</h3><p><strong>Loud push</strong></p>
<ul>
<li><p>System alert</p>
</li>
<li><p>No method called</p>
</li>
<li><p>Tap notification and application:didFinishLaunchingWithOptions: with launchOptions, application:didReceiveRemoteNotification:fetchCompletionHandler: is called</p>
</li>
<li><p>Tap on App Icon and application:didFinishLaunchingWithOptions: is called with launchOptions set to nil</p>
</li>
</ul>
<p><strong>Silent push</strong></p>
<ul>
<li><p>No system alert</p>
</li>
<li><p>application:didReceiveRemoteNotification:fetchCompletionHandler: is called. If app was not killed by user, it is woke up and state changed to UIApplicationStateInactive.</p>
</li>
<li><p>Tap notification and application:didFinishLaunchingWithOptions: with launchOptions, application:didReceiveRemoteNotification:fetchCompletionHandler: is called</p>
</li>
<li><p>Tap on App Icon and application:didFinishLaunchingWithOptions: is called with launchOptions set to nil</p>
</li>
</ul>
<h3 id="System-alert"><a href="#System-alert" class="headerlink" title="System alert"></a>System alert</h3><p>System alert only show if the payload contains alert</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"aps"</span> : &#123;</span><br><span class="line">        <span class="attr">"alert"</span> : &#123;</span><br><span class="line">            <span class="attr">"title"</span> : <span class="string">"Game Request"</span>,</span><br><span class="line">            <span class="attr">"body"</span> : <span class="string">"Bob wants to play poker"</span>,</span><br><span class="line">            <span class="attr">"action-loc-key"</span> : <span class="string">"PLAY"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"badge"</span> : <span class="number">5</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"param1"</span> : <span class="string">"bar"</span>,</span><br><span class="line">    <span class="attr">"param2"</span> : [ <span class="string">"bang"</span>,  <span class="string">"whiz"</span> ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Silent-push-payload"><a href="#Silent-push-payload" class="headerlink" title="Silent push payload"></a>Silent push payload</h3><p>For now I see that silent push must contain sound for application:didReceiveRemoteNotification:fetchCompletionHandler: to be called when app is in background</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> aps: &#123;</span><br><span class="line"> content-available: <span class="number">1</span>,</span><br><span class="line"> alert: hello <span class="comment">// include this if we want to show alert</span></span><br><span class="line"> sound:  <span class="comment">// this does the trick</span></span><br><span class="line"> &#125;,</span><br><span class="line"> param1: <span class="number">1</span>,</span><br><span class="line"> param2: text</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Read <a href="https://developer.apple.com/documentation/usernotifications/setting_up_a_remote_notification_server/pushing_background_updates_to_your_app">Pushing Background Updates to Your App</a></p>
<blockquote>
<p>If your apps server-based content changes infrequently or at irregular intervals, you can use background notifications to notify your app when new content becomes available. A background notification is a remote notification that doesnt display an alert, play a sound, or badge your apps icon. It wakes your app in the background and gives it time to initiate downloads from your server and update its content.</p>
</blockquote>
<blockquote>
<p>The system treats background notifications as low-priority: you can use them to refresh your apps content, but the system doesnt guarantee their delivery. In addition, the system may throttle the delivery of background notifications if the total number becomes excessive. The number of background notifications allowed by the system depends on current conditions, but dont try to send more than two or three per hour.</p>
</blockquote>
<h2 id="How-to-test-Push-notification"><a href="#How-to-test-Push-notification" class="headerlink" title="How to test Push notification"></a>How to test Push notification</h2><p>I built a macOS app called <a href="https://github.com/onmyway133/PushNotifications">PushNotification</a> for you to test push notification. It works with certificate and the new key authentication with APNS. Please give it a try</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*59zWlEQGvO8-OXMq.png" alt=""></p>
<p>Tutorials that use PushNotifications</p>
<ul>
<li><a href="https://itnext.io/introductory-push-notifications-fa6f68ace251">https://itnext.io/introductory-push-notifications-fa6f68ace251</a></li>
<li><a href="https://www.raywenderlich.com/8164-push-notifications-tutorial-getting-started">https://www.raywenderlich.com/8164-push-notifications-tutorial-getting-started</a></li>
</ul>
<h2 id="Troubleshooting"><a href="#Troubleshooting" class="headerlink" title="Troubleshooting"></a>Troubleshooting</h2><h3 id="Silent-notification-with-push-notification-enabled"><a href="#Silent-notification-with-push-notification-enabled" class="headerlink" title="Silent notification with push notification enabled"></a>Silent notification with push notification enabled</h3><p>In theory, if user disables push notification then silent notification still goes through </p>
<p><a href="https://stackoverflow.com/questions/31450403/didreceiveremotenotification-not-working-in-the-background">https://stackoverflow.com/questions/31450403/didreceiveremotenotification-not-working-in-the-background</a></p>
<p>but <code>sound</code> key should be present</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    aps = &#123;</span><br><span class="line">        "content-available" : 1,</span><br><span class="line">        sound : ""</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When open the app, <code>didReceiveRemoteNotification</code> is called immediately with the silent push message</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>I hope you find this article useful. iOS changes fast so some the things I mention may be outdated by the time you read, if so please let me know. Here are some more interesting links</p>
<ul>
<li><a href="https://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/Chapters/IPhoneOSClientImp.html">Scheduling, Registering, and Handling Notifications</a></li>
<li><a href="http://www.abdus.me/ios-programming-tips/handle-push-notifications-when-arrived-ios/">Handle push notifications when arrived in iOS application</a></li>
<li><a href="http://stackoverflow.com/questions/5099483/how-to-respond-to-push-notification-view-if-app-is-already-running-in-the-backgr">How to respond to push notification view if app is already running in the background</a></li>
<li><a href="http://stackoverflow.com/questions/5056689/didreceiveremotenotification-when-in-background">didReceiveRemoteNotification when in background</a></li>
<li><a href="https://samwize.com/2015/08/07/how-to-handle-remote-notification-with-background-mode-enabled/">How to handle remote notification with background mode enabled</a></li>
<li><a href="http://stackoverflow.com/questions/20569201/remote-notification-method-called-twice">Remote notification method called twice</a></li>
</ul>
<hr>
<p>Original post <a href="https://medium.com/fantageek/push-notification-in-ios-46d979e5f7ec">https://medium.com/fantageek/push-notification-in-ios-46d979e5f7ec</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-11T06:04:26.000Z" title="2019-10-11T06:04:26.000Z">2019-10-11</time><span class="level-item">a minute read (About 154 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Apple-certificate-in-Xcode-11/">How to use Apple certificate in Xcode 11</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/458">#458</a></strong></p>
<p>For push notification, we can now use just Production Certificate for 2 environments (production and sandbox) instead of Development and Production certificates.</p>
<p>Now for code signing, with Xcode 11 <a href="https://developer.apple.com/documentation/xcode_release_notes/xcode_11_release_notes">https://developer.apple.com/documentation/xcode_release_notes/xcode_11_release_notes</a> we can just use Apple Development and Apple Distribution certificate for multiple platforms</p>
<blockquote>
<p> Signing and capabilities settings are now combined within a new Signing &amp; Capabilities tab in the Project Editor. The new tab enables using different app capabilities across multiple build configurations. The new capabilities library makes it possible to search for available capabilities</p>
</blockquote>
<blockquote>
<p>Xcode 11 supports the new Apple Development and Apple Distribution certificate types. These certificates support building, running, and distributing apps on any Apple platform. Preexisting iOS and macOS development and distribution certificates continue to work, however, new certificates you create in Xcode 11 use the new types. Previous versions of Xcode dont support these certificates</p>
</blockquote>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-10T17:19:20.000Z" title="2019-10-10T17:19:20.000Z">2019-10-10</time><span class="level-item">a few seconds read (About 88 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-create-watch-only-watchOS-app/">How to create watch only watchOS app</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/457">#457</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/watchkit/creating_independent_watchos_apps">Creating Independent watchOS Apps</a></p>
<blockquote>
<p>The root target is a stub, and acts as a wrapper for your project, so that you can submit it to the App Store. The other two are identical to the targets found in a traditional watchOS project. They represent your WatchKit app and WatchKit extension, respectively.</p>
</blockquote>
<p><img src="https://docs-assets.developer.apple.com/published/52616fcb34/02ac2063-b61c-45ec-963a-f9e6e8f05cbe.png" alt=""></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-10T11:14:20.000Z" title="2019-10-10T11:14:20.000Z">2019-10-10</time><span class="level-item">2 minutes read (About 346 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-provisional-notification-in-iOS-12/">How to use provisional notification in iOS  12</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/456">#456</a></strong></p>
<p>From <a href="https://developer.apple.com/videos/play/wwdc2018/710/?time=1797">WWDC 2018  Whats New in User Notifications</a></p>
<blockquote>
<p>Instead, the notifications from your app will automatically start getting delivered.</p>
</blockquote>
<blockquote>
<p>Notifications that are delivered with provisional authorization will have a prompt like this on the notification itself. And this will help the users decide after having received a few notifications whether they want to keep getting these notifications or whether they want to turn them off</p>
</blockquote>
<blockquote>
<p>Its an automatic trial of the notifications from your app to help your users make a more informed decision about whether they want these notifications.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">notificationCenter.requestAuthorization(  </span><br><span class="line">     options:[.badge, .sound, .alert, .provisional]) &#123;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From <a href="http://info.localytics.com/blog/ios-12-brings-new-power-to-push-notifications">http://info.localytics.com/blog/ios-12-brings-new-power-to-push-notifications</a></p>
<blockquote>
<p> Provisional Authorization takes advantage of another new feature in iOS 12: the ability for messages to be delivered quietly. When a notification is delivered quietly, it can only be seen in the iOS Notification Center, which the user accesses by swiping down from the top of their phone. They dont appear as banners or show up on the lock screen. As you might have guessed, quiet notifications also dont make a sound.</p>
</blockquote>
<p><img src="https://info.localytics.com/hs-fs/hubfs/Provisional%20Push%20Keep%20Confirmation%20on%20iPhone.png?width=500&name=Provisional%20Push%20Keep%20Confirmation%20on%20iPhone.png" alt=""></p>
<blockquote>
<p> If a user taps the Keep button, they can decide whether they want your apps notifications to start getting delivered prominently (i.e. fully opt-in to push notifications) or continue to receive them quietly (i.e. pushes continue to get sent directly to the Notification Center).</p>
</blockquote>
<blockquote>
<p>The intent of Provisional Authorization is to give users a trial run with your apps notifications. Apple created Provisional Authorization because it realized that its impossible for users to make an informed choice about whether or not they want to receive push notifications from an app until theyve seen what kinds of messages the app is going to send them.</p>
</blockquote>
<hr>
<p><strong>Updated at</strong> 2020-11-11 02:04:01</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-10T10:50:26.000Z" title="2019-10-10T10:50:26.000Z">2019-10-10</time><span class="level-item">2 minutes read (About 292 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-check-if-push-notification-is-actually-enabled-in-iOS/">How to check if push notification is actually enabled in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/455">#455</a></strong></p>
<p>There are times we want to log if user can receive push notification. We may be tempted to merely use <code>isRegisteredForRemoteNotifications</code> but that is not enough. From a user s point of view, they can either receive push notification or not. But behind the scene, many factors are in the game. It can be that user has disabled push notification in app settings or in iOS Settings. It can also be that user enables push notification but disables all sound or banner display mechanism.</p>
<p><code>isRegisteredForRemoteNotifications</code> is that your app has connected to APNS and get device token, this can be for silent push notification<br><code>currentUserNotificationSettings</code> is for user permissions, without this, there is no alert, banner or sound push notification delivered to the app<br>Here is the check</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">var</span> isPushNotificationEnabled: <span class="type">Bool</span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> <span class="keyword">let</span> settings = <span class="type">UIApplication</span>.shared.currentUserNotificationSettings</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="type">UIApplication</span>.shared.isRegisteredForRemoteNotifications</span><br><span class="line">    &amp;&amp; !settings.types.isEmpty</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For iOS 10, with the introduction of <code>UserNotifications</code> framework, instead of checking for <code>currentUserNotificationSettings</code>, you should use UserNotifications framework</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">center.getNotificationSettings(completionHandler: &#123; settings <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">switch</span> settings.authorizationStatus &#123;</span><br><span class="line">  <span class="keyword">case</span> .authorized, .provisional:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"authorized"</span>)</span><br><span class="line">  <span class="keyword">case</span> .denied:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"denied"</span>)</span><br><span class="line">  <span class="keyword">case</span> .notDetermined:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"not determined, ask user for permission now"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>Push notification can be delivered to our apps in many ways, and we can ask for that</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UNUserNotificationCenter</span>.current()</span><br><span class="line">  .requestAuthorization(options: [.alert, .sound, .badge])</span><br></pre></td></tr></table></figure>

<p>User can go to Settings app and turn off any of those at any time, so its best to check for that in the settings object</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">open</span> <span class="class"><span class="keyword">class</span> <span class="title">UNNotificationSettings</span> : <span class="title">NSObject</span>, <span class="title">NSCopying</span>, <span class="title">NSSecureCoding</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">var</span> authorizationStatus: <span class="type">UNAuthorizationStatus</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">var</span> soundSetting: <span class="type">UNNotificationSetting</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">var</span> badgeSetting: <span class="type">UNNotificationSetting</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">var</span> alertSetting: <span class="type">UNNotificationSetting</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">open</span> <span class="keyword">var</span> notificationCenterSetting: <span class="type">UNNotificationSetting</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Original answer <a href="https://stackoverflow.com/a/44407710/1418457">https://stackoverflow.com/a/44407710/1418457</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-10T10:45:29.000Z" title="2019-10-10T10:45:29.000Z">2019-10-10</time><span class="level-item">a minute read (About 216 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-UserNotificationsUI-in-iOS/">How to use UserNotificationsUI in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/454">#454</a></strong></p>
<p>From documentation <a href="https://developer.apple.com/documentation/usernotificationsui">https://developer.apple.com/documentation/usernotificationsui</a></p>
<blockquote>
<p>Customize how local and remote notifications appear on the users device by adding a notification content app extension to the bundle of your iOS app. Your extension manages a custom view controller, which you use to present the content from incoming notifications. When a notification arrives, the system displays your view controller in addition to, or in place of, the default system interface.</p>
</blockquote>
<p><a href="https://developer.apple.com/documentation/usernotificationsui/customizing_the_appearance_of_notifications">https://developer.apple.com/documentation/usernotificationsui/customizing_the_appearance_of_notifications</a></p>
<blockquote>
<p>When an iOS device receives a notification containing an alert, the system displays the contents of the alert in two stages. Initially, it displays an abbreviated banner with the title, subtitle, and two to four lines of body text from the notification. If the user presses the abbreviated banner, iOS displays the full notification interface, including any notification-related actions. The system provides the interface for the abbreviated banner, but you can customize the full interface using a notification content app extension.</p>
</blockquote>
<p><img src="https://docs-assets.developer.apple.com/published/ff99a71282/b6f2b1aa-fb42-4517-b5b8-9e955c6455da.png" alt=""></p>
<p>Use <code>Notification Content Extension</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">didReceive</span><span class="params">(<span class="number">_</span> notification: UNNotification)</span></span> &#123;</span><br><span class="line">   <span class="keyword">self</span>.bodyText?.text = notification.request.content.body</span><br><span class="line">   <span class="keyword">self</span>.headlineText?.text = notification.request.content.title</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-10T08:17:42.000Z" title="2019-10-10T08:17:42.000Z">2019-10-10</time><span class="level-item">a minute read (About 132 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-AnyHashable-in-Swift/">How to use AnyHashable in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/453">#453</a></strong></p>
<p>From documentation</p>
<blockquote>
<p>A type-erased hashable value.</p>
</blockquote>
<blockquote>
<p>DiscussionThe AnyHashable type forwards equality comparisons and hashing operations to an underlying hashable value, hiding its specific underlying type.You can store mixed-type keys in dictionaries and other collections that require Hashable conformance by wrapping mixed-type keys in AnyHashable instances</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> descriptions: [<span class="type">AnyHashable</span>: <span class="type">Any</span>] = [</span><br><span class="line">    <span class="type">AnyHashable</span>(<span class="string">""</span>): <span class="string">"emoji"</span>,</span><br><span class="line">    <span class="type">AnyHashable</span>(<span class="number">42</span>): <span class="string">"an Int"</span>,</span><br><span class="line">    <span class="type">AnyHashable</span>(<span class="type">Int8</span>(<span class="number">43</span>)): <span class="string">"an Int8"</span>,</span><br><span class="line">    <span class="type">AnyHashable</span>(<span class="type">Set</span>([<span class="string">"a"</span>, <span class="string">"b"</span>])): <span class="string">"a set of strings"</span></span><br><span class="line">]</span><br><span class="line"><span class="built_in">print</span>(descriptions[<span class="type">AnyHashable</span>(<span class="number">42</span>)]!)      <span class="comment">// prints "an Int"</span></span><br><span class="line"><span class="built_in">print</span>(descriptions[<span class="type">AnyHashable</span>(<span class="number">43</span>)])       <span class="comment">// prints "nil"</span></span><br><span class="line"><span class="built_in">print</span>(descriptions[<span class="type">AnyHashable</span>(<span class="type">Int8</span>(<span class="number">43</span>))]!) <span class="comment">// prints "an Int8"</span></span><br><span class="line"><span class="built_in">print</span>(descriptions[<span class="type">AnyHashable</span>(<span class="type">Set</span>([<span class="string">"a"</span>, <span class="string">"b"</span>]))]!) <span class="comment">// prints "a set of strings"</span></span><br></pre></td></tr></table></figure>

<p>We dont necessarily need to map from <code>[AnyHashable: Any]</code> to <code>[String: Any]</code>, we can just access via string key</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userInfo[<span class="string">"aps"</span>]</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-10T07:57:27.000Z" title="2019-10-10T07:57:27.000Z">2019-10-10</time><span class="level-item">a minute read (About 176 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-register-for-alert-push-notification-in-iOS/">How to  register for alert push notification in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/452">#452</a></strong></p>
<p>Use <code>UserNotifications</code> framework</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> FirebaseMessaging</span><br><span class="line"><span class="keyword">import</span> UserNotifications</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">PushHandler</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> center = <span class="type">UNUserNotificationCenter</span>.current()</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">let</span> options: <span class="type">UNAuthorizationOptions</span> = [.alert]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="type">Messaging</span>.messaging().delegate = <span class="keyword">self</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">register</span><span class="params">()</span></span> &#123;</span><br><span class="line">        center.requestAuthorization(options: options, completionHandler: &#123; granted, error <span class="keyword">in</span></span><br><span class="line">            <span class="built_in">print</span>(granted, error)</span><br><span class="line">            <span class="keyword">self</span>.getSettings()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getSettings</span><span class="params">()</span></span> &#123;</span><br><span class="line">        center.getNotificationSettings(completionHandler: &#123; settings <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">guard</span></span><br><span class="line">                <span class="keyword">case</span> <span class="keyword">let</span> .authorized = settings.authorizationStatus,</span><br><span class="line">                <span class="keyword">case</span> <span class="keyword">let</span> .enabled = settings.alertSetting,</span><br><span class="line">                settings.alertStyle != .<span class="keyword">none</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// TODO</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">handle</span><span class="params">(userInfo: [AnyHashable: <span class="keyword">Any</span>])</span></span> &#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">PushHandler</span>: <span class="title">MessagingDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">messaging</span><span class="params">(<span class="number">_</span> messaging: Messaging, didReceiveRegistrationToken fcmToken: String)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(fcmToken)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">messaging</span><span class="params">(<span class="number">_</span> messaging: Messaging, didReceive remoteMessage: MessagingRemoteMessage)</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(remoteMessage)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@UIApplicationMain</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppDelegate</span>: <span class="title">UIResponder</span>, <span class="title">UIApplicationDelegate</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">application</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="number">_</span> application: UIApplication,</span></span></span><br><span class="line"><span class="function"><span class="params">        didReceiveRemoteNotification userInfo: [AnyHashable: <span class="keyword">Any</span>],</span></span></span><br><span class="line"><span class="function"><span class="params">        fetchCompletionHandler completionHandler: @escaping <span class="params">(UIBackgroundFetchResult)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        completionHandler(.noData)</span><br><span class="line"></span><br><span class="line">        <span class="type">Deps</span>.pushHandler.handle(userInfo: userInfo)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>A test message from Firebase looks like</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[AnyHashable(&quot;google.c.a.e&quot;): 1, AnyHashable(&quot;google.c.a.ts&quot;): 1570701857, AnyHashable(&quot;aps&quot;): &#123;</span><br><span class="line">    alert &#x3D;     &#123;</span><br><span class="line">        body &#x3D; Test;</span><br><span class="line">        title &#x3D; Test;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;, AnyHashable(&quot;google.c.a.udt&quot;): 0, AnyHashable(&quot;google.c.a.c_l&quot;): Test, AnyHashable(&quot;gcm.message_id&quot;): 1570701857965182, AnyHashable(&quot;google.c.a.c_id&quot;): 1257698497812622975, AnyHashable(&quot;gcm.n.e&quot;): 1]</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-09T12:41:25.000Z" title="2019-10-09T12:41:25.000Z">2019-10-09</time><span class="level-item">a minute read (About 218 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-flat-map-publisher-of-publishers-in-Combine/">How to flat map publisher of publishers in Combine</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/451">#451</a></strong></p>
<p>For some services, we need to deal with separated APIs for getting ids and getting detail based on id. </p>
<p>To chain requests, we can use <code>flatMap</code> and <code>Sequence</code>, then <code>collect</code> to wait and get all elements in a single publish</p>
<p><a href="https://developer.apple.com/documentation/combine/publishers/flatmap">FlatMap</a></p>
<blockquote>
<p>Transforms all elements from an upstream publisher into a new or existing publisher.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FlatMap</span>&lt;<span class="title">NewPublisher</span>, <span class="title">Upstream</span>&gt; <span class="title">where</span> <span class="title">NewPublisher</span> : <span class="title">Publisher</span>, <span class="title">Upstream</span> : <span class="title">Publisher</span>, <span class="title">NewPublisher</span>.<span class="title">Failure</span> == <span class="title">Upstream</span>.<span class="title">Failure</span></span></span><br></pre></td></tr></table></figure>

<p><a href="https://developer.apple.com/documentation/combine/publishers/sequence">Publishers.Sequence</a></p>
<blockquote>
<p>A publisher that publishes a given sequence of elements.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Sequence</span>&lt;<span class="title">Elements</span>, <span class="title">Failure</span>&gt; <span class="title">where</span> <span class="title">Elements</span> : <span class="title">Sequence</span>, <span class="title">Failure</span> : <span class="title">Error</span></span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fetchItems</span><span class="params">(completion: @escaping <span class="params">([ItemProtocol])</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">    requestCancellable = <span class="type">URLSession</span>.shared</span><br><span class="line">        .dataTaskPublisher(<span class="keyword">for</span>: topStoriesUrl())</span><br><span class="line">        .<span class="built_in">map</span>(&#123; $<span class="number">0</span>.data &#125;)</span><br><span class="line">        .decode(type: [<span class="type">Int</span>].<span class="keyword">self</span>, decoder: <span class="type">JSONDecoder</span>())</span><br><span class="line">        .flatMap(&#123; (ids: [<span class="type">Int</span>]) -&gt; <span class="type">AnyPublisher</span>&lt;[<span class="type">HackerNews</span>.<span class="type">Item</span>], <span class="type">Error</span>&gt; <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> publishers = ids.<span class="keyword">prefix</span>(<span class="number">10</span>).<span class="built_in">map</span>(&#123; id <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">return</span> <span class="type">URLSession</span>.shared</span><br><span class="line">                    .dataTaskPublisher(<span class="keyword">for</span>: <span class="keyword">self</span>.storyUrl(id: id))</span><br><span class="line">                    .<span class="built_in">map</span>(&#123; $<span class="number">0</span>.data &#125;)</span><br><span class="line">                    .decode(type: <span class="type">HackerNews</span>.<span class="type">Item</span>.<span class="keyword">self</span>, decoder: <span class="type">JSONDecoder</span>())</span><br><span class="line">                    .eraseToAnyPublisher()</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="type">Publishers</span>.<span class="type">Sequence</span>&lt;[<span class="type">AnyPublisher</span>&lt;<span class="type">HackerNews</span>.<span class="type">Item</span>, <span class="type">Error</span>&gt;], <span class="type">Error</span>&gt;(sequence: publishers)</span><br><span class="line">                <span class="comment">// Publishers.Sequence&lt;[AnyPublisher&lt;HackerNews.Item, Error&gt;], Error&gt;</span></span><br><span class="line">                .flatMap(&#123; $<span class="number">0</span> &#125;)</span><br><span class="line">                <span class="comment">// Publishers.FlatMap&lt;AnyPublisher&lt;HackerNews.Item, Error&gt;, Publishers.Sequence&lt;[AnyPublisher&lt;HackerNews.Item, Error&gt;], Error&gt;&gt;</span></span><br><span class="line">                .collect()</span><br><span class="line">                <span class="comment">// Publishers.Collect&lt;Publishers.FlatMap&lt;AnyPublisher&lt;HackerNews.Item, Error&gt;, Publishers.Sequence&lt;[AnyPublisher&lt;HackerNews.Item, Error&gt;], Error&gt;&gt;&gt;</span></span><br><span class="line">                .eraseToAnyPublisher()</span><br><span class="line">                <span class="comment">// AnyPublisher&lt;[HackerNews.Item], Error&gt;</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .receive(on: <span class="type">RunLoop</span>.main)</span><br><span class="line">        .eraseToAnyPublisher()</span><br><span class="line">        .sink(receiveCompletion: &#123; completionStatus <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">switch</span> completionStatus &#123;</span><br><span class="line">            <span class="keyword">case</span> .finished:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</span><br><span class="line">                <span class="built_in">print</span>(error)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, receiveValue: &#123; items <span class="keyword">in</span></span><br><span class="line">            completion(items)</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-09T06:28:41.000Z" title="2019-10-09T06:28:41.000Z">2019-10-09</time><span class="level-item">a minute read (About 217 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-container-view-in-SwiftUI/">How to make container view in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/450">#450</a></strong></p>
<p>Following the signatures of <code>ScrollView</code> and <code>Group</code>, we can create our own container</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">ScrollView</span>&lt;<span class="title">Content</span>&gt; : <span class="title">View</span> <span class="title">where</span> <span class="title">Content</span> : <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// The content of the scroll view.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> content: <span class="type">Content</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Group</span> : <span class="title">View</span> <span class="title">where</span> <span class="title">Content</span> : <span class="title">View</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// The type of view representing the body of this view.</span></span><br><span class="line">    <span class="comment">///</span></span><br><span class="line">    <span class="comment">/// When you create a custom view, Swift infers this type from your</span></span><br><span class="line">    <span class="comment">/// implementation of the required `body` property.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">typealias</span> <span class="type">Body</span> = <span class="type">Never</span></span><br><span class="line"></span><br><span class="line">    @inlinable <span class="keyword">public</span> <span class="keyword">init</span>(@<span class="type">ViewBuilder</span> content: () -&gt; <span class="type">Content</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For example, below is a <code>FullWidth</code> that encapsulate a child element and make it full width</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FullWidth</span>&lt;<span class="title">Content</span>&gt;: <span class="title">View</span> <span class="title">where</span> <span class="title">Content</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> content: <span class="type">Content</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.content</span><br><span class="line">                .frame(width: geometry.size.width, height: geometry.size.width, alignment: .center)</span><br><span class="line">                .padding(.bottom, geometry.size.width)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @inlinable <span class="keyword">public</span> <span class="keyword">init</span>(@<span class="type">ViewBuilder</span> content: () -&gt; <span class="type">Content</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.content = content()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FullWidth_Previews</span>: <span class="title">PreviewProvider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">FullWidth</span> &#123;</span><br><span class="line">            <span class="type">Text</span>(<span class="string">""</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>One problem with <code>GeometryReader</code> is that the size of the children cant affect the size of its container. We need  to apply Geometry at the root level</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">        <span class="type">ScrollView</span> &#123;</span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading, spacing: <span class="number">8</span>) &#123;</span><br><span class="line">                <span class="type">Text</span>(<span class="string">"title"</span>)</span><br><span class="line">                <span class="type">RemoteImage</span>(url: <span class="keyword">self</span>.item.url)</span><br><span class="line">                    .frame(width: geometry.size.width, height: geometry.size.height, alignment: .center)</span><br><span class="line">                <span class="type">Text</span>(<span class="string">"footer"</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-08T11:41:16.000Z" title="2019-10-08T11:41:16.000Z">2019-10-08</time><span class="level-item">a few seconds read (About 102 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-web-content-as-QR-code-in-SwiftUI-in-watchOS/">How to show web content as QR code in SwiftUI in watchOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/449">#449</a></strong></p>
<p><code>WatchKit</code> does not have Web component, despite the fact that we can view web content</p>
<ul>
<li><a href="https://www.imore.com/how-view-web-pages-apple-watch-watchos-5">https://www.imore.com/how-view-web-pages-apple-watch-watchos-5</a></li>
</ul>
<p>A workaround is to show url as QR code</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">QRCodeView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> title: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> url: <span class="type">URL</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">GeometryReader</span> &#123; geometry <span class="keyword">in</span></span><br><span class="line">            <span class="type">VStack</span> &#123;</span><br><span class="line">                <span class="keyword">self</span>.makeImage(size: geometry.size)</span><br><span class="line">                    .padding(.top, <span class="number">10</span>)</span><br><span class="line">                <span class="type">Text</span>(<span class="string">"Scan to open"</span>)</span><br><span class="line">                    .font(.system(.footnote))</span><br><span class="line">            &#125;.navigationBarTitle(<span class="keyword">self</span>.title)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">makeImage</span><span class="params">(size: CGSize)</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> value = size.height - <span class="number">30</span></span><br><span class="line">        <span class="keyword">return</span> <span class="type">RemoteImage</span>(url: <span class="keyword">self</span>.url)</span><br><span class="line">            .frame(width: value, height: value, alignment: .center)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-08T11:37:48.000Z" title="2019-10-08T11:37:48.000Z">2019-10-08</time><span class="level-item">a minute read (About 194 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-load-remote-image-in-SwiftUI/">How to load remote image in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/448">#448</a></strong></p>
<p>Use <code>ObservableObject</code> and <code>onReceive</code> to receive event. <code>URLSession.dataTask</code> reports in background queue, so need to <code>.receive(on: RunLoop.main)</code> to receive events on main queue.</p>
<p>For better dependency injection, need to use <code>ImageLoader</code> from <a href="https://developer.apple.com/documentation/swiftui/environment">Environment</a></p>
<p>There should be a way to propagate event from <code>Publisher</code> to another <code>Publisher</code>, for now we use <code>sink</code></p>
<p><code>ImageLoader.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Combine</span><br><span class="line"><span class="keyword">import</span> WatchKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ImageLoader</span>: <span class="title">ObservableObject</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> cancellable: <span class="type">AnyCancellable?</span></span><br><span class="line">    <span class="keyword">let</span> objectWillChange = <span class="type">PassthroughSubject</span>&lt;<span class="type">UIImage?</span>, <span class="type">Never</span>&gt;()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">load</span><span class="params">(url: URL)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.cancellable = <span class="type">URLSession</span>.shared</span><br><span class="line">            .dataTaskPublisher(<span class="keyword">for</span>: url)</span><br><span class="line">            .<span class="built_in">map</span>(&#123; $<span class="number">0</span>.data &#125;)</span><br><span class="line">            .eraseToAnyPublisher()</span><br><span class="line">            .receive(on: <span class="type">RunLoop</span>.main)</span><br><span class="line">            .<span class="built_in">map</span>(&#123; <span class="type">UIImage</span>(data: $<span class="number">0</span>) &#125;)</span><br><span class="line">            .replaceError(with: <span class="literal">nil</span>)</span><br><span class="line">            .sink(receiveValue: &#123; image <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">self</span>.objectWillChange.send(image)</span><br><span class="line">            &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cancel</span><span class="params">()</span></span> &#123;</span><br><span class="line">        cancellable?.cancel()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>RemoteImage.swift</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> WatchKit</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">RemoteImage</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> url: <span class="type">URL</span></span><br><span class="line">    <span class="keyword">let</span> imageLoader = <span class="type">ImageLoader</span>()</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> image: <span class="type">UIImage?</span> = <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Group</span> &#123;</span><br><span class="line">            makeContent()</span><br><span class="line">        &#125;</span><br><span class="line">        .onReceive(imageLoader.objectWillChange, perform: &#123; image <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">self</span>.image = image</span><br><span class="line">        &#125;)</span><br><span class="line">        .onAppear(perform: &#123;</span><br><span class="line">            <span class="keyword">self</span>.imageLoader.load(url: <span class="keyword">self</span>.url)</span><br><span class="line">        &#125;)</span><br><span class="line">        .onDisappear(perform: &#123;</span><br><span class="line">            <span class="keyword">self</span>.imageLoader.cancel()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">makeContent</span><span class="params">()</span></span> -&gt; some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> image = image &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">AnyView</span>(</span><br><span class="line">                <span class="type">Image</span>(uiImage: image)</span><br><span class="line">                    .resizable()</span><br><span class="line">                    .aspectRatio(contentMode: .fit)</span><br><span class="line">            )</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Text</span>(<span class="string">""</span>))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-08T11:35:51.000Z" title="2019-10-08T11:35:51.000Z">2019-10-08</time><span class="level-item">a minute read (About 136 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-do-navigation-in-SwiftUI-in-watchOS/">How to do navigation in SwiftUI in watchOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/447">#447</a></strong></p>
<p><a href="https://developer.apple.com/documentation/swiftui/navigationview">NavigationView</a> is not available on <code>WatchKit</code>, but we can just use <code>NavigationLink</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span>(services.<span class="built_in">map</span>(&#123; <span class="type">AnyService</span>($<span class="number">0</span>) &#125;)) &#123; anyService <span class="keyword">in</span></span><br><span class="line">    <span class="type">NavigationLink</span>(destination:</span><br><span class="line">        <span class="type">ItemsView</span>(service: anyService.service)</span><br><span class="line">            .navigationBarTitle(anyService.service.name)</span><br><span class="line">            .onDisappear(perform: &#123;</span><br><span class="line">                anyService.service.requestCancellable?.cancel()</span><br><span class="line">            &#125;)</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="type">HStack</span> &#123;</span><br><span class="line">            <span class="type">Image</span>(anyService.service.name)</span><br><span class="line">                .resizable()</span><br><span class="line">                .frame(width: <span class="number">30</span>, height: <span class="number">30</span>, alignment: .leading)</span><br><span class="line">            <span class="type">Text</span>(anyService.service.name)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Adding <code>NavigationLink</code> to a View adds a round shadow cropping effect, which is usually not want we want. </p>
<p>But we shouldnt wrap <code>Button</code> as <code>Button</code> handles its own touch event, plus it has double shadow effect.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NavigationLink</span>(destination:</span><br><span class="line">    <span class="type">QRCodeView</span>(title: item.title, url: item.url)</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="type">Button</span>(action: &#123;&#125;) &#123;</span><br><span class="line">         <span class="type">Text</span>(<span class="string">"Open"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Just use Text and its good to go</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NavigationLink</span>(destination:</span><br><span class="line">    <span class="type">QRCodeView</span>(title: item.title, url: item.url)</span><br><span class="line">) &#123;</span><br><span class="line">    <span class="type">Text</span>(<span class="string">"Open"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-07T12:08:38.000Z" title="2019-10-07T12:08:38.000Z">2019-10-07</time><span class="level-item">a minute read (About 221 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-protocol-in-List-in-SwiftUI/">How to use protocol in List in SwiftUI</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/446">#446</a></strong></p>
<p>Suppose we have Service protocol, and want to use in List</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">Service</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123; <span class="keyword">get</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> services = [</span><br><span class="line">        <span class="type">Car</span>()</span><br><span class="line">        <span class="type">Plane</span>()</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(services) &#123; service <span class="keyword">in</span></span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Image</span>(service.name)</span><br><span class="line">                <span class="type">Text</span>(service.name)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This is not possible because item in List needs to conform to <code>Identifiable</code></p>
<blockquote>
<p>Protocol type Service cannot conform to Identifiable because only concrete types can conform to protocols</p>
</blockquote>
<h2 id="Type-eraser"><a href="#Type-eraser" class="headerlink" title="Type eraser"></a>Type eraser</h2><p>In the same way that SwiftUI uses type eraser, for example <code>AnyView</code>, we can introduce <code>AnyService</code> to work around this</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> useImage &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Image</span>(<span class="string">"my image"</span>))</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="type">AnyView</span>(<span class="type">Text</span>(<span class="string">"my text"</span>))</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Make AnyService conform to <code>Identifiable</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AnyService</span>: <span class="title">Identifiable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> id: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> service: <span class="type">Service</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(<span class="number">_</span> service: <span class="type">Service</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.service = service</span><br><span class="line">        <span class="keyword">self</span>.id = service.name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then in our View, we just need to declare services wrapped inside AnyService</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> services = [</span><br><span class="line">        <span class="type">AnyService</span>(<span class="type">Car</span>()),</span><br><span class="line">        <span class="type">AnyService</span>(<span class="type">Plane</span>())</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(services) &#123; anyService <span class="keyword">in</span></span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Image</span>(anyService.service.name)</span><br><span class="line">                <span class="type">Text</span>(anyService.service.name)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>A bit refactoring, we can just declare normal services and map them</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MainView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> services: [<span class="type">Service</span>] = [</span><br><span class="line">        <span class="type">Car</span>(),</span><br><span class="line">        <span class="type">Plane</span>()</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">List</span>(services.<span class="built_in">map</span>(&#123; <span class="type">AnyService</span>($<span class="number">0</span> &#125;)) &#123; anyService <span class="keyword">in</span></span><br><span class="line">            <span class="type">HStack</span> &#123;</span><br><span class="line">                <span class="type">Image</span>(anyService.service.name)</span><br><span class="line">                <span class="type">Text</span>(anyService.service.name)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-07T09:01:37.000Z" title="2019-10-07T09:01:37.000Z">2019-10-07</time><span class="level-item">2 minutes read (About 254 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-support-Swift-Package-Manager-for-existing-projects/">How to support Swift Package Manager for existing projects</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/445">#445</a></strong></p>
<h2 id="How-to-add-SPM"><a href="#How-to-add-SPM" class="headerlink" title="How to add SPM"></a>How to add SPM</h2><ul>
<li>Run <code>swift package init</code></li>
<li>Check enum for version for each platform <a href="https://developer.apple.com/documentation/swift_packages/supportedplatform/tvosversion">https://developer.apple.com/documentation/swift_packages/supportedplatform/tvosversion</a></li>
</ul>
<ul>
<li>Example <a href="https://github.com/onmyway133/Anchors/blob/master/Package.swift">https://github.com/onmyway133/Anchors/blob/master/Package.swift</a></li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// swift-tools-version:5.1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> PackageDescription</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> package = <span class="type">Package</span>(</span><br><span class="line">    name: <span class="string">"Anchors"</span>,</span><br><span class="line">    platforms: [</span><br><span class="line">        .macOS(.v10_11),</span><br><span class="line">        .iOS(.v9),</span><br><span class="line">        .tvOS(.v9)</span><br><span class="line">    ],</span><br><span class="line">    products: [</span><br><span class="line">        .library(</span><br><span class="line">            name: <span class="string">"Anchors"</span>,</span><br><span class="line">            targets: [<span class="string">"Anchors"</span>]),</span><br><span class="line">    ],</span><br><span class="line">    targets: [</span><br><span class="line">        .target(</span><br><span class="line">            name: <span class="string">"Anchors"</span>,</span><br><span class="line">            dependencies: [],</span><br><span class="line">            path: <span class="string">"Sources"</span></span><br><span class="line">		),</span><br><span class="line">        .testTarget(</span><br><span class="line">            name: <span class="string">"AnchorsTests"</span>,</span><br><span class="line">            dependencies: [<span class="string">"Anchors"</span>]),</span><br><span class="line">    ],</span><br><span class="line">    swiftLanguageVersions: [.v5]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>To test, <code>swift test</code> to test locally, this should validate <code>Package.swift</code> too</p>
<h2 id="Support-multiple-platform"><a href="#Support-multiple-platform" class="headerlink" title="Support multiple platform"></a>Support multiple platform</h2><p>To support multiple platform, use platform check</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">if</span> canImport(<span class="type">UIKit</span>)</span><br><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure>

<p>Use sources in Target </p>
<ul>
<li><a href="https://developer.apple.com/documentation/swift_packages/target/2880339-sources">https://developer.apple.com/documentation/swift_packages/target/2880339-sources</a></li>
<li><a href="https://github.com/onmyway133/EasyClosure/blob/master/Package.swift">https://github.com/onmyway133/EasyClosure/blob/master/Package.swift</a></li>
</ul>
<blockquote>
<p>If this property is nil, all valid source files in the targets path will be included and specified paths are relative to the target path.</p>
</blockquote>
<blockquote>
<p>A path can be a path to a directory or an individual source file. In case of a directory, the Swift Package Manager searches for valid source files recursively inside it.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.target(</span><br><span class="line">    name: <span class="string">"EasyClosureiOS"</span>,</span><br><span class="line">    dependencies: [],</span><br><span class="line">    path: <span class="string">"Sources"</span>,</span><br><span class="line">    sources: [<span class="string">"Shared"</span>, <span class="string">"iOS"</span>]</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>Error</p>
<blockquote>
<p>error: target EasyClosuremacOS has sources overlapping sources</p>
</blockquote>
<h2 id="How-to-use"><a href="#How-to-use" class="headerlink" title="How to use"></a>How to use</h2><ul>
<li>SPM packages are at <code>DerivedData/MyApp/SourcePackages/checkouts</code></li>
<li>Delete DerivedData for Xcode to fetch new contents from GitHub</li>
<li>Clean build folder as Xcode often caches changes from frameworks</li>
</ul>
<h2 id="Read-more"><a href="#Read-more" class="headerlink" title="Read more"></a>Read more</h2><ul>
<li><a href="https://dive.github.io/swift-package-manager/ios/2019/01/20/swift_package_manager_vs_ios.html">https://dive.github.io/swift-package-manager/ios/2019/01/20/swift_package_manager_vs_ios.html</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-07T05:43:56.000Z" title="2019-10-07T05:43:56.000Z">2019-10-07</time><span class="level-item">a few seconds read (About 91 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-fix-unreadable-ASCII-characters-in-Swift/">How to fix unreadable ASCII characters in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/444">#444</a></strong></p>
<p>To avoid compiler error <code>Unprintable ASCII character found in source file</code>, from Swift 5, we can use <code>isASCII</code>.</p>
<p>Run this from the generator app that generates Swift code.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> normalized = weirdString.<span class="built_in">filter</span>(&#123; $<span class="number">0</span>.isASCII &#125;)</span><br></pre></td></tr></table></figure>

<p>For more check, see Character <a href="https://developer.apple.com/documentation/swift/character/3127011-isletter">https://developer.apple.com/documentation/swift/character/3127011-isletter</a></p>
<p>Watch out for</p>
<ul>
<li>Delete/House symbol  code 127 (0x7f)</li>
</ul>
<p>The above does not seem to work, use find to find <code></code> character (copy Sublime Text to see 0x7f character)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find .&#x2F; -type f -exec sed -i &#39;&#39; -e &#39;s&#x2F;&#x2F;&#x2F;&#39; &#123;&#125; \;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-10-05T18:28:16.000Z" title="2019-10-05T18:28:16.000Z">2019-10-05</time><span class="level-item">a few seconds read (About 41 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-style-NSTextView-and-NSTextField-in-macOS/">How to style NSTextView and NSTextField in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/443">#443</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> textField = <span class="type">NSTextField</span>()</span><br><span class="line">textField.focusRingType = .<span class="keyword">none</span></span><br></pre></td></tr></table></figure>

<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> textView = <span class="type">NSTextView</span>()</span><br><span class="line">textView.insertionPointColor = <span class="type">R</span>.color.caret</span><br><span class="line">textView.isRichText = <span class="literal">false</span></span><br><span class="line">textView.importsGraphics = <span class="literal">false</span></span><br><span class="line">textView.isEditable = <span class="literal">true</span></span><br><span class="line">textView.isSelectable = <span class="literal">true</span></span><br><span class="line">textView.drawsBackground = <span class="literal">false</span></span><br><span class="line">textView.allowsUndo = <span class="literal">true</span></span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/10/">Previous</a></div><div class="pagination-next"><a href="/page/12/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/10/">10</a></li><li><a class="pagination-link is-current" href="/page/11/">11</a></li><li><a class="pagination-link" href="/page/12/">12</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/25/">25</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">723</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">54</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://wwdctogether.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">WWDC Together</span></span><span class="level-right"><span class="level-item tag">wwdctogether.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-17T19:25:20.000Z">2021-02-17</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-make-simple-search-bar-in-SwiftUI/">How to make simple search bar in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-17T18:30:50.000Z">2021-02-17</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-fix-share-and-action-extension-not-showing-up-in-iOS-14/">How to fix share and action extension not showing up in iOS 14</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-10T05:25:27.000Z">2021-02-10</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-add-home-screen-quick-action-in-SwiftUI/">How to add home screen quick action in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-08T18:40:48.000Z">2021-02-08</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-use-EquatableView-in-SwiftUI/">How to use EquatableView in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2021-02-08T18:34:20.000Z">2021-02-08</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-add-new-property-in-Codable-struct-in-SwiftUI/">How to add new property in Codable struct in SwiftUI</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2021/02/"><span class="level-start"><span class="level-item">February 2021</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/01/"><span class="level-start"><span class="level-item">January 2021</span></span><span class="level-end"><span class="level-item tag">33</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">38</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/featured/"><span class="tag">featured</span><span class="tag is-grey-lightest">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">173</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">51</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">133</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">24</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">355</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">98</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tweet/"><span class="tag">tweet</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">24</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2021 Khoa Pham</span>Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>&amp;<a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;"></a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>