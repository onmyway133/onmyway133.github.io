<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.0"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>onmyway133</title><meta description="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:type" content="blog"><meta property="og:title" content="onmyway133"><meta property="og:url" content="https://onmyway133.github.io/"><meta property="og:site_name" content="onmyway133"><meta property="og:description" content="What you don&amp;#39;t know is what you haven&amp;#39;t learned"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onmyway133.github.io/img/og_image.png"><meta property="article:author" content="Khoa Pham"><meta property="article:tag" content="ios"><meta property="article:tag" content=" android"><meta property="article:tag" content="javascript"><meta property="article:tag" content=" react"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><meta property="twitter:creator" content="@onmyway133"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://onmyway133.github.io"},"headline":"onmyway133","image":["https://onmyway133.github.io/img/og_image.png"],"author":{"@type":"Person","name":"Khoa Pham"},"description":"What you don&#39;t know is what you haven&#39;t learned"}</script><link rel="alternative" href="/atom.xml" title="onmyway133" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-40119591-5" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'UA-40119591-5');</script><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><script data-ad-client="ca-pub-3656459401405265" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/apps">Apps</a><a class="navbar-item" href="/gumroad">Gumroad</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/opensource">Open Source</a><a class="navbar-item" href="/writing">Writing</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/speaking">Speaking</a><a class="navbar-item" href="/news">News</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T16:06:58.000Z" title="2019-05-23T16:06:58.000Z">2019-05-23</time><span class="level-item">8 minutes read (About 1219 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Get-to-know-different-JavaScript-environments-in-React-Native/">Get to know different JavaScript environments in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/266">#266</a></strong></p>
<p>Original post <a href="https://medium.freecodecamp.org/get-to-know-different-javascript-environments-in-react-native-4951c15d61f5">https://medium.freecodecamp.org/get-to-know-different-javascript-environments-in-react-native-4951c15d61f5</a></p>
<hr>
<p>React Native can be very easy to <a href="https://facebook.github.io/react-native/docs/getting-started.html">get started</a> with, and then at some point problems occur and we need to dive deep into it.</p>
<p>The other day we had a strange bug that was only occurring in production build, and in iOS only. A long backtrace in the app revealed that it was due to Date constructor failure.</p>
<pre><code>const date = new Date(&quot;2019-01-18 12:00:00&quot;)</code></pre><p>This returns the correct Date object in debug mode, but yields Invalid Date in release. What‚Äôs special about Date constructor? Here I‚Äôm using react native 0.57.5 and no Date libraries.</p>
<h2 id="Date-constructor"><a href="#Date-constructor" class="headerlink" title="Date constructor"></a>Date constructor</h2><p>The best resource for learning Javascript is via Mozilla web docs, and entering <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date">Date</a>:</p>
<blockquote>
<p>Creates a JavaScript <strong>Date</strong> instance that represents a single moment in time. Date objects use a <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap04.html#tag_04_16">Unix Time Stamp</a>, an integer value that is the number of milliseconds since 1 January 1970 UTC.</p>
</blockquote>
<p>Pay attention to how Date can be constructed by dateString:</p>
<blockquote>
<p>dateStringString value representing a date. The string should be in a format recognized by the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse">Date.parse()</a> method (<a href="http://tools.ietf.org/html/rfc2822#page-14">IETF-compliant RFC 2822 timestamps</a> and also a <a href="http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15">version of ISO8601</a>).</p>
</blockquote>
<p>So Date constructor uses static method Date.parse under the hood. This has very specific requirement about the format of date string that it supports</p>
<blockquote>
<p>The standard string representation of a date time string is a simplification of the ISO 8601 calendar date extended format (see <a href="https://tc39.github.io/ecma262/#sec-date-time-string-format">Date Time String Format</a> section in the ECMAScript specification for more details). For example, ‚Äú2011-10-10‚Äù (date-only form), ‚Äú2011-10-10T14:48:00‚Äù (date-time form), or ‚Äú2011-10-10T14:48:00.000+09:00‚Äù (date-time form with milliseconds and time zone) can be passed and will be parsed. When the time zone offset is absent, date-only forms are interpreted as a UTC time and date-time forms are interpreted as local time.<br>The ECMAScript specification states: If the String does not conform to the standard format the function may fall back to any implementation‚Äìspecific heuristics or implementation‚Äìspecific parsing algorithm. Unrecognizable strings or dates containing illegal element values in ISO formatted strings shall cause Date.parse() to return <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN">NaN</a>.</p>
</blockquote>
<p>The reason that we get Invalid Date in iOS must be because the code was run in two different JavaScript environments and they somehow have different implementation of the Date parsing function.</p>
<h2 id="JavaScript-Environment"><a href="#JavaScript-Environment" class="headerlink" title="JavaScript Environment"></a>JavaScript Environment</h2><p>React Native guide has a dedicated section about <a href="https://facebook.github.io/react-native/docs/javascript-environment">JavaScript environments</a>.</p>
<p>When using React Native, you‚Äôre going to be running your JavaScript code in two environments:</p>
<ul>
<li><p>In most cases, React Native will use <a href="http://trac.webkit.org/wiki/JavaScriptCore">JavaScriptCore</a>, the JavaScript engine that powers Safari. Note that on iOS, JavaScriptCore does not use JIT due to the absence of writable executable memory in iOS apps.</p>
</li>
<li><p>When using Chrome debugging, all JavaScript code runs within Chrome itself, communicating with native code via WebSockets. Chrome uses <a href="https://code.google.com/p/v8/">V8</a> as its JavaScript engine.</p>
</li>
</ul>
<p>While both environments are very similar, you may end up hitting some inconsistencies. We‚Äôre likely going to experiment with other JavaScript engines in the future, so it‚Äôs best to avoid relying on specifics of any runtime.</p>
<p>React Native also uses Babel and some polyfills to have some nice syntax transformers, so some of the code that we write may not be necessarily supported natively by JavascriptCore.</p>
<p>Now it is clear that while we debug our app via Chrome debugger, it works because V8 engine handles that. Now try turning off Remote JS Debugging: we can see that the above Date constructor fails, which means it is using JavascriptCore.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*zICMkdSSmUkcPTDNnkCA7Q.png" alt=""></p>
<p>To confirm this issue, let‚Äôs run our app in Xcode and go to the Safari app on MacOS to enter Development menu. Select the active Simulator and choose JSContext on the current iOS app. Remember to turn off Remote JS Debugging so that the app uses JavascriptCore:</p>
<p><img src="https://cdn-images-1.medium.com/max/6720/1*TPzyCz-z45fbzYSaJ3dQGA.png" alt=""></p>
<p>Now open the Console in Safari dev tools, and we should have access to JavascriptCore inside our app. Try running the above Date constructor to confirm that it fails:</p>
<p><img src="https://cdn-images-1.medium.com/max/4448/1*gqswNAR8vpqHrzBiZKeqcg.png" alt=""></p>
<h2 id="What-are-legit-date-string-formats"><a href="#What-are-legit-date-string-formats" class="headerlink" title="What are legit date string formats?"></a>What are legit date string formats?</h2><p>Since 2016, <a href="https://webkit.org/blog/6756/es6-feature-complete/">JavascriptCore</a> supports most ES6 features:</p>
<blockquote>
<p>As of <a href="https://trac.webkit.org/changeset/202125">r202125</a>, JavaScriptCore supports all of the new features in the <a href="https://tc39.github.io/ecma262/#sec-integerindexedelementget">ECMAScript 6 (ES6) language specification</a></p>
</blockquote>
<p>And it was fully confirmed a year later in <a href="https://webkit.org/blog/7536/jsc-loves-es6/">JSC üíï ES6</a></p>
<blockquote>
<p><a href="http://www.ecma-international.org/ecma-262/6.0/">ES2015</a> (also known as ES6), the version of the JavaScript specification ratified in 2015, is a huge improvement to the language‚Äôs expressive power thanks to features like <a href="http://www.2ality.com/2015/02/es6-classes-final.html">classes</a>, <a href="https://hacks.mozilla.org/2015/04/es6-in-depth-iterators-and-the-for-of-loop/">for-of</a>, <a href="http://www.2ality.com/2015/01/es6-destructuring.html">destructuring</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator">spread</a>, <a href="http://www.2ality.com/2015/06/tail-call-optimization.html">tail calls</a>, and <a href="http://kangax.github.io/compat-table/es6/">much more</a><br>WebKit‚Äôs JavaScript implementation, called JSC (JavaScriptCore), <a href="https://webkit.org/blog/6756/es6-feature-complete/">implements all of ES6</a></p>
</blockquote>
<p>For more details about JavaScript features supported by different JavaScript engines, visit this <a href="https://kangax.github.io/compat-table/es6/">ECMAScript comparison table</a>.</p>
<p>Now for the date string format, from <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse">Date.parse</a>, let‚Äôs visit ECMAScript 2015 specification to see what it says about <a href="https://www.ecma-international.org/ecma-262/6.0/#sec-date-time-string-format">date string format</a>:</p>
<p><img src="https://cdn-images-1.medium.com/max/4444/1*A8iKd3HZyq9ZmaH0ilm-AA.png" alt=""></p>
<p>ECMAScript defines a string interchange format for date-times based upon a simplification of the ISO 8601 Extended Format. The format is as follows: <strong>YYYY-MM-DDTHH:mm:ss.sss<em>Z</em></strong></p>
<p>Where the fields are as follows:</p>
<p><strong>‚ÄúT‚Äù</strong> appears literally in the string, to indicate the beginning of the time element.</p>
<p>So JavascriptCore requires T specifier and V8 can work without it. The fix for now is to always include that T specifier. This way we always follow ECMAScript standards to make sure it works across different JavaScript environments.</p>
<pre><code>const date = new Date(&quot;2019-01-18 12:00:00&quot;.replace(&apos; &apos;, &apos;T&apos;))</code></pre><p>And now it returns correct Date object. There may be difference between JavascriptCore on iOS and macOS, and among different iOS versions. The lesson learned here is that we should always test our app thoroughly in production and on devices to make sure it works as expected.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T15:57:46.000Z" title="2019-05-23T15:57:46.000Z">2019-05-23</time><span class="level-item">18 minutes read (About 2656 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-Make-Linear-Gradient-View-with-Bridging-in-React-Native/">How to Make Linear Gradient View with Bridging in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/264">#264</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7">https://medium.com/react-native-training/react-native-bridging-how-to-make-linear-gradient-view-83c3805373b7</a></p>
<hr>
<p>React Native lets us build mobile apps using only Javascript. It works by providing a common interface that talks to native iOS and Android components. There are enough essentials components to get started, but the cooler thing is that it is easy to build our own, hence we are not limited by React Native. In this post we will implement a linear gradient view, which is not supported by default in React Native, using native UI component, particularly CAGradientLayer in iOS and GradientDrawable in Android.</p>
<p>In Javascript there are hundreds of libraries for a single problem and you should check if you really need it or not. A search on Google for linear gradient shows a bunch of libraries, like <a href="https://github.com/react-native-community/react-native-linear-gradient">react-native-linear-gradient</a>. The less <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3">dependencies</a> the better. Linear gradient is in fact very easy to build and we probably don‚Äôt need to add extra dependencies. Also <a href="https://dev.to/acro5piano/struggle-to-install-react-native-linear-gradient--2omm">integrating</a> <a href="https://medium.com/react-native-training/fixing-react-native-issues-and-happy-deploy-to-bitrise-fabric-circleci-44da4ab1487b">and</a> <a href="https://medium.com/react-native-training/firebase-sdk-with-firestore-for-react-native-apps-in-2018-aa89a67d6934">following</a> <a href="https://medium.com/react-native-training/facebook-sdk-with-login-for-react-native-apps-in-2018-196601804f66">updates</a> with 3rd libraries are painful, I would avoid that as much as possible.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*SZnOwVTr15PY7uHYqaeaXw.png" alt=""></p>
<h2 id="Native-UI-component-vs-Native-module"><a href="#Native-UI-component-vs-Native-module" class="headerlink" title="Native UI component vs Native module"></a>Native UI component vs Native module</h2><p>In React Native, there are native UI component and native module. React Native moves pretty fast so most of the articles will be outdated, it‚Äôs best to consult official documentation for the latest React Native version. This post will try to give you overview of the whole picture because for now the official guide seems not completed.</p>
<ul>
<li><p><a href="https://facebook.github.io/react-native/docs/native-modules-ios">Native Modules in iOS</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-modules-android">Native Modules in Android</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-components-ios">Native UI Components in iOS</a></p>
</li>
<li><p><a href="https://facebook.github.io/react-native/docs/native-components-android">Native UI Components in Android</a></p>
</li>
</ul>
<p>In simple explanation, native UI component is about making UIView in iOS or View in Android available as React.Component and used in render function in Javascript.</p>
<blockquote>
<p>There are tons of native UI widgets out there ready to be used in the latest apps ‚Äî some of them are part of the platform, others are available as third-party libraries, and still more might be in use in your very own portfolio. React Native has several of the most critical platform components already wrapped, like ScrollView and TextInput, but not all of them, and certainly not ones you might have written yourself for a previous app.</p>
</blockquote>
<p>Native module is more general in that we make any native class available in Javascript.</p>
<blockquote>
<p>Sometimes an app needs access to platform API, and React Native doesn‚Äôt have a corresponding module yet. Maybe you want to reuse some existing Objective-C, Swift or C++ code without having to reimplement it in JavaScript, or write some high performance, multi-threaded code such as for image processing, a database, or any number of advanced extensions.</p>
</blockquote>
<h2 id="View-Manager"><a href="#View-Manager" class="headerlink" title="View Manager"></a>View Manager</h2><p>To expose native UI views, we use the ViewManager as the bridge, it is RCTViewManager in iOS and SimpleViewManager in Android. Then inside this ViewManager we can just return our custom view. I see it‚Äôs good to use Objective C/Java for the ViewManager to match React Native classes, and the custom view we can use either Swift/Objective C in iOS and Kotlin/Java in Android.</p>
<p>I prefer to use Swift, but in this post to remove the overhead of introducing bridging header from Swift to Objective C, we use Objective C for simplicity. We also add the native source code directly into iOS and Android project, but in the future we can extract them easily to a React Native library.</p>
<p>For now let ‚Äòs use the name RNGradientViewManager and RNGradientView to stay consistent between iOS and Android. The RN prefix is arbitrary, you can use any prefix you want, but here I use it to indicate that these classes are meant to be used in Javascript side in React Native.</p>
<h2 id="Implement-in-iOS"><a href="#Implement-in-iOS" class="headerlink" title="Implement in iOS"></a>Implement in iOS</h2><h3 id="Project-structure"><a href="#Project-structure" class="headerlink" title="Project structure"></a>Project structure</h3><p>Add these Objective-C classes to the projects, I usually place them inside NativeComponents folder</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*v9ecOYKhfHenOfFD_YyXjA.png" alt=""></p>
<blockquote>
<p>Native views are created and manipulated by subclasses of RCTViewManager. These subclasses are similar in function to view controllers, but are essentially singletons - only one instance of each is created by the bridge. They expose native views to the RCTUIManager, which delegates back to them to set and update the properties of the views as necessary. The RCTViewManagers are also typically the delegates for the views, sending events back to JavaScript via the bridge.</p>
</blockquote>
<h3 id="RNGradientViewManager"><a href="#RNGradientViewManager" class="headerlink" title="RNGradientViewManager"></a>RNGradientViewManager</h3><p>Create a RNGradientViewManager that inherits from RCTViewManager</p>
<p><strong>RNGradientViewManager.h</strong></p>
<pre><code>#import &lt;React/RCTViewManager.h&gt;
@interface RNGradientViewManager : RCTViewManager
@end</code></pre><p><strong>RNGradientViewManager.m</strong></p>
<pre><code>#import &quot;RNGradientViewManager.h&quot;
#import &quot;RNGradientView.h&quot;

[@implementation](http://twitter.com/implementation) RNGradientViewManager

RCT_EXPORT_MODULE()

- (UIView *)view {
  return [[RNGradientView alloc] init];
}

RCT_EXPORT_VIEW_PROPERTY(progress, NSNumber);
RCT_EXPORT_VIEW_PROPERTY(cornerRadius, NSNumber);
RCT_EXPORT_VIEW_PROPERTY(fromColor, UIColor);
RCT_EXPORT_VIEW_PROPERTY(toColor, UIColor);

[@end](http://twitter.com/end)</code></pre><p>In iOS we use macro RCT_EXPORT_MODULE() to automatically register the module with the bridge when it loads. The optional js_name argument will be used as the JS module name. If omitted, the JS module name will match the Objective-C class name.</p>
<pre><code>#define RCT_EXPORT_MODULE(js_name)</code></pre><p>The ViewManager, not the View, is the facade to the Javascript side, so we expose properties using RCT_EXPORT_VIEW_PROPERTY . Note that we do that inside @implementation RNGradientViewManager</p>
<p>Here we specify the types as NSNumber and UIColor , and later in Javascript we can just pass number and color hex string, and React Native can do the conversions for us. In older versions of React Native, we need processColor in Javascript or RCTConvert color in iOS side, but we don‚Äôt need to perform manual conversion now.</p>
<h3 id="RNGradientView"><a href="#RNGradientView" class="headerlink" title="RNGradientView"></a>RNGradientView</h3><p>In the Native UI component <a href="https://facebook.github.io/react-native/docs/native-components-ios">example</a> for iOS, they use WKWebView but here we make a RNGradientView which subclasses from <a href="https://github.com/facebook/react-native/blob/master/React/Views/RCTView.h">RCTView</a> to take advantage of many features of React Native views, and to avoid some problems we can get if using a normal UIView</p>
<p><strong>RNGradientView.h</strong></p>
<pre><code>#import &lt;UIKit/UIKit.h&gt;
#import &lt;React/RCTView.h&gt;

[@interface](http://twitter.com/interface) RNGradientView : RCTView

[@end](http://twitter.com/end)</code></pre><p><strong>RNGradientView.m</strong></p>
<pre><code>#import &quot;RNGradientView.h&quot;
#import &lt;UIKit/UIKit.h&gt;

[@interface](http://twitter.com/interface) RNGradientView()
[@property](http://twitter.com/property) CAGradientLayer *gradientLayer;

[@property](http://twitter.com/property) UIColor *_fromColor;
[@property](http://twitter.com/property) UIColor *_toColor;
[@property](http://twitter.com/property) NSNumber *_progress;
[@property](http://twitter.com/property) NSNumber *_cornerRadius;
[@end](http://twitter.com/end)

[@implementation](http://twitter.com/implementation) RNGradientView

// MARK: - Init

- (instancetype)initWithFrame:(CGRect)frame
{
  self = [super initWithFrame:frame];
  if (self) {
    self.gradientLayer = [self makeGradientLayer];
    [self.layer addSublayer:self.gradientLayer];

self._fromColor = [UIColor blackColor];
    self._toColor = [UIColor whiteColor];
    self._progress = [@0](http://twitter.com/0).5;

[self update];
  }
  return self;
}

// MARK: - Life cycle

- (void)layoutSubviews {
  [super layoutSubviews];

self.gradientLayer.frame = CGRectMake(
    0, 0,
    self.bounds.size.width*self._progress.floatValue,
    self.bounds.size.height
  );
}

// MARK: - Properties

- (void)setFromColor:(UIColor *)color {
  self._fromColor = color;
  [self update];
}

- (void)setToColor:(UIColor *)color {
  self._toColor = color;
  [self update];
}

- (void)setProgress:(NSNumber *)progress {
  self._progress = progress;
  [self update];
}

- (void)setCornerRadius:(NSNumber *)cornerRadius {
  self._cornerRadius = cornerRadius;
  [self update];
}

// MARK: - Helper

- (void)update {
  self.gradientLayer.colors = @[
    (id)self._fromColor.CGColor,
    (id)self._toColor.CGColor
  ];

self.gradientLayer.cornerRadius = self._cornerRadius.floatValue;

[self setNeedsLayout];
}

- (CAGradientLayer *)makeGradientLayer {
  CAGradientLayer *gradientLayer = [CAGradientLayer layer];

gradientLayer.masksToBounds = true;

gradientLayer.startPoint = CGPointMake(0.0, 0.5);
  gradientLayer.endPoint = CGPointMake(1.0, 0.5);
  gradientLayer.anchorPoint = CGPointZero;

return gradientLayer;
}

[@end](http://twitter.com/end)</code></pre><p>We can implement anything we want in this native view, in this case we use CAGradientLayer to get nicely displayed linear gradient. Since RNGradientViewManager exposes some properties like progress, cornerRadius, fromColor, toColor we need to implement some setters as they will be called by React Native when we update values in Javascript side. In the setter we call setNeedsLayout to tell the view to invalidate the layout, hence layoutSubviews will be called again.</p>
<h3 id="requireNativeComponent"><a href="#requireNativeComponent" class="headerlink" title="requireNativeComponent"></a>requireNativeComponent</h3><p>Open project in Visual Studio Code, add GradientView.js to src/nativeComponents . The folder name is arbitrary, but it‚Äôs good to stay organised.</p>
<pre><code>import { requireNativeComponent } from &apos;react-native&apos;

module.exports = requireNativeComponent(&apos;RNGradientView&apos;, null)</code></pre><p>Here we use <a href="https://github.com/facebook/react-native/blob/master/Libraries/ReactNative/requireNativeComponent.js">requireNativeComponent</a> to load our RNGradientView . We only need this one Javascript file for interacting with both iOS and Android. You can name the module as RNGradientView but I think the practice in Javascript is that we don‚Äôt use prefix, so we name just GradientView .</p>
<pre><code>const requireNativeComponent = (uiViewClassName: string): string =&gt;
  createReactNativeComponentClass(uiViewClassName, () =&gt;
    getNativeComponentAttributes(uiViewClassName),
  );

module.exports = requireNativeComponent;</code></pre><p>Before I tried to use export default for the native component, but this way the view is not rendered at all, even if I wrap it inside React.Component . It seems we must use module.exports for the native component to be properly loaded.</p>
<p>Now using it is as easy as declare the GradientView with JSX syntax</p>
<pre><code>import GradientView from &apos;nativeComponents/GradientView&apos;

export default class Profile extends React.Component {
  render() {
    return (
      &lt;SafeAreaView style={styles.container}&gt;
        &lt;GradientView
          style={styles.progress}
          fromColor={R.colors.progress.from}
          toColor={R.colors.progress.to}
          cornerRadius={5.0}
          progress={0.8} /&gt;
    )
  }
}</code></pre><h2 id="Implement-in-Android"><a href="#Implement-in-Android" class="headerlink" title="Implement in Android"></a>Implement in Android</h2><h3 id="Project-structure-1"><a href="#Project-structure-1" class="headerlink" title="Project structure"></a>Project structure</h3><p>Add these Java classes to the projects, I usually place them inside nativeComponents folder</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*7v9qtfOAGPF2lqvWrrOysg.png" alt=""></p>
<h3 id="RNGradientManager"><a href="#RNGradientManager" class="headerlink" title="RNGradientManager"></a>RNGradientManager</h3><p>Create a RNGradientManager that extends SimpleViewManager<br><strong>RNGradientManager.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import android.support.annotation.Nullable;
import com.facebook.react.uimanager.SimpleViewManager;
import com.facebook.react.uimanager.ThemedReactContext;
import com.facebook.react.uimanager.annotations.ReactProp;

public class RNGradientViewManager extends SimpleViewManager&lt;RNGradientView&gt; {
    [@Override](http://twitter.com/Override)
    public String getName() {
        return &quot;RNGradientView&quot;;
    }

[@Override](http://twitter.com/Override)
    protected RNGradientView createViewInstance(ThemedReactContext reactContext) {
        return new RNGradientView(reactContext);
    }

// Properties

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;progress&quot;)
    public void setProgress(RNGradientView view, [@Nullable](http://twitter.com/Nullable) float progress) {
        view.setProgress(progress);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;cornerRadius&quot;)
    public void setCornerRadius(RNGradientView view, [@Nullable](http://twitter.com/Nullable) float cornerRadius) {
        view.setCornerRadius(cornerRadius);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;fromColor&quot;, customType = &quot;Color&quot;)
    public void setFromColor(RNGradientView view, [@Nullable](http://twitter.com/Nullable) int color) {
        view.setFromColor(color);
    }

[@ReactProp](http://twitter.com/ReactProp)(name = &quot;toColor&quot;, customType = &quot;Color&quot;)
    public void setToColor(RNGradientView view, [@Nullable](http://twitter.com/Nullable) int color) {
        view.setToColor(color);
    }
}</code></pre><p>We usually use <a href="https://developer.android.com/reference/android/graphics/Color">Color</a> as android.graphics.Color , but for the GradientDrawable that we are going to use, it use color as ARGB integer. So it‚Äôs nifty that React Native deals with Color as int type. We also need to specify customType = ‚ÄúColor‚Äù as Color is something kinda custom.</p>
<h3 id="RNGradientView-1"><a href="#RNGradientView-1" class="headerlink" title="RNGradientView"></a>RNGradientView</h3><p>This is where we implement our view, we can do that in Kotlin if we like.</p>
<p><strong>RNGradientView.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import android.content.Context;
import android.graphics.drawable.GradientDrawable;
import android.graphics.drawable.ScaleDrawable;
import android.support.annotation.Nullable;
import android.util.AttributeSet;
import android.view.Gravity;
import android.view.View;

public class RNGradientView extends View {

    float progress;
    float cornerRadius;
    int fromColor;
    int toColor;

    public RNGradientView(Context context) {
        super(context);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs) {
        super(context, attrs);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    public RNGradientView(Context context, @Nullable AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(context, attrs, defStyleAttr, defStyleRes);
    }

    // update

    void update() {
        GradientDrawable gradient = new GradientDrawable();
        gradient.setColors(new int[] {
            this.fromColor,
            this.toColor
        });
         gradient.setOrientation(GradientDrawable.Orientation.*LEFT_RIGHT*);
        gradient.setGradientType(GradientDrawable.*LINEAR_GRADIENT*);
        gradient.setShape(GradientDrawable.*RECTANGLE*);
        gradient.setCornerRadius(this.cornerRadius * 4);

        ScaleDrawable scale = new ScaleDrawable(gradient, Gravity.*LEFT*, 1, -1);
        scale.setLevel((int)(this.progress * 10000));

        this.setBackground(scale);
    }

    // Getter &amp; setter

    public void setProgress(float progress) {
        this.progress = progress;
        this.update();
    }

    public void setCornerRadius(float cornerRadius) {
        this.cornerRadius = cornerRadius;
        this.update();
    }

    public void setFromColor(int fromColor) {
        this.fromColor = fromColor;
        this.update();
    }

    public void setToColor(int toColor) {
        this.toColor = toColor;
        this.update();
    }
}</code></pre><p>Pay attention to the <a href="https://developer.android.com/reference/android/graphics/drawable/GradientDrawable.html#setColors(int[])">setColors</a> as it use an array of int</p>
<blockquote>
<p>Sets the colors used to draw the gradient.<br>Each color is specified as an ARGB integer and the array must contain at least 2 colors.</p>
</blockquote>
<p>If we call setBackground with the GradientDrawable it will be stretched to fill the view. In our case we want to support progress which determines how long the gradient should show. To fix that we use <a href="https://developer.android.com/reference/android/graphics/drawable/ScaleDrawable">ScaleDrawable</a> which is a Drawable that changes the size of another Drawable based on its current level value.</p>
<p>The same value for cornerRadius works in iOS, but for Android we need to use higher values, that‚Äôs why the multiplication in gradient.setCornerRadius(this.cornerRadius * 4)</p>
<h3 id="Shape-drawable"><a href="#Shape-drawable" class="headerlink" title="Shape drawable"></a>Shape drawable</h3><p>Another way to implement gradient is to use Shape Drawable with xml , it‚Äôs the equivalent of using xib in iOS. We can create something like gradient.xml and put that inside /res/drawable</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;shape xmlns:android=&quot;[http://schemas.android.com/apk/res/android](http://schemas.android.com/apk/res/android)&quot;
    android:shape=&quot;rectangle&quot;&gt;
    &lt;gradient
        android:startColor=&quot;#3B5998&quot;
        android:endColor=&quot;#00000000&quot;
        android:angle=&quot;45&quot;/&gt;    
&lt;/shape&gt;</code></pre><p>For more information, you can read<br><a href="https://android.jlelse.eu/android-shape-drawables-tutorial-17fbece6fef5"><strong>Android Shape Drawables Tutorial</strong><br><em>Have you ever wanted to reduce your Android application‚Äôs size or make it look more interesting? If yes, then you‚Ä¶</em>android.jlelse.eu</a></p>
<p>We can also use the class directly <a href="https://developer.android.com/reference/android/graphics/drawable/ShapeDrawable">ShapeDrawable</a> in code</p>
<blockquote>
<p>A Drawable object that draws primitive shapes. A ShapeDrawable takes a <a href="https://developer.android.com/reference/android/graphics/drawable/shapes/Shape.html">Shape</a> object and manages its presence on the screen. If no Shape is given, then the ShapeDrawable will default to a <a href="https://developer.android.com/reference/android/graphics/drawable/shapes/RectShape.html">RectShape</a>.<br>This object can be defined in an XML file with the <shape> element.</p>
</blockquote>
<h3 id="GradientManagerPackage"><a href="#GradientManagerPackage" class="headerlink" title="GradientManagerPackage"></a>GradientManagerPackage</h3><p>In iOS we use RCT_EXPORT_MODULE to register the component, but in Android, things are done explicitly using Package . A package can register both native module and native UI component. In this case we deal with just UI component, so let‚Äôs return RNGradientManager in createViewManagers</p>
<p><strong>GradientManagerPackage.java</strong></p>
<pre><code>package com.onmyway133.myApp.nativeComponents;

import com.facebook.react.ReactPackage;
import com.facebook.react.bridge.NativeModule;
import com.facebook.react.bridge.ReactApplicationContext;
import com.facebook.react.uimanager.ViewManager;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;

public class RNGradientViewPackage implements ReactPackage {
    [@Override](http://twitter.com/Override)
    public List&lt;NativeModule&gt; createNativeModules(ReactApplicationContext reactContext) {
        return Collections.emptyList();
    }

[@Override](http://twitter.com/Override)
    public List&lt;ViewManager&gt; createViewManagers(ReactApplicationContext reactContext) {
        return Arrays.&lt;ViewManager&gt;asList(
            new RNGradientViewManager()
        );
    }
}</code></pre><p>Then head over to MainApplication.java to declare our package</p>
<pre><code>[@Override](http://twitter.com/Override)
protected List&lt;ReactPackage&gt; getPackages() {
  return Arrays.&lt;ReactPackage&gt;asList(
      new MainReactPackage(),
      new RNGradientViewPackage()
  );
}</code></pre><p>That‚Äôs it for Android. We already have the GradientView.js written earlier, when running the app in Android, it will look up and load our RNGradientView</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>Hope you learn something about native UI component. In the post we only touch the surfaces on what native UI component can do, which is just passing configurations from Javascript to native. There are a lot more to discover, like event handling, thread, styles, custom types, please consult the official documentation for correct guidance.</p>
<ul>
<li><a href="https://facebook.github.io/react-native/docs/native-components-ios">Native UI Components for iOS</a></li>
<li><a href="https://facebook.github.io/react-native/docs/native-components-android">Native UI Components for Android</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T15:57:01.000Z" title="2019-05-23T15:57:01.000Z">2019-05-23</time><span class="level-item">11 minutes read (About 1723 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-dismiss-keyboard-with-react-navigation-in-React-Native-apps/">How to dismiss keyboard with react-navigation in React Native apps</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/263">#263</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/how-to-dismiss-keyboard-with-react-navigation-in-react-native-apps-4b987bbfdc48">https://medium.com/react-native-training/how-to-dismiss-keyboard-with-react-navigation-in-react-native-apps-4b987bbfdc48</a></p>
<hr>
<p>Showing and dismiss keyboard seems like a trivial thing to do in mobile apps, but it can be tricky in automatically dismissing it when it comes together with react-navigation and modal presentation. At least that‚Äôs according to my initial assumption. This article aims to detail what I have learned about keyboard handling and how to avoid extra tap when dealing with TextInput There will also be lots of code spelunking, thanks to the all the libraries being open source. The version of React Native I‚Äôm using at the time of writing is 0.57.5</p>
<h2 id="The-built-in-TextInput-component"><a href="#The-built-in-TextInput-component" class="headerlink" title="The built in TextInput component"></a>The built in TextInput component</h2><p>React Native comes with a bunch of basic components, one of them is the <a href="https://facebook.github.io/react-native/docs/textinput">TextInput</a> for inputting text into the app via a keyboard.</p>
<pre><code>import React, { Component } from &apos;react&apos;;
import { AppRegistry, TextInput } from &apos;react-native&apos;;

export default class UselessTextInput extends Component {
  constructor(props) {
    super(props);
    this.state = { text: &apos;Useless Placeholder&apos; };
  }

render() {
    return (
      &lt;TextInput
        style={{height: 40, borderColor: 'gray', borderWidth: 1}}
        onChangeText={(text) =&gt; this.setState({text})}
        value={this.state.text}
      /&gt;
    );
  }
}</code></pre><p>That‚Äôs it, whenever we click on the text input, keyboard appears allowing us to enter values. To dismiss the keyboard by pressing anywhere on the screen, the easy solution is to TouchableWithoutFeedback together with Keyboard . This is similar to having UITapGestureRecognizer in iOS UIView and calling view.endEditing</p>
<pre><code>import { Keyboard } from &apos;react-native&apos;

Keyboard.dismiss()</code></pre><h2 id="TextInput-inside-ScrollView"><a href="#TextInput-inside-ScrollView" class="headerlink" title="TextInput inside ScrollView"></a>TextInput inside ScrollView</h2><p>Normally we should have some text inputs inside a scrolling component, in React Native that is mostly ScrollView to be able to handle long list of content and avoid keyboard. If TextInput is inside ScrollView then the way keyboard gets dismissed behaves a bit differently, and depends on <a href="https://facebook.github.io/react-native/docs/scrollview#keyboardshouldpersisttaps">keyboardShouldPersistTaps</a></p>
<p>Determines when the keyboard should stay visible after a tap.</p>
<ul>
<li><p>‚Äònever‚Äô (the default), tapping outside of the focused text input when the keyboard is up dismisses the keyboard. When this happens, children won‚Äôt receive the tap.</p>
</li>
<li><p>‚Äòalways‚Äô, the keyboard will not dismiss automatically, and the scroll view will not catch taps, but children of the scroll view can catch taps.</p>
</li>
<li><p>‚Äòhandled‚Äô, the keyboard will not dismiss automatically when the tap was handled by a children, (or captured by an ancestor).</p>
</li>
</ul>
<p>The never mode should be the desired behaviour in most cases, clicking anywhere outside the focused text input should dismiss the keyboard.</p>
<p>In my app, there are some text inputs and an action button. The scenario is that users enter some infos and then press that button to register data. With the never mode, we have to press button twice, one for dismissing the keyboard, and two for the onPress of the Button . So the solution is to use always mode. This way the Button always gets the press event first.</p>
<pre><code>&lt;ScrollView keyboardShouldPersistTaps=&apos;always&apos; /&gt;</code></pre><h2 id="ScrollView-cares-about-keyboard"><a href="#ScrollView-cares-about-keyboard" class="headerlink" title="ScrollView cares about keyboard"></a>ScrollView cares about keyboard</h2><p>The native RCTScrollView class that power react native ScrollView has code to handle dismiss mode</p>
<pre><code>RCT_SET_AND_PRESERVE_OFFSET(setKeyboardDismissMode, keyboardDismissMode, UIScrollViewKeyboardDismissMode)</code></pre><p>The option that it chooses is UIScrollViewKeyboardDismissMode for <a href="https://developer.apple.com/documentation/uikit/uiscrollview/1619437-keyboarddismissmode">keyboardDismissMode</a> property</p>
<blockquote>
<p>The manner in which the keyboard is dismissed when a drag begins in the scroll view.</p>
</blockquote>
<p>As you can see, the possible modes are onDrag and interactive . And react native exposes customization point for this via keyboardShouldPersistTaps</p>
<p><a href="https://developer.apple.com/documentation/uikit/uiscrollview/keyboarddismissmode/none">case none</a> The keyboard does not get dismissed with a drag.</p>
<p><a href="https://developer.apple.com/documentation/uikit/uiscrollview/keyboarddismissmode/ondrag">case onDrag</a> The keyboard is dismissed when a drag begins.</p>
<p><a href="https://developer.apple.com/documentation/uikit/uiscrollview/keyboarddismissmode/interactive">case interactive</a> The keyboard follows the dragging touch offscreen, and can be pulled upward again to cancel the dismiss.</p>
<h2 id="ScrollView-inside-a-Modal"><a href="#ScrollView-inside-a-Modal" class="headerlink" title="ScrollView inside a Modal"></a>ScrollView inside a Modal</h2><p>But that does not work when ScrollView is inside <a href="https://facebook.github.io/react-native/docs/modal.html">Modal</a> . By Modal I meant the <a href="https://facebook.github.io/react-native/docs/modal.html">Modal</a> component in React Native. The only library that I use is react-navigation , and it supports <a href="https://reactnavigation.org/docs/en/modal.html">Opening a full-screen modal</a> too, but they way we declare modal in react-navigation looks like stack and it is confusing, so I would rather not use it. I use Modal in react-native and that works pretty well.</p>
<p>So if we have TextInput inside ScrollView inside Modal then keyboardShouldPersistTaps does not work. Modal seems to be aware of parent ScrollView so we have to declare keyboardShouldPersistTaps=‚Äôalways‚Äô on every parent ScrollView . In React Native FlatList and SectionList uses ScrollView under the hood, so we need to be aware of all those ScrollView components.</p>
<h2 id="Spelunking-react-navigation"><a href="#Spelunking-react-navigation" class="headerlink" title="Spelunking react-navigation"></a>Spelunking react-navigation</h2><p>Since my app relies heavily on react-navigation , it‚Äôs good to have a deep understanding about its components so we make sure where the problem lies. I‚Äôve written a bit about react-navigation structure below.<br><a href="https://codeburst.io/using-react-navigation-3-0-in-react-native-apps-38cd5020fbbe"><strong>Using react-navigation 3.0 in React Native apps</strong><br><em>react-navigation is probably the only dependency I use in React Native apps. I‚Äôm happy with it so far, then version 3.0‚Ä¶</em>codeburst.io</a></p>
<p>Like every traditional mobile apps, my app consists of many stack navigators inside tab navigator. In iOS that means many UINavigationViewController inside UITabbarController . In react-navigation I use createMaterialTopTabNavigator inside createBottomTabNavigator</p>
<pre><code>import { createMaterialTopTabNavigator } from &apos;react-navigation&apos;
import { createBottomTabNavigator, BottomTabBar } from &apos;react-navigation-tabs&apos;</code></pre><p>The screen I have keyboard issue is a Modal presented from the 2nd screen in one of the stack navigators, so let‚Äôs examine every possible ScrollView up the hierarchy. This process involves lots of code reading and this‚Äôs how I love open source.</p>
<p>First let‚Äôs start with <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/navigators/createBottomTabNavigator.js">createBottomTabNavigator</a> which uses <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/utils/createTabNavigator.js">createTabNavigator</a> together with its own TabNavigationView</p>
<pre><code>class TabNavigationView extends React.PureComponent&lt;Props, State&gt;

export default createTabNavigator(TabNavigationView);</code></pre><p>Tab navigator has tab bar view below ScreenContainer , which is used to contain view. ScreenContainer is from <a href="https://github.com/kmagiera/react-native-screens">react-native-screens</a> ‚ÄúThis project aims to expose native navigation container components to React Native‚Äù. Below is how tab navigator works.</p>
<pre><code>render() {
  const { navigation, renderScene, lazy } = this.props;
  const { routes } = navigation.state;
  const { loaded } = this.state
  return (
    &lt;View style={styles.container}&gt;
      &lt;ScreenContainer style={styles.pages}&gt;
        {routes.map((route, index) =&gt; {
          if (lazy &amp;&amp; !loaded.includes(index)) {
            // Don&apos;t render a screen if we&apos;ve never navigated to it
            return null;

          const isFocused = navigation.state.index === index
          return (
            &lt;ResourceSavingScene
              key={route.key}
              style={StyleSheet.absoluteFill}
              isVisible={isFocused}
            &gt;
              {renderScene({ route })}
            &lt;/ResourceSavingScene&gt;
          );
        })}
      &lt;/ScreenContainer&gt;
      {this._renderTabBar()}
    &lt;/View&gt;
  );
}</code></pre><p>Tab bar is rendered using <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/views/BottomTabBar.js">BottomTabBar</a> in _renderTabBar function. Looking at the code, the whole tab navigator has nothing to do with ScrollView .</p>
<p>So there is only <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/navigators/createMaterialTopTabNavigator.js">createMaterialTopTabNavigator</a> left on the suspecting list. I use it in the app with swipeEnabled: true . And by looking at the imports, top tab navigator has</p>
<pre><code>import MaterialTopTabBar, {  type TabBarOptions,} from &apos;../views/MaterialTopTabBar&apos;;</code></pre><p><a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/views/MaterialTopTabBar.js">MaterialTopTabBar</a> has import from <a href="https://github.com/react-native-community/react-native-tab-view/blob/master/src/TabBar.js">react-native-tab-view</a></p>
<pre><code>import { TabBar } from &apos;react-native-tab-view&apos;;</code></pre><p>which has ScrollView</p>
<pre><code>&lt;View style={styles.scroll}&gt;
  &lt;Animated.ScrollView
    horizontal
    keyboardShouldPersistTaps=&quot;handled&quot;</code></pre><p>The property keyboardShouldPersistTaps was initial set to always , then set back to <a href="https://github.com/react-native-community/react-native-tab-view/commit/e00bd021158a9ca6ad6f1ad0578303f0fdedb9e6#diff-9c1d42ef76323a8c67bd25bccfea6132">handled</a> to avoid the bug that we can‚Äôt press any button in tab bar while keyboard is open <a href="https://github.com/react-native-community/react-native-tab-view/issues/375">https://github.com/react-native-community/react-native-tab-view/issues/375</a></p>
<p>But this TabBar has nothing with our problem, because it‚Äôs just for containing tab bar buttons.</p>
<h2 id="Swiping-in-createMaterialTopTabNavigator"><a href="#Swiping-in-createMaterialTopTabNavigator" class="headerlink" title="Swiping in createMaterialTopTabNavigator"></a>Swiping in createMaterialTopTabNavigator</h2><p>Taking another look at <a href="https://github.com/react-navigation/react-navigation-tabs/blob/master/src/navigators/createMaterialTopTabNavigator.js">createMaterialTopTabNavigator</a> we see more imports from react-native-tab-view</p>
<pre><code>import { TabView, PagerPan } from &apos;react-native-tab-view&apos;;</code></pre><p>TabView has swipeEnabled passed in</p>
<pre><code>return (
  &lt;TabView
    {...rest}
    navigationState={navigation.state}
    animationEnabled={animationEnabled}
    swipeEnabled={swipeEnabled}
    onAnimationEnd={this._handleAnimationEnd}
    onIndexChange={this._handleIndexChange}
    onSwipeStart={this._handleSwipeStart}
    renderPager={renderPager}
    renderTabBar={this._renderTabBar}
    renderScene={
      /* $FlowFixMe */
      this._renderScene
    }
  /&gt;
);</code></pre><p>and it renders <a href="https://github.com/react-native-community/react-native-tab-view/blob/8b463fc31d/src/PagerDefault.js">PagerDefault</a>, which in turn uses PagerScroll for iOS</p>
<pre><code>import { Platform } from &apos;react-native&apos;;

let Pager;

switch (Platform.OS) {
  case &apos;android&apos;:
    Pager = require(&apos;./PagerAndroid&apos;).default;
    break;
  case &apos;ios&apos;:
    Pager = require(&apos;./PagerScroll&apos;).default;
    break;
  default:
    Pager = require(&apos;./PagerPan&apos;).default;
    break;
}

export default Pager;</code></pre><p>So <a href="https://github.com/react-native-community/react-native-tab-view/blob/8b463fc31d/src/PagerScroll.js">PagerScroll</a> uses ScrollView to handle scrolling to match material style that user can scroll between pages, and it has keyboardShouldPersistTaps=‚Äùalways‚Äù which should be correct.</p>
<pre><code>return (
  &lt;ScrollView
    horizontal
    pagingEnabled
    directionalLockEnabled
    keyboardDismissMode=&quot;on-drag&quot;
    keyboardShouldPersistTaps=&quot;always&quot;</code></pre><p>So nothing looks suspicious in react-navigation , which urges me to look at code from my project.</p>
<h2 id="Debugging-FlatList-SectionList-and-ScrollView"><a href="#Debugging-FlatList-SectionList-and-ScrollView" class="headerlink" title="Debugging FlatList, SectionList and ScrollView"></a>Debugging FlatList, SectionList and ScrollView</h2><p>Like I stated in the beginning of this article, the root problem is that we need to declare keyboardShouldPersistTaps for all parent ScrollView in the hierarchy. That means to look out for any FlatList, SectionList and ScrollView</p>
<p>Luckily, there is react-devtools that shows tree of all rendered components in react app, and that is also guided in <a href="https://facebook.github.io/react-native/docs/debugging.html">Debugging</a> section of react native.</p>
<p>You can use <a href="https://github.com/facebook/react-devtools/tree/master/packages/react-devtools">the standalone version of React Developer Tools</a> to debug the React component hierarchy. To use it, install the react-devtools package globally:</p>
<pre><code>npm install -g react-devtools</code></pre><p>So after searching I found out that there is a SectionList up the hierarchy that should have keyboardShouldPersistTaps=‚Äôalways‚Äô while it didn‚Äôt.</p>
<p><img src="https://cdn-images-1.medium.com/max/7168/1*RDNnY3yKYpgxdaXi4bGUTg.png" alt=""></p>
<p>Taking a thorough look at the code, I found out that the Modal is trigged from a SectionList item. We already know that triggering Modal in react native means that to embed that Modal inside the view hierarchy and control its visibility via a state. So in terms of view and component, that Modal is inside a SectionList . And for your interest, if you dive deep into react native code, SectionList in my case is just VirtualizedSectionList , which is VirtualizedList, which uses ScrollView</p>
<p>So after I declare keyboardShouldPersistTaps=‚Äôalways‚Äô in that SectionList , the problem is solved. User can now just enters some values in the text inputs, then press once on the submit button to submit data. The button now captures touch events first instead of scrollview.</p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>The solution for this is fortunately simple as it involves fixing our code without having to alter react-navigation code. But it‚Äôs good to look at the library code to know what it does, and to trace where the problem originates. Thanks for following such long exploring and hope you learn something.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T14:48:39.000Z" title="2019-05-23T14:48:39.000Z">2019-05-23</time><span class="level-item">12 minutes read (About 1815 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-Firebase-SDK-with-Firestore-for-React-Native/">How to use Firebase SDK with Firestore for React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/260">#260</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/firebase-sdk-with-firestore-for-react-native-apps-in-2018-aa89a67d6934">https://medium.com/react-native-training/firebase-sdk-with-firestore-for-react-native-apps-in-2018-aa89a67d6934</a></p>
<hr>
<p>At <a href="https://www.youtube.com/watch?v=W3xIOQu0h1w">Firebase Dev Summit 2017</a>, Google introduced <a href="https://firebase.googleblog.com/2017/10/introducing-cloud-firestore.html">Firestore</a> as fully-managed NoSQL document database for mobile and web app development. Compared to Firebase Realtime Database, it has <a href="https://firebase.googleblog.com/2017/10/cloud-firestore-for-rtdb-developers.html">better querying</a> and more structured data, together with ease manual fetching of data.</p>
<p>The new structure of collection and document is probably the eye catching, this makes data more intuitive to users and query a breeze.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*mEjeh2eMqIvQYNTa.png" alt="From [https://firebase.googleblog.com/2017/10/cloud-firestore-for-rtdb-developers.html](https://firebase.googleblog.com/2017/10/cloud-firestore-for-rtdb-developers.html)"><em>From <a href="https://firebase.googleblog.com/2017/10/cloud-firestore-for-rtdb-developers.html">https://firebase.googleblog.com/2017/10/cloud-firestore-for-rtdb-developers.html</a></em></p>
<p>In this post, I will show how to setup Firebase Cloud Firestore in React Native apps for both iOS and Android through, of course, some pain points. Then we create and fetch document in Firestore database.</p>
<h2 id="Firebase-Javascript-SDK"><a href="#Firebase-Javascript-SDK" class="headerlink" title="Firebase Javascript SDK"></a>Firebase Javascript SDK</h2><p>My first option is to go with <a href="https://github.com/firebase/firebase-js-sdk">Firebase Javascript SDK</a>, as it worked well for me with Firebase Realtime Database. My use case is to just fetch and update Firestore collections, I think it does not involve much of native features. Furthermore, when possible I try to avoid native code as much as possible when dealing with React Native.</p>
<p>So let‚Äôs try <a href="https://firebase.google.com/docs/firestore/quickstart">Get started with Cloud Firestore</a></p>
<pre><code>npm install firebase</code></pre><p>The version I install is 5.4.0. Next, import firebase and note that we need to import firestore as well</p>
<pre><code>const firebase = require(&quot;firebase&quot;);
// Required for side-effects
require(&quot;firebase/firestore&quot;);</code></pre><h3 id="document-is-not-defined"><a href="#document-is-not-defined" class="headerlink" title="document is not defined"></a>document is not defined</h3><p>This <a href="https://github.com/firebase/firebase-js-sdk/issues/1157">issue</a> made me bang against my desk for a while. As <a href="https://github.com/firebase/firebase-js-sdk/issues/1138">people</a> have pointed out, it is because of document being accessed.</p>
<pre><code>var BrowserPlatform = /** @class */ (function () {
    function BrowserPlatform() {
        this.emptyByteString = &apos;&apos;;
        this.document = document; // delete this line
        this.window = window; // delete this line
        this.base64Available = typeof atob !== &apos;undefined&apos;;
    }</code></pre><p>The firestore component in the current Firebase Javascript SDK does not fully support React Native, so we need to work around or use beta version with npm install firebase@next . In the mean time, let‚Äôs try React Native Firebase.</p>
<h2 id="React-Native-Firebase"><a href="#React-Native-Firebase" class="headerlink" title="React Native Firebase"></a>React Native Firebase</h2><p>Reading over at <a href="https://firebase.google.com/docs/firestore/library-integrations">Cloud Firestore Library and framework integrations</a>, React Native Firebase is recommended. Although some features from the <a href="https://www.npmjs.com/package/firebase">Firebase Web SDK</a> will generally work with React Native, it is mainly built for the web and as such has a limited compatible feature set.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*rae3_7gLeEQvPRDNesXgrw.png" alt="Source: [https://rnfirebase.io/docs/v4.3.x/getting-started](https://rnfirebase.io/docs/v4.3.x/getting-started)"><em>Source: <a href="https://rnfirebase.io/docs/v4.3.x/getting-started">https://rnfirebase.io/docs/v4.3.x/getting-started</a></em></p>
<p>The below article and their <a href="https://github.com/invertase/react-native-firebase-starter">starter app</a> is the guiding star. The integration with native code in iOS and Android can be painful, but I React Native Firebase is very powerful as it has up-to-date wrappers around native Firebase SDK.</p>
<p>Let ‚Äòs npm install react-native-firebase , the current version is 4.3.8 , and follow <a href="https://rnfirebase.io/docs/v4.3.x/installation/initial-setup">manual setup guide</a> for existing project, this helps you learn more about the process and the bootstrap script.</p>
<h2 id="A-quick-look"><a href="#A-quick-look" class="headerlink" title="A quick look"></a>A quick look</h2><p>First you need to <a href="https://firebase.google.com/console">Firebase console</a> and add a project. A project allows many apps to stay, for example I have 4 apps (2 iOS, 2 Android) that have access to Firestore database.</p>
<p><img src="https://cdn-images-1.medium.com/max/2868/1*ab5VL-6oUZdahAQAFYFBuQ.png" alt=""></p>
<p>Head over to Database in the left menu, we can see a quick look into Firestore and its collection/document structure</p>
<p><img src="https://cdn-images-1.medium.com/max/2796/1*0NEWzQZ9oiKY3lkMBxHtcA.png" alt=""></p>
<h3 id="Setup-for-iOS"><a href="#Setup-for-iOS" class="headerlink" title="Setup for iOS"></a>Setup for iOS</h3><p>Follow <a href="https://rnfirebase.io/docs/v4.3.x/installation/ios">iOS Installation Guide</a></p>
<p>Firstly, download <a href="https://rnfirebase.io/docs/v4.3.x/installation/ios#1.1.-Setup-GoogleService-Info.plist">GoogleService-Info.plist</a> and place it in the correct folder, make sure it has been added to project via Xcode. Otherwise Firebase SDK causes app to crash right after start.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*-Tz59Dx1xbIyqUEuKOlXCA.png" alt=""></p>
<p>Then add #import &lt;Firebase.h&gt; to AppDelegate.m and [FIRApp configure]; to function didFinishLaunchingWithOptions . Next create Podfile with pod init inside ios folder. For Firestore, you need Firebase/Firestore to prevent the error below</p>
<blockquote>
<p>You attempted to use a firebase module that‚Äôs not installed natively on your iOS project by calling firebase.firestore()</p>
</blockquote>
<p>And you shouldn‚Äôt use use_frameworks! as it gives error ‚ÄòFirebaseCore/FIRAnalyticsConfiguration.h‚Äô file not found</p>
<pre><code>platform :ios, &apos;9.0&apos;

target &apos;FoodshopGuest&apos; do
  pod &apos;Firebase/Core&apos;, &apos;~&gt; 5.3.0&apos;
  pod &apos;Firebase/Firestore&apos;, &apos;~&gt; 5.3.0&apos;
end</code></pre><p>If you get framework not found FirebaseAnalytics , then make sure each target has $(inherited) at the top for Framework Search Paths</p>
<p><img src="https://cdn-images-1.medium.com/max/2446/1*TBQZ1GbbDtWFz8Ife2mTEg.png" alt=""></p>
<p>Then run react-native link react-native-firebase and you should be good for iOS.</p>
<h3 id="Setup-for-Android"><a href="#Setup-for-Android" class="headerlink" title="Setup for Android"></a>Setup for Android</h3><p>Android is a bit less straightforward to setup than iOS. But it‚Äôs not impossible. Let‚Äôs follow <a href="https://rnfirebase.io/docs/v4.3.x/installation/android">Android Installation guide</a>.</p>
<p>Firstly, place <a href="https://rnfirebase.io/docs/v4.3.x/installation/android#2.-Setup-google-services.json">google-services.json</a> in android/app/google-services.json . Let‚Äôs also use Gradle 4.4 and Google Play Services 15.0.1 . Change gradle/gradle-wrapper.properties to use</p>
<pre><code>distributionUrl=https\://services.gradle.org/distributions/gradle-4.4-all.zip</code></pre><p>Below is my project build.gradle with compileSdkVersion 27 and buildToolsVersion 27.0.3 . Make sure google() stays above jcenter()</p>
<pre><code>// Top-level build file where you can add configuration options common to all sub-projects/modules.

buildscript {
    repositories {
        mavenLocal()
        google()
        jcenter()
        maven {
            url &apos;[https://maven.google.com/&apos;](https://maven.google.com/&apos;)
            name &apos;Google&apos;
        }
    }
    dependencies {
        classpath &apos;com.android.tools.build:gradle:3.1.3&apos;
        classpath &apos;com.google.gms:google-services:4.0.1&apos;

// NOTE: Do not place your application dependencies here; they belong
        // in the individual module build.gradle files
    }
}

allprojects {
    repositories {
        mavenLocal()
        google()
        jcenter()
        maven {
            // All of React Native (JS, Obj-C sources, Android binaries) is installed from npm
            url &quot;$rootDir/../node_modules/react-native/android&quot;
        }
    }
}

ext {
    buildToolsVersion = &quot;27.0.3&quot;
    minSdkVersion = 16
    compileSdkVersion = 27
    targetSdkVersion = 26
    supportLibVersion = &quot;26.1.0&quot;
}</code></pre><p>For my app module build.gradle , let‚Äôs have apply plugin: ‚Äòcom.google.gms.google-services‚Äô at the very bottom of the file, this is important. In dependencies section, you must have com.google.firebase:firebase-firestore to include Firestore component.</p>
<pre><code>dependencies {
    implementation project(&apos;:react-native-firebase&apos;)
    implementation fileTree(dir: &quot;libs&quot;, include: [&quot;*.jar&quot;])
    implementation &quot;com.android.support:appcompat-v7:${rootProject.ext.supportLibVersion}&quot;

// Firebase dependencies
    implementation &quot;com.google.android.gms:play-services-base:15.0.1&quot;
    implementation &quot;com.google.firebase:firebase-core:16.0.1&quot;
    implementation &quot;com.google.firebase:firebase-firestore:17.0.2&quot;

}</code></pre><p>Make sure there is no duplication of project(‚Äò:react-native-firebase‚Äô) . And since we are using Gradle 4, let‚Äôs use implementation instead of compile<br><a href="https://stackoverflow.com/questions/44493378/whats-the-difference-between-implementation-and-compile-in-gradle"><strong>What‚Äôs the difference between implementation and compile in Gradle?</strong><br><em>This site uses cookies to deliver our services and to show you relevant ads and job listings. By using our site, you‚Ä¶</em>stackoverflow.com</a></p>
<p>Because of Firestore, let‚Äôs follow <a href="https://github.com/invertase/react-native-firebase-starter/blob/master/android/app/build.gradle">react-native-firebase-starter</a> to fix heap problem</p>
<pre><code>dexOptions {
    javaMaxHeapSize &quot;4g&quot;
}

multiDexEnabled true</code></pre><p>If you get Native module RNFirebaseModule tried to override FNFirebaseModule</p>
<blockquote>
<p>Native module RNFirebaseModule tried to override FNFirebaseModule for module name Firebase. If this was your intention, set `canOverrideExistingModule=true</p>
</blockquote>
<p>Then make sure your MainApplication.java has no duplication for new RNFirebasePackage() . Here is my MainApplication.java , note that you need import io.invertase.firebase.firestore.RNFirebaseFirestorePackage; in order to use RNFirebaseFirestorePackage</p>
<pre><code>package com.fantageek.foodshophost;

import android.app.Application;

import com.facebook.react.ReactApplication;
import io.invertase.firebase.RNFirebasePackage;
import io.invertase.firebase.firestore.RNFirebaseFirestorePackage;
import com.facebook.react.ReactNativeHost;
import com.facebook.react.ReactPackage;
import com.facebook.react.shell.MainReactPackage;
import com.facebook.soloader.SoLoader;

import java.util.Arrays;
import java.util.List;

public class MainApplication extends Application implements ReactApplication {

private final ReactNativeHost mReactNativeHost = new ReactNativeHost(this) {
    [@Override](http://twitter.com/Override)
    public boolean getUseDeveloperSupport() {
      return BuildConfig.DEBUG;
    }

[@Override](http://twitter.com/Override)
    protected List&lt;ReactPackage&gt; getPackages() {
      return Arrays.&lt;ReactPackage&gt;asList(
          new MainReactPackage(),
          new RNFirebasePackage(),
          new RNFirebaseFirestorePackage()
      );
    }

[@Override](http://twitter.com/Override)
    protected String getJSMainModuleName() {
      return &quot;index&quot;;
    }
  };

[@Override](http://twitter.com/Override)
  public ReactNativeHost getReactNativeHost() {
    return mReactNativeHost;
  }

[@Override](http://twitter.com/Override)
  public void onCreate() {
    super.onCreate();
    SoLoader.init(this, /* native exopackage */ false);
  }
}</code></pre><p>My rule of thumb is that you should always use Android Studio to perform Gradle sync or Build projectThere you should be able to see compile issues much easier. With all the steps above, compilation should succeed.</p>
<p>One problem with running React Native on Android, if after react-native run-android and Metro keeps showing Loading dependency graph, done , then you should start emulator via Android Studio -&gt; AVD Manager or adb , the app should be already installed in the emulator, open the app and Metro will start loading again.</p>
<h2 id="Trying-Firestore"><a href="#Trying-Firestore" class="headerlink" title="Trying Firestore"></a>Trying Firestore</h2><p>React Native Firebase should give you similar APIs to those in the web, so learn from <a href="https://firebase.google.com/docs/firestore/query-data/get-data">Get data with Cloud Firestore</a> for how to get or set documents.</p>
<p>I like to organise services in separate files, here is how to reference firestore and load document.</p>
<pre><code>import firebase from &apos;react-native-firebase&apos;

class FirebaseService {
  constructor() {
    this.ref = firebase.firestore().collection(&apos;people&apos;)
  }

async load(id) {
    const doc = await this.ref.doc(id).get()
    if (doc.exists) {
      return doc.data()
    } else {
      const defaultDoc = {
        name: &quot;ABC&quot;,
        age: 2
      }

await this.ref.doc(id).set(defaultDoc)
      return doc
    }
  }
}

export const firebaseService = new FirebaseService()</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>I hope this article helps in setting up Firebase SDK in React Native apps. Below are some resources that helps you explore further. The react-native-firebase-starter contains awesome reference code if you get into any troubles with react-native-firebase.<br><a href="https://blog.invertase.io/getting-started-with-cloud-firestore-on-react-native-b338fb6525b9"><strong>Getting started with Cloud Firestore on React Native</strong><br><em>A week ago, Firebase announced Cloud Firestore, an awesome NoSQL document database that complements the existing‚Ä¶</em>blog.invertase.io</a><br><a href="https://github.com/invertase/react-native-firebase-starter"><strong>invertase/react-native-firebase-starter</strong><br><em>react-native-firebase-starter - üéÅ A bare-bones react native app with react-native-firebase pre-integrated so you can‚Ä¶</em>github.com</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T14:47:40.000Z" title="2019-05-23T14:47:40.000Z">2019-05-23</time><span class="level-item">10 minutes read (About 1436 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-position-element-at-the-bottom-of-the-screen-using-Flexbox-in-React-Native/">How to position element at the bottom of the screen using Flexbox in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/259">#259</a></strong></p>
<p>Original post <a href="https://medium.com/react-native-training/position-element-at-the-bottom-of-the-screen-using-flexbox-in-react-native-a00b3790ca42">https://medium.com/react-native-training/position-element-at-the-bottom-of-the-screen-using-flexbox-in-react-native-a00b3790ca42</a></p>
<hr>
<p>React Native uses <a href="https://github.com/facebook/yoga">Yoga</a> to achieve <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox">Flexbox</a> style layout, which helps us set up layout in a declarative and easy way.</p>
<blockquote>
<p>The Flexible Box Module, usually referred to as flexbox, was designed as a one-dimensional layout model, and as a method that could offer space distribution between items in an interface and powerful alignment capabilities</p>
</blockquote>
<p>As someone who worked with Auto Layout in iOS and Constrain Layout in Android, I sometimes find it difficult to work with Flexbox in React Native. One of them is how to position certain element at the top or the bottom of the screen. This is the scenario when one element does not follow the rule i the container.</p>
<h2 id="A-traditional-layout"><a href="#A-traditional-layout" class="headerlink" title="A traditional layout"></a>A traditional layout</h2><p>Consider this traditional welcome screen, where we have some texts and a login button.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*mYxO00FDyT91dNaFHeCvIA.png" alt=""></p>
<p>Which is easily achieved with</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet, Image, Text, Button } from &apos;react-native&apos;
import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;
import ImageButton from &apos;library/components/ImageButton&apos;

export default class Welcome extends React.Component {
  render() {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Image
          style={styles.image}
          source={images.placeholder} /&gt;
        &lt;Text style={styles.heading}&gt;{strings.onboarding.welcome.heading.toUpperCase()}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text1}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text2}&lt;/Text&gt;
        &lt;ImageButton
          style={styles.button}
          title={strings.onboarding.welcome.button} /&gt;
      &lt;/View&gt;
    )
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  image: {
    marginTop: 50
  },
  heading: {
    ...palette.heading, ...{
      marginTop: 40
    }
  },
  text: {
    ...palette.text, ...{
      marginHorizontal: 8,
      marginVertical: 10
    }
  }
})</code></pre><p>Pay attention to styles . Unlike in web, Flexbox in React Native defaults main axis to be vertical, so elements are laid out from top to bottom. alignItems makes sure all elements are centered in the horizontal axis, which is the cross axis according to Flexbox terminology.</p>
<h2 id="Position-button-at-the-bottom"><a href="#Position-button-at-the-bottom" class="headerlink" title="Position button at the bottom"></a>Position button at the bottom</h2><p>According to design, the button should be positioned at the bottom of the screen. A dark though might suggest us to use position: ‚Äòabsolute‚Äô , something like</p>
<pre><code>button: {
  position: &apos;absolute&apos;,
  bottom:0
}</code></pre><p>It workaround could work, but it‚Äôs like opting out of Flexbox. We like Flexbox and we like to embrace it. The solution is to use add a container for the button, and use flex-end inside so that the button moves to the bottom.</p>
<p>Let‚Äôs add a container</p>
<pre><code>&lt;View style={styles.bottom}&gt;
  &lt;ImageButton
    style={styles.button}
    title={strings.onboarding.welcome.button} /&gt;
&lt;/View&gt;</code></pre><p>and styles</p>
<pre><code>bottom: {
  flex: 1,
  justifyContent: &apos;flex-end&apos;,
  marginBottom: 36
}</code></pre><p>The flex tells the bottom view to take the remaining space. And inside this space, the bottom is laid out from the bottom, that‚Äôs what the flex-end means.</p>
<p>Here is how the result looks like</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*J2SIgsqzREyRz-GSsgoKIA.png" alt=""></p>
<p>And there is the full code</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet, Image, Text, Button } from &apos;react-native&apos;
import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;
import ImageButton from &apos;library/components/ImageButton&apos;

export default class Welcome extends React.Component {
  render() {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Image
          style={styles.image}
          source={images.placeholder} /&gt;
        &lt;Text style={styles.heading}&gt;{strings.onboarding.welcome.heading.toUpperCase()}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text1}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text2}&lt;/Text&gt;
        &lt;View style={styles.bottom}&gt;
          &lt;ImageButton
            style={styles.button}
            title={strings.onboarding.welcome.button} /&gt;
        &lt;/View&gt;
      &lt;/View&gt;
    )
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  image: {
    marginTop: 50
  },
  heading: {
    ...palette.heading, ...{
      marginTop: 40
    }
  },
  text: {
    ...palette.text, ...{
      marginHorizontal: 8,
      marginVertical: 10
    }
  },
  bottom: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    marginBottom: 36
  }
})</code></pre><h2 id="What-is-flex-1"><a href="#What-is-flex-1" class="headerlink" title="What is flex: 1"></a>What is flex: 1</h2><p>According to <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Flexible_Box_Layout/Basic_Concepts_of_Flexbox">Basic concepts of flexbox</a></p>
<blockquote>
<p>The <strong>flex</strong> <a href="https://developer.mozilla.org/en-US/docs/CSS">CSS</a> property specifies how a flex item will grow or shrink so as to fit the space available in its flex container. This is a <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Shorthand_properties">shorthand</a> property that sets <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/flex-grow">flex-grow</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/flex-shrink">flex-shrink</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/flex-basis">flex-basis</a>.</p>
</blockquote>
<p>and <a href="https://www.w3.org/TR/css-flexbox-1/#flex-common">w3</a></p>
<blockquote>
<p><a href="https://www.w3.org/TR/css-flexbox-1/#propdef-flex">flex: <positive-number></a> Equivalent to <a href="https://www.w3.org/TR/css-flexbox-1/#propdef-flex">flex: <positive-number> 1 0</a>. Makes the flex item flexible and sets the <a href="https://www.w3.org/TR/css-flexbox-1/#flex-flex-basis">flex basis</a> to zero, resulting in an item that receives the specified proportion of the free space in the flex container. If all items in the flex container use this pattern, their sizes will be proportional to the specified flex factor.</p>
</blockquote>
<p>In most browsers, flex: 1 equals 1 1 0 , which means flex-grow: 1, flex-shrink:1, flex-basis: 0 . The flex-grow and flex-shrink specifies how much the item will grow or shrink relative to the rest of the flexible items inside the same container. And the flex-basis specifies the initial length of a flexible item. In this case the bottom View will take up the remaining space. And in that space, we can have whatever flow we want. To move the button to the bottom, we use justifyContent to lay out items in the main axis, with flex-end , which aligns the flex items at the end of the container.</p>
<h2 id="A-compositional-approach"><a href="#A-compositional-approach" class="headerlink" title="A compositional approach"></a>A compositional approach</h2><p>While this works, code can be duplicated quickly as we need to do this in a lot of screens. All we need is to wrap this ImageButton inside a container . Let‚Äôs encapsulate this with a a utility function. Add this utils/moveToBottom.js</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet } from &apos;react-native&apos;

function moveToBottom(component) {
  return (
    &lt;View style={styles.container}&gt;
      {component}
    &lt;/View&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    marginBottom: 36
  }
})

export default moveToBottom</code></pre><p>Now in our screen, we just need to import</p>
<pre><code>import moveToBottom from &apos;library/utils/moveToBottom&apos;</code></pre><p>and wrap our button</p>
<pre><code>{
  moveToBottom(
    &lt;ImageButton
      style={styles.button}
      title={strings.onboarding.welcome.button}
      onPress={() =&gt; {
        this.props.navigation.navigate(&apos;Term&apos;)
      }} /&gt;
  )
}</code></pre><p>This time, we have the same screen as before, but with more reusable code. Since the styles are inside our moveToBottom module, we don‚Äôt need to specify styles in our screen any more. Here is the full code</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet, Image, Text, Button } from &apos;react-native&apos;
import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;
import ImageButton from &apos;library/components/ImageButton&apos;
import moveToBottom from &apos;library/utils/moveToBottom&apos;

export default class Welcome extends React.Component {
  render() {
    return (
      &lt;View style={styles.container}&gt;
        &lt;Image
          style={styles.logo}
          source={images.logo} /&gt;
        &lt;Image
          style={styles.image}
          source={images.placeholder} /&gt;
        &lt;Text style={styles.heading}&gt;{strings.onboarding.welcome.heading.toUpperCase()}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text1}&lt;/Text&gt;
        &lt;Text style={styles.text}&gt;{strings.onboarding.welcome.text2}&lt;/Text&gt;
        {
          moveToBottom(
            &lt;ImageButton
              style={styles.button}
              title={strings.onboarding.welcome.button}
              onPress={() =&gt; {
                this.props.navigation.navigate(&apos;Term&apos;)
              }} /&gt;
          )
        }
      &lt;/View&gt;
    )
  }
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  logo: {
    marginTop: 70,
    marginBottom: 42,
  },
  image: {

},
  heading: {
    ...palette.heading, ...{
      marginTop: 40
    }
  },
  text: {
    ...palette.text, ...{
      marginHorizontal: 8,
      marginVertical: 10
    }
  }
})</code></pre><h2 id="How-to-pass-component-as-parameter"><a href="#How-to-pass-component-as-parameter" class="headerlink" title="How to pass component as parameter"></a>How to pass component as parameter</h2><p>I have to admit that I initially implement moveToBottom using Component (we need uppercase since React has a convention of using initial uppercase for components) to embed the Component inside View</p>
<pre><code>function moveToBottom(Component) {
  return (
    &lt;View style={styles.container}&gt;
      &lt;Component /&gt;
    &lt;/View&gt;
  )
}</code></pre><p>But this results in bundling error</p>
<pre><code>ExceptionsManager.js:84 Warning: React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: &lt;ImageButton /&gt;. Did you accidentally export a JSX literal instead of a component?</code></pre><p>and</p>
<pre><code>ExceptionsManager.js:76 Invariant Violation: Invariant Violation: Invariant Violation: Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: object.</code></pre><p>As this moment I release that the thing I pass in is actually an object, not a class , so I treat it as an object and it works</p>
<pre><code>function moveToBottom(component) {
  return (
    &lt;View style={styles.container}&gt;
      {component}
    &lt;/View&gt;
  )
}</code></pre><h2 id="marginBottom-on-Android"><a href="#marginBottom-on-Android" class="headerlink" title="marginBottom on Android"></a>marginBottom on Android</h2><p>In the above moveToBottom function, I use marginBottom to have some margin from the bottom. This works on iOS but somehow does not have any effect in Android, and I use react-native 0.57.0 at the moment. This inconsistence can happen often in React Native development. A quick workaround is to perform platform check, we can make it into a nifty function in src/library/utils/check</p>
<pre><code>import { Platform } from &apos;react-native&apos;

const check = {
  isAndroid: () =&gt; {
    return Platform.OS === &apos;android&apos;
  }
}

export default check</code></pre><p>Then in moveToBottom , let ‚Äòs use paddingBottom in case of app running in Android</p>
<pre><code>const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    paddingBottom: check.isAndroid ? 14 : 0
  }
})</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>In this post, we go from absolute position to another container, get to know flex , how to add reusable function and how to correctly pass component as parameter. Hope you find it useful. You can also check out this post <a href="https://medium.com/react-native-training/facebook-sdk-with-login-for-react-native-apps-in-2018-196601804f66">React Native Login Using the Facebook SDK</a> where I shows more tips for React Native developments and recommended links to learn about Flexbox.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T07:44:52.000Z" title="2019-05-23T07:44:52.000Z">2019-05-23</time><span class="level-item">8 minutes read (About 1235 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-setup-Android-projects/">How to setup Android projects</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/257">#257</a></strong></p>
<h2 id="checkstyle-Java"><a href="#checkstyle-Java" class="headerlink" title="checkstyle (Java)"></a>checkstyle (Java)</h2><ul>
<li><a href="http://checkstyle.sourceforge.net/">http://checkstyle.sourceforge.net/</a></li>
<li><a href="https://github.com/checkstyle/checkstyle">https://github.com/checkstyle/checkstyle</a></li>
</ul>
<blockquote>
<p>Checkstyle is a development tool to help programmers write Java code that adheres to a coding standard. It automates the process of checking Java code to spare humans of this boring (but important) task. This makes it ideal for projects that want to enforce a coding standard.</p>
</blockquote>
<p><code>app/build.gradle</code></p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'checkstyle'</span></span><br><span class="line"></span><br><span class="line">task checkstyle(<span class="string">type:</span> Checkstyle) &#123;</span><br><span class="line">    description <span class="string">'Check code standard'</span></span><br><span class="line">    group <span class="string">'verification'</span></span><br><span class="line"></span><br><span class="line">    configFile file(<span class="string">'$project.rootDir/tools/checkstyle.xml'</span>)</span><br><span class="line">    source <span class="string">'src'</span></span><br><span class="line">    include <span class="string">'**/*.kt'</span></span><br><span class="line">    exclude <span class="string">'**/gen/**'</span></span><br><span class="line"></span><br><span class="line">    classpath = files()</span><br><span class="line">    ignoreFailures = <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/chekcstyle</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span><span class="meta">&lt;!DOCTYPE module PUBLIC</span></span><br><span class="line"><span class="meta">        "-//Puppy Crawl//DTD Check Configuration 1.2//EN"</span></span><br><span class="line"><span class="meta">        "http://www.puppycrawl.com/dtds/configuration_1_2.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"Checker"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"FileTabCharacter"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"TreeWalker"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Checks for Naming Conventions                            --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- See http://checkstyle.sourceforge.net/config_naming.html --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"MethodName"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"ConstantName"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Checks for Imports                                 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- See http://checkstyle.sourceforge.net/config_imports.html--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"AvoidStarImport"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"UnusedImports"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- Checks for Size                                          --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- See http://checkstyle.sourceforge.net/config_sizes       --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">module</span> <span class="attr">name</span>=<span class="string">"ParameterNumber"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"max"</span> <span class="attr">value</span>=<span class="string">"6"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- other rules ignored for brevity --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">module</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="findbugs-Java"><a href="#findbugs-Java" class="headerlink" title="findbugs (Java)"></a>findbugs (Java)</h2><ul>
<li><a href="http://findbugs.sourceforge.net/">http://findbugs.sourceforge.net/</a></li>
</ul>
<blockquote>
<p>A program which uses static analysis to look for bugs in Java code</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'findbugs'</span></span><br><span class="line"></span><br><span class="line">task findbugs(<span class="string">type:</span> FindBugs) &#123;</span><br><span class="line">    ignoreFailures = <span class="literal">false</span></span><br><span class="line">    effort = <span class="string">"max"</span></span><br><span class="line">    reportLevel = <span class="string">"low"</span></span><br><span class="line">    classes = files(<span class="string">"$project.buildDir/intermediates/javac"</span>)</span><br><span class="line"></span><br><span class="line">    excludeFilter = file(<span class="string">"$rootProject.rootDir/tools/findbugs-exclude.xml"</span>)</span><br><span class="line"></span><br><span class="line">    source = fileTree(<span class="string">'src/main/java/'</span>)</span><br><span class="line">    classpath = files()</span><br><span class="line"></span><br><span class="line">    reports &#123;</span><br><span class="line">        xml.enabled = <span class="literal">false</span></span><br><span class="line">        html.enabled = <span class="literal">true</span></span><br><span class="line">        html.destination file(<span class="string">"$project.buildDir/outputs/findbugs/findbugs-output.html"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/findbugs-exclude.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">FindBugsFilter</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Do not check auto-generated resources classes --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Class</span> <span class="attr">name</span>=<span class="string">"~.*R\$.*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Do not check auto-generated manifest classes --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Class</span> <span class="attr">name</span>=<span class="string">"~.*Manifest\$.*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Do not check auto-generated classes (Dagger puts $ into class names) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Class</span> <span class="attr">name</span>=<span class="string">"~.*Dagger*.*"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">    <span class="comment">&lt;!-- http://findbugs.sourceforge.net/bugDescriptions.html#ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">Match</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Bug</span> <span class="attr">pattern</span>=<span class="string">"ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Match</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">FindBugsFilter</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="pmd-Java"><a href="#pmd-Java" class="headerlink" title="pmd (Java)"></a>pmd (Java)</h2><ul>
<li><a href="https://github.com/pmd/pmd">https://github.com/pmd/pmd</a></li>
</ul>
<blockquote>
<p>PMD is a source code analyzer. It finds common programming flaws like unused variables, empty catch blocks, unnecessary object creation, and so forth</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">plugin:</span> <span class="string">'pmd'</span></span><br><span class="line"></span><br><span class="line">task pmd(<span class="string">type:</span> Pmd) &#123;</span><br><span class="line">    ruleSetFiles = files(<span class="string">"$&#123;project.rootDir&#125;/tools/pmd-rules.xml"</span>)</span><br><span class="line">    ignoreFailures = <span class="literal">false</span></span><br><span class="line">    ruleSets = []</span><br><span class="line"></span><br><span class="line">    source <span class="string">'src'</span></span><br><span class="line">    include <span class="string">'**/*.kt'</span></span><br><span class="line">    exclude <span class="string">'**/gen/**'</span></span><br><span class="line"></span><br><span class="line">    reports &#123;</span><br><span class="line">        xml.enabled = <span class="literal">false</span></span><br><span class="line">        html.enabled = <span class="literal">true</span></span><br><span class="line">        html.destination = file(<span class="string">"$project.buildDir/outputs/pmd/pmd.html"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/pmd-rules.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ruleset</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns</span>=<span class="string">"http://pmd.sourceforge.net/ruleset/2.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://pmd.sourceforge.net/ruleset/2.0.0 http://pmd.sourceforge.net/ruleset_2_0_0.xsd"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">exclude-pattern</span>&gt;</span>.*/R.java<span class="tag">&lt;/<span class="name">exclude-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclude-pattern</span>&gt;</span>.*/gen/.*<span class="tag">&lt;/<span class="name">exclude-pattern</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/basic.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/braces.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/strings.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/design.xml"</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclude</span> <span class="attr">name</span>=<span class="string">"AvoidDeeplyNestedIfStmts"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rule</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">rule</span> <span class="attr">ref</span>=<span class="string">"rulesets/java/unusedcode.xml"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ruleset</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="lint"><a href="#lint" class="headerlink" title="lint"></a>lint</h2><ul>
<li><a href="https://developer.android.com/studio/write/lint">https://developer.android.com/studio/write/lint</a></li>
</ul>
<blockquote>
<p>Android Studio provides a code scanning tool called lint that can help you to identify and correct problems with the structural quality of your code without your having to execute the app or write test cases</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  lintOptions &#123;</span><br><span class="line">        lintConfig file(<span class="string">"$project.rootDir/tools/lint-rules.xml"</span>)</span><br><span class="line">        htmlOutput file(<span class="string">"$project.buildDir/outputs/lint/lint.html"</span>)</span><br><span class="line">        warningsAsErrors <span class="literal">true</span></span><br><span class="line">        xmlReport <span class="literal">false</span></span><br><span class="line">        htmlReport <span class="literal">true</span></span><br><span class="line">        abortOnError <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/lint-rules.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">lint</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"GoogleAppIndexWarning"</span> <span class="attr">severity</span>=<span class="string">"ignore"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"InvalidPackage"</span> <span class="attr">severity</span>=<span class="string">"error"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ignore</span> <span class="attr">regexp</span>=<span class="string">"okio.*jar"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ignore</span> <span class="attr">regexp</span>=<span class="string">"retrofit.*jar"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">issue</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Disable the given check in this project --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"IconMissingDensityFolder"</span> <span class="attr">severity</span>=<span class="string">"ignore"</span> /&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!-- Change the severity of hardcoded strings to "error" --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">issue</span> <span class="attr">id</span>=<span class="string">"HardcodedText"</span> <span class="attr">severity</span>=<span class="string">"error"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">lint</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Strict-mode"><a href="#Strict-mode" class="headerlink" title="Strict mode"></a>Strict mode</h2><ul>
<li><a href="https://developer.android.com/reference/android/os/StrictMode">https://developer.android.com/reference/android/os/StrictMode</a></li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> android.app.Application</span><br><span class="line"><span class="keyword">import</span> android.os.StrictMode</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span>: <span class="type">Application</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate()</span><br><span class="line"></span><br><span class="line">        enableStrictMode()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">enableStrictMode</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (BuildConfig.DEBUG) &#123;</span><br><span class="line">            StrictMode.setThreadPolicy(</span><br><span class="line">                StrictMode.ThreadPolicy.Builder()</span><br><span class="line">                    .detectAll()</span><br><span class="line">                    .penaltyLog()</span><br><span class="line">                    .build()</span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">            StrictMode.setVmPolicy(</span><br><span class="line">                StrictMode.VmPolicy.Builder()</span><br><span class="line">                    .detectAll()</span><br><span class="line">                    .penaltyLog()</span><br><span class="line">                    .build()</span><br><span class="line">            )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Version-code"><a href="#Version-code" class="headerlink" title="Version code"></a>Version code</h2><p>tools/grgit.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'org.ajoberstar:grgit:1.5.0'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.ajoberstar.grgit.Grgit</span><br><span class="line"></span><br><span class="line">ext &#123;</span><br><span class="line">    git = Grgit.open(<span class="string">currentDir:</span> projectDir)</span><br><span class="line">    gitCommitCount = git.log().size()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task printVersion() &#123;</span><br><span class="line">    println(<span class="string">"Commit count: $gitCommitCount"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        versionCode gitCommitCount</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Obfuscation"><a href="#Obfuscation" class="headerlink" title="Obfuscation"></a>Obfuscation</h2><ul>
<li><a href="https://developer.android.com/studio/build/shrink-code">https://developer.android.com/studio/build/shrink-code</a></li>
</ul>
<blockquote>
<p>To make your app as small as possible, you should enable shrinking in your release build to remove unused code and resources. When enabling shrinking, you also benefit from obfuscation, which shortens the names of your app‚Äôs classes and members, and optimization, which applies more aggressive strategies to further reduce the size of your app</p>
</blockquote>
<blockquote>
<p>When you use Android Studio 3.4 or Android Gradle plugin 3.4.0 and higher, R8 is the default compiler that converts your project‚Äôs Java bytecode into the DEX format that runs on the Android platform</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  buildTypes &#123;</span><br><span class="line">        debug &#123;</span><br><span class="line">            signingConfig signingConfigs.debug</span><br><span class="line">            minifyEnabled <span class="literal">true</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android-optimize.txt'</span>), <span class="string">'$project.rootDir/tools/proguard-rules-debug.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        release &#123;</span><br><span class="line">            signingConfig signingConfigs.release</span><br><span class="line">            minifyEnabled <span class="literal">true</span></span><br><span class="line">            shrinkResources <span class="literal">true</span></span><br><span class="line">            proguardFiles getDefaultProguardFile(<span class="string">'proguard-android-optimize.txt'</span>), <span class="string">'$project.rootDir/tools/proguard-rules.pro'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/proguard-rules.pro</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">-ignorewarnings</span><br><span class="line"></span><br><span class="line"># Remove logs</span><br><span class="line">-assumenosideeffects class android.util.Log &#123;</span><br><span class="line">    public static boolean isLoggable(java.lang.String, int);</span><br><span class="line">    public static int v(...);</span><br><span class="line">    public static int i(...);</span><br><span class="line">    public static int w(...);</span><br><span class="line">    public static int d(...);</span><br><span class="line">    public static int e(...);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/proguard-rules-debug.pro</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-ignorewarnings</span><br><span class="line">-dontobfuscate</span><br><span class="line">-dontoptimize</span><br><span class="line">-ignorewarnings</span><br></pre></td></tr></table></figure>

<p>More proguard snippets <a href="https://github.com/krschultz/android-proguard-snippets">https://github.com/krschultz/android-proguard-snippets</a></p>
<h2 id="quality"><a href="#quality" class="headerlink" title="quality"></a>quality</h2><p>tools/quality.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">task findbugs</span><br><span class="line">task pmd</span><br><span class="line">task checkstyle</span><br></pre></td></tr></table></figure>

<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">from:</span> <span class="string">"$project.rootDir/tools/quality.gradle"</span></span><br></pre></td></tr></table></figure>

<h2 id="File-format"><a href="#File-format" class="headerlink" title="File format"></a>File format</h2><ul>
<li><a href="https://twitter.com/kotlin/status/1067825173196414976?lang=en">https://twitter.com/kotlin/status/1067825173196414976?lang=en</a></li>
</ul>
<blockquote>
<p>You don‚Äôt need to use ktlint or detekt to ensure that your code is formatted consistently. Simply enable ‚ÄúFile is not formatted according to project settings‚Äù in the inspection settings.</p>
</blockquote>
<h2 id="ktlint-Kotlin"><a href="#ktlint-Kotlin" class="headerlink" title="ktlint (Kotlin)"></a>ktlint (Kotlin)</h2><ul>
<li><a href="https://github.com/pinterest/ktlint">https://github.com/pinterest/ktlint</a></li>
</ul>
<blockquote>
<p>An anti-bikeshedding Kotlin linter with built-in formatter</p>
</blockquote>
<p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply <span class="string">from:</span> <span class="string">"$project.rootDir/tools/ktlint.gradle"</span></span><br></pre></td></tr></table></figure>

<p>tools/ktlint.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">    jcenter()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configurations &#123;</span><br><span class="line">    ktlint</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    ktlint <span class="string">"com.pinterest:ktlint:0.32.0"</span></span><br><span class="line">    <span class="comment">// additional 3rd party ruleset(s) can be specified here</span></span><br><span class="line">    <span class="comment">// just add them to the classpath (e.g. ktlint 'groupId:artifactId:version') and</span></span><br><span class="line">    <span class="comment">// ktlint will pick them up</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task ktlint(<span class="string">type:</span> JavaExec, <span class="string">group:</span> <span class="string">"verification"</span>) &#123;</span><br><span class="line">    description = <span class="string">"Check Kotlin code style."</span></span><br><span class="line">    classpath = configurations.ktlint</span><br><span class="line">    main = <span class="string">"com.pinterest.ktlint.Main"</span></span><br><span class="line">    args <span class="string">"src/**/*.kt"</span>, <span class="string">"--reporter=checkstyle, output=$&#123;buildDir&#125;/outputs/ktlint.xml"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">task ktlintFormat(<span class="string">type:</span> JavaExec, <span class="string">group:</span> <span class="string">"formatting"</span>) &#123;</span><br><span class="line">    description = <span class="string">"Fix Kotlin code style deviations."</span></span><br><span class="line">    classpath = configurations.ktlint</span><br><span class="line">    main = <span class="string">"com.pinterest.ktlint.Main"</span></span><br><span class="line">    args <span class="string">"-F"</span>, <span class="string">"src/**/*.kt"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>.editorconfig</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[*.&#123;kt,kts&#125;]</span><br><span class="line">indent_size&#x3D;4</span><br></pre></td></tr></table></figure>

<h2 id="detekt-Kotlin"><a href="#detekt-Kotlin" class="headerlink" title="detekt (Kotlin)"></a>detekt (Kotlin)</h2><ul>
<li><a href="https://github.com/arturbosch/detekt">https://github.com/arturbosch/detekt</a></li>
</ul>
<blockquote>
<p>Static code analysis for Kotlin</p>
</blockquote>
<p>build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;&#125;</span><br><span class="line"></span><br><span class="line">plugins &#123;</span><br><span class="line">    id <span class="string">"io.gitlab.arturbosch.detekt"</span> version <span class="string">"1.0.0-RC14"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>tools/detekt.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">detekt &#123;</span><br><span class="line">    toolVersion = <span class="string">"1.0.0-RC14"</span></span><br><span class="line">    input = files(<span class="string">"src/main"</span>)</span><br><span class="line">    filters = <span class="string">".*/resources/.*,.*/build/.*"</span></span><br><span class="line">    baseline = file(<span class="string">"$&#123;project.rootDir&#125;/tools/detekt-baseline.xml"</span>)</span><br><span class="line">    config = files(file(<span class="string">"$project.rootDir/tools/detekt.yml"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>tools/detekt.xml </p>
<ul>
<li><a href="https://github.com/arturbosch/detekt/blob/master/docs/pages/baseline.md">https://github.com/arturbosch/detekt/blob/master/docs/pages/baseline.md</a></li>
</ul>
<blockquote>
<p>The intention of a whitelist is that only new code smells are printed on further analysis. The blacklist can be used to write down false positive detections (instead of suppressing them and polute your code base).</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">SmellBaseline</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Blacklist</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>CatchRuntimeException:Junk.kt$e: RuntimeException<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Blacklist</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Whitelist</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>NestedBlockDepth:Indentation.kt$Indentation$override fun procedure(node: ASTNode)<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>TooManyFunctions:LargeClass.kt$io.gitlab.arturbosch.detekt.rules.complexity.LargeClass.kt<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ID</span>&gt;</span>ComplexMethod:DetektExtension.kt$DetektExtension$fun convertToArguments(): MutableList&amp;lt;String&amp;gt;<span class="tag">&lt;/<span class="name">ID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Whitelist</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">SmellBaseline</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>tools/detekt.yml </p>
<ul>
<li><a href="https://github.com/arturbosch/detekt/blob/master/detekt-cli/src/main/resources/default-detekt-config.yml">https://github.com/arturbosch/detekt/blob/master/detekt-cli/src/main/resources/default-detekt-config.yml</a></li>
<li><a href="https://arturbosch.github.io/detekt/configurations.html">https://arturbosch.github.io/detekt/configurations.html</a></li>
</ul>
<blockquote>
<p>detekt uses a yaml style configuration file for various things:</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">autoCorrect:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">build:</span></span><br><span class="line"><span class="attr">  maxIssues:</span> <span class="number">10</span></span><br><span class="line"><span class="attr">  weights:</span></span><br><span class="line">    <span class="comment"># complexity: 2</span></span><br><span class="line">    <span class="comment"># LongParameterList: 1</span></span><br><span class="line">    <span class="comment"># style: 1</span></span><br><span class="line">    <span class="comment"># comments: 1</span></span><br></pre></td></tr></table></figure>

<p>Run</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;gradlew detekt</span><br></pre></td></tr></table></figure>

<h2 id="check"><a href="#check" class="headerlink" title="check"></a>check</h2><p>app/build.gradle</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">check.dependsOn <span class="string">'checkstyle'</span>, <span class="string">'findbugs'</span>, <span class="string">'pmd'</span>, <span class="string">'lint'</span>, <span class="string">'ktlint'</span>, <span class="string">'detekt'</span></span><br></pre></td></tr></table></figure>

<p>Run</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;gradlew check</span><br></pre></td></tr></table></figure>

<h2 id="Gradle-Kotlin-DSL"><a href="#Gradle-Kotlin-DSL" class="headerlink" title="Gradle Kotlin DSL"></a>Gradle Kotlin DSL</h2><ul>
<li>How to use Gradle Kotlin DSL in Android <a href="https://github.com/onmyway133/blog/issues/285">https://github.com/onmyway133/blog/issues/285</a></li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul>
<li><a href="https://proandroiddev.com/configuring-android-project-little-things-that-matter-d6a9d34c1ce0">Configuring Android Project‚Ää‚Äî‚ÄäLittle Things That Matter</a></li>
<li><a href="https://code.tutsplus.com/tutorials/ensure-high-quality-android-code-with-static-analysis-tools--cms-28787">Ensure High-Quality Android Code With Static Analysis Tools</a></li>
<li><a href="https://proandroiddev.com/kotlin-static-analysis-why-and-how-a12042e34a98">Kotlin Static Analysis‚Ää‚Äî‚Ääwhy and how?</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-23T05:48:09.000Z" title="2019-05-23T05:48:09.000Z">2019-05-23</time><span class="level-item">21 minutes read (About 3191 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-structure-your-project-and-manage-static-resources-in-React-Native/">How to structure your project and manage static resources in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/256">#256</a></strong></p>
<p>Original post <a href="https://medium.freecodecamp.org/how-to-structure-your-project-and-manage-static-resources-in-react-native-6f4cfc947d92">https://medium.freecodecamp.org/how-to-structure-your-project-and-manage-static-resources-in-react-native-6f4cfc947d92</a></p>
<hr>
<p>React and React Native are just frameworks, and they do not dictate how we should structure our projects. It all depends on your personal taste and the project you‚Äôre working on.</p>
<p>In this post, we will go through how to structure a project and how to manage local assets. This of course is not written in stone, and you are free to apply only the pieces that suit you. Hope you learn something.</p>
<p>For a project bootstrapped with <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3">react-native init</a> , we get only the <a href="https://medium.com/fantageek/what-is-create-react-native-app-9f3bc5a6c2a3">basic structure</a>.</p>
<p>There is the ios folder for Xcode projects, the android folder for Android projects, and an index.js and an App.js file for the React Native starting point.</p>
<pre><code>ios/
android/
index.js
App.js</code></pre><p>As someone who has worked with native on both Windows Phone, iOS and Android, I find that structuring a project all comes down to separating files by <strong>type</strong> or <strong>feature</strong></p>
<h2 id="type-vs-feature"><a href="#type-vs-feature" class="headerlink" title="type vs feature"></a>type vs feature</h2><p>Separating by type means that we organise files by their type. If it is a component, there are container and presentational files. If it is Redux, there are action, reducer, and store files. If it is view, there are JavaScript, HTML, and CSS files.</p>
<h3 id="Group-by-type"><a href="#Group-by-type" class="headerlink" title="Group by type"></a>Group by type</h3><pre><code>redux
  actions
  store
  reducers
components
  container
  presentational
view
  javascript
  html
  css</code></pre><p>This way, we can see the type of each file, and easily run a script toward a certain file type. This is general for all projects, but it does not answer the question ‚Äúwhat is this project about?‚Äù Is it news application? Is it a loyalty app? Is it about nutrition tracking?</p>
<p>Organising files by type is for a machine, not for a human. Many times we work on a feature, and finding files to fix in multiple directories is a hassle. It‚Äôs also a pain if we plan to make a framework out of our project, as files are spread across many places.</p>
<h3 id="Group-by-feature"><a href="#Group-by-feature" class="headerlink" title="Group by feature"></a>Group by feature</h3><p>A more reasonable solution is to organise files by feature. Files related to a feature should be placed together. And <a href="https://medium.com/@JeffLombardJr/organizing-tests-in-jest-17fc431ff850">test files</a> should stay close to the source files. Check out <a href="https://medium.com/@JeffLombardJr/organizing-tests-in-jest-17fc431ff850">this article</a> to learn more.</p>
<p>A feature can be related to login, sign up, onboarding, or a user‚Äôs profile. A feature can contain sub-features as long as they belong to the same flow. If we wanted to move the sub feature around, it would be easy, as all related files are already grouped together.</p>
<p>My typical project structure based on features looks like this:</p>
<pre><code>index.js
App.js
ios/
android/
src
  screens
    login
      LoginScreen.js
      LoginNavigator.js
    onboarding
      OnboardingNavigator    
      welcome 
        WelcomeScreen.js
      term
        TermScreen.js
      notification
        NotificationScreen.js
    main
      MainNavigator.js
      news
        NewsScreen.js
      profile
        ProfileScreen.js
      search
        SearchScreen.js
  library
    package.json
    components
      ImageButton.js
      RoundImage.js
    utils
      moveToBottom.js
      safeArea.js
    networking
      API.js
      Auth.js
  res
    package.json
    strings.js
    colors.js
    palette.js
    fonts.js
    images.js
    images
      logo@2x.png
      logo@3x.png
      button@2x.png
      button@3x.png
scripts
  images.js
  clear.js</code></pre><p>Besides the traditional files App.js and index.js and the ios1 and android folders, I put all the source files inside the src folder. Inside src I have res for resources, library for common files used across features, and screens for a screen of content.</p>
<h3 id="As-few-dependencies-as-possible"><a href="#As-few-dependencies-as-possible" class="headerlink" title="As few dependencies as possible"></a>As few dependencies as possible</h3><p>Since React Native is heavily dependent on tons of dependencies, I try to be pretty aware when adding more. In my project I use just react-navigation for navigation. And I‚Äôm not a fan of redux as it adds unneeded complexity. Only add a dependency when you really need it, otherwise you are just setting yourself up for more trouble than value.</p>
<p>The thing I like about React is the components. A component is where we define view, style and behavior. React has inline style ‚Äî it‚Äôs like using JavaScript to define script, HTML and CSS. This fits the feature approach we are aiming for. That‚Äôs why I don‚Äôt use <a href="https://github.com/styled-components/styled-components">styled-components</a>. Since styles are just JavaScript objects, we can just share comment styles in library .</p>
<h2 id="src"><a href="#src" class="headerlink" title="src"></a>src</h2><p>I like Android a lot, so I name src and res to match its folder conventions.</p>
<p>react-native init sets up babel for us. But for a typical JavaScript project, it‚Äôs good to organise files in the src folder. In my electron.js application <a href="https://github.com/onmyway133/IconGenerator/tree/master/src">IconGenerator</a>, I put the source files inside the src folder. This not only helps in terms of organising, but also helps babel transpile the entire folder at once. Just a command and I have the files in src transpiled to dist in a blink.</p>
<pre><code>babel ./src --out-dir ./dist --copy-files</code></pre><h2 id="Screen"><a href="#Screen" class="headerlink" title="Screen"></a>Screen</h2><p>React is based around components. Yup. There are <a href="https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0">container and presentational components</a>, but we can compose components to build more complex components. They usually end in showing in the full screen. It is called Page in Windows Phone, ViewController in iOS and Activity in Android. The React Native guide mentions <a href="https://facebook.github.io/react-native/docs/navigation">screen</a> very often as something that covers the entire space:</p>
<blockquote>
<h1 id="Mobile-apps-are-rarely-made-up-of-a-single-screen-Managing-the-presentation-of-and-transition-between-multiple-screens-is-typically-handled-by-what-is-known-as-a-navigator"><a href="#Mobile-apps-are-rarely-made-up-of-a-single-screen-Managing-the-presentation-of-and-transition-between-multiple-screens-is-typically-handled-by-what-is-known-as-a-navigator" class="headerlink" title="Mobile apps are rarely made up of a single screen. Managing the presentation of, and transition between, multiple screens is typically handled by what is known as a navigator."></a>Mobile apps are rarely made up of a single screen. Managing the presentation of, and transition between, multiple screens is typically handled by what is known as a navigator.</h1></blockquote>
<h3 id="index-js-or-not"><a href="#index-js-or-not" class="headerlink" title="index.js or not?"></a>index.js or not?</h3><p>Each screen is considered the entry point for each feature. You can rename the LoginScreen.js to index.js by leveraging the Node <a href="https://medium.freecodecamp.org/requiring-modules-in-node-js-everything-you-need-to-know-e7fbd119be8">module</a> feature:</p>
<blockquote>
<p>Modules don‚Äôt have to be files. We can also create a find-me folder under node_modules and place an index.js file in there. The same require(‚Äòfind-me‚Äô) line will use that folder‚Äôs index.js file</p>
</blockquote>
<p>So instead of import LoginScreen from ‚Äò./screens/LoginScreen‚Äô , we can just do import LoginScreen from ‚Äò./screens‚Äô.</p>
<p>Using index.js results in encapsulation and provides a public interface for the feature. This is all personal taste. I myself prefer explicit naming for a file, hence the name LoginScreen.js.</p>
<h2 id="Navigator"><a href="#Navigator" class="headerlink" title="Navigator"></a>Navigator</h2><p><a href="https://github.com/react-navigation/react-navigation">react-navigation</a> seems to be the most popular choice for handling navigation in a React Native app. For a feature like onboarding, there are probably many screens managed by a stack navigation, so there is OnboardingNavigator .</p>
<p>You can think of Navigator as something that groups sub screens or features. Since we group by feature, it‚Äôs reasonable to place Navigator inside the feature folder. It basically looks like this:</p>
<pre><code>import { createStackNavigator } from &apos;react-navigation&apos;
import Welcome from &apos;./Welcome&apos;
import Term from &apos;./Term&apos;

const routeConfig = {
  Welcome: {
    screen: Welcome
  },
  Term: {
    screen: Term
  }
}

const navigatorConfig = {
  navigationOptions: {
    header: null
  }
}

export default OnboardingNavigator = createStackNavigator(routeConfig, navigatorConfig)</code></pre><h2 id="library"><a href="#library" class="headerlink" title="library"></a>library</h2><p>This is the most controversial part of structuring a project. If you don‚Äôt like the name library, you can name it utilities, common, citadel , whatever‚Ä¶</p>
<p>This is not meant for homeless files, but it is where we place common utilities and components that are used by many features. Things like atomic components, wrappers, quick fixes function, networking stuff, and login info are used a lot, and it‚Äôs hard to move them to a specific feature folder. Sometimes we just need to be practical and get the work done.</p>
<p>In React Native, we often need to implement a button with an image background in many screens. Here is a simple one that stays inside library/components/ImageButton.js . The components folder is for reusable components, sometimes called <a href="https://medium.com/joeydinardo/a-brief-look-at-atomic-components-39cbe71d38b5">atomic components</a>. According to React naming conventions, the first letter should be uppercase.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; TouchableOpacity, View, Image, Text, StyleSheet &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"><span class="keyword">import</span> images <span class="keyword">from</span> <span class="string">'res/images'</span></span><br><span class="line"><span class="keyword">import</span> colors <span class="keyword">from</span> <span class="string">'res/colors'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;TouchableOpacity style=&#123;styles.touchable&#125; onPress=&#123;<span class="keyword">this</span>.props.onPress&#125;&gt;</span><br><span class="line">                &lt;View style=&#123;styles.view&#125;&gt;</span><br><span class="line">                    &lt;Text style=&#123;styles.text&#125;&gt;&#123;<span class="keyword">this</span>.props.title&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">                &lt;/</span>View&gt;</span><br><span class="line">                &lt;Image</span><br><span class="line">                    source=&#123;images.button&#125;</span><br><span class="line">                    style=&#123;styles.image&#125; /&gt;</span><br><span class="line">            &lt;<span class="regexp">/TouchableOpacity&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">    view: &#123;</span></span><br><span class="line"><span class="regexp">        position: 'absolute',</span></span><br><span class="line"><span class="regexp">        backgroundColor: 'transparent'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    image: &#123;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    touchable: &#123;</span></span><br><span class="line"><span class="regexp">        alignItems: 'center',</span></span><br><span class="line"><span class="regexp">        justifyContent: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    text: &#123;</span></span><br><span class="line"><span class="regexp">        color: colors.button,</span></span><br><span class="line"><span class="regexp">        fontSize: 18,</span></span><br><span class="line"><span class="regexp">        textAlign: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<p>And if we want to place the button at the bottom, we use a utility function to prevent code duplication. Here is library/utils/moveToBottom.js:</p>
<pre><code>import React from &apos;react&apos;
import { View, StyleSheet } from &apos;react-native&apos;

function moveToBottom(component) {
  return (
    &lt;View style={styles.container}&gt;
      {component}
    &lt;/View&gt;
  )
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    justifyContent: &apos;flex-end&apos;,
    marginBottom: 36
  }
})

export default moveToBottom</code></pre><h3 id="Use-package-json-to-avoid-relative-path"><a href="#Use-package-json-to-avoid-relative-path" class="headerlink" title="Use package.json to avoid relative path"></a>Use package.json to avoid relative path</h3><p>Then somewhere in the src/screens/onboarding/term/Term.js , we can import by using relative paths:</p>
<pre><code>import moveToBottom from &apos;../../../../library/utils/move&apos;
import ImageButton from &apos;../../../../library/components/ImageButton&apos;</code></pre><p>This is a big red flag in my eyes. It‚Äôs error prone, as we need to calculate how many .. we need to perform. And if we move feature around, all of the paths need to be recalculated.</p>
<p>Since library is meant to be used many places, it‚Äôs good to reference it as an absolute path. In JavaScript there are usually 1000 libraries to a single problem. A quick search on Google reveals tons of libraries to tackle this issue. But we don‚Äôt need another dependency as this is extremely easy to fix.</p>
<p>The solution is to turn library into a module so node can find it. Adding package.json to any folder makes it into a Node module . Add package.json inside the library folder with this simple content:</p>
<pre><code>{
  &quot;name&quot;: &quot;library&quot;,
  &quot;version&quot;: &quot;0.0.1&quot;
}</code></pre><p>Now in Term.js we can easily import things from library because it is now a module:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, StyleSheet, Image, Text, Button &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"><span class="keyword">import</span> strings <span class="keyword">from</span> <span class="string">'res/strings'</span></span><br><span class="line"><span class="keyword">import</span> palette <span class="keyword">from</span> <span class="string">'res/palette'</span></span><br><span class="line"><span class="keyword">import</span> images <span class="keyword">from</span> <span class="string">'res/images'</span></span><br><span class="line"><span class="keyword">import</span> ImageButton <span class="keyword">from</span> <span class="string">'library/components/ImageButton'</span></span><br><span class="line"><span class="keyword">import</span> moveToBottom <span class="keyword">from</span> <span class="string">'library/utils/moveToBottom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Term</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">                &lt;Text style=&#123;styles.heading&#125;&gt;&#123;strings.onboarding.term.heading.toUpperCase()&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">                &#123;</span></span><br><span class="line"><span class="regexp">                    moveToBottom(</span></span><br><span class="line"><span class="regexp">                        &lt;ImageButton style=&#123;styles.button&#125; title=&#123;strings.onboarding.term.button.toUpperCase()&#125; /</span>&gt;</span><br><span class="line">                    )</span><br><span class="line">                &#125;</span><br><span class="line">            &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">        )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">    container: &#123;</span></span><br><span class="line"><span class="regexp">        flex: 1,</span></span><br><span class="line"><span class="regexp">        alignItems: 'center'</span></span><br><span class="line"><span class="regexp">    &#125;,</span></span><br><span class="line"><span class="regexp">    heading: &#123;</span></span><br><span class="line"><span class="regexp">        ...palette.heading, ...&#123;</span></span><br><span class="line"><span class="regexp">            marginTop: 72</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

<h2 id="res"><a href="#res" class="headerlink" title="res"></a>res</h2><p>You may wonder what res/colors, res/strings , res/images and res/fonts are in the above examples. Well, for front end projects, we usually have components and style them using fonts, localised strings, colors, images and styles. JavaScript is a very dynamic language, and it‚Äôs easy to use stringly types everywhere. We could have a bunch of #00B75D color across many files, or Fira as a fontFamily in many Text components. This is error-prone and hard to refactor.</p>
<p>Let‚Äôs encapsulate resource usage inside the res folder with safer objects. They look like the examples below:</p>
<p><strong>res/colors</strong></p>
<pre><code>const colors = {
  title: &apos;#00B75D&apos;,
  text: &apos;#0C222B&apos;,
  button: &apos;#036675&apos;
}

export default colors</code></pre><p><strong>res/strings</strong></p>
<pre><code>const strings = {
  onboarding: {
    welcome: {
      heading: &apos;Welcome&apos;,
      text1: &quot;What you don&apos;t know is what you haven&apos;t learn&quot;,
      text2: &apos;Visit my GitHub at [https://github.com/onmyway133&apos;](https://github.com/onmyway133&apos;),
      button: &apos;Log in&apos;
    },
    term: {
      heading: &apos;Terms and conditions&apos;,
      button: &apos;Read&apos;
    }
  }
}

export default strings</code></pre><p><strong>res/fonts</strong></p>
<pre><code>const fonts = {
  title: &apos;Arial&apos;,
  text: &apos;SanFrancisco&apos;,
  code: &apos;Fira&apos;
}

export default fonts</code></pre><p><strong>res/images</strong></p>
<pre><code>const images = {
  button: require(&apos;./images/button.png&apos;),
  logo: require(&apos;./images/logo.png&apos;),
  placeholder: require(&apos;./images/placeholder.png&apos;)
}

export default images</code></pre><p>Like library , res files can be access from anywhere, so let‚Äôs make it a module . Add package.json to the res folder:</p>
<pre><code>{
  &quot;name&quot;: &quot;res&quot;,
  &quot;version&quot;: &quot;0.0.1&quot;
}</code></pre><p>so we can access resource files like normal modules:</p>
<pre><code>import strings from &apos;res/strings&apos;
import palette from &apos;res/palette&apos;
import images from &apos;res/images&apos;</code></pre><h3 id="Group-colors-images-fonts-with-palette"><a href="#Group-colors-images-fonts-with-palette" class="headerlink" title="Group colors, images, fonts with palette"></a>Group colors, images, fonts with palette</h3><p>The design of the app should be consistent. Certain elements should have the same look and feel so they don‚Äôt confuse the user. For example, the heading Text should use one color, font, and font size. The Image component should use the same placeholder image. In React Native, we already use the name styles with const styles = StyleSheet.create({}) so let‚Äôs use the name palette.</p>
<p>Below is my simple palette. It defines common styles for heading and Text:</p>
<h3 id="res-palette"><a href="#res-palette" class="headerlink" title="res/palette"></a>res/palette</h3><pre><code>import colors from &apos;./colors&apos;

const palette = {
  heading: {
    color: colors.title,
    fontSize: 20,
    textAlign: &apos;center&apos;
  },
  text: {
    color: colors.text,
    fontSize: 17,
    textAlign: &apos;center&apos;
  }
}

export default palette</code></pre><p>And then we can use them in our screen:</p>
<pre><code>const styles = StyleSheet.create({
  container: {
    flex: 1,
    alignItems: &apos;center&apos;
  },
  heading: {...palette.heading, ...{
    marginTop: 72
  }}
})</code></pre><p>Here we use the <a href="https://github.com/tc39/proposal-object-rest-spread">object spread operator</a> to merge palette.heading and our custom style object. This means that we use the styles from palette.heading but also specify more properties.</p>
<p>If we were to reskin the app for multiple brands, we could have multiple palettes. This is a really powerful pattern.</p>
<h3 id="Generate-images"><a href="#Generate-images" class="headerlink" title="Generate images"></a>Generate images</h3><p>You can see that in /src/res/images.js we have properties for each image in the src/res/images folder:</p>
<pre><code>const images = {
  button: require(&apos;./images/button.png&apos;),
  logo: require(&apos;./images/logo.png&apos;),
  placeholder: require(&apos;./images/placeholder.png&apos;)
}

export default images</code></pre><p>This is tedious to do manually, and we have to update if there‚Äôs changes in image naming convention. Instead, we can add a script to generate the images.js based on the images we have. Add a file at the root of the project /scripts/images.js:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> imageFileNames = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> array = fs</span><br><span class="line">        .readdirSync(<span class="string">'src/res/images'</span>)</span><br><span class="line">        .filter(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.endsWith(<span class="string">'.png'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">        .map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.replace(<span class="string">'[@2x](http://twitter.com/2x).png'</span>, <span class="string">''</span>).replace(<span class="string">'[@3x](http://twitter.com/3x).png'</span>, <span class="string">''</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(array))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> properties = imageFileNames()</span><br><span class="line">        .map(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;name&#125;</span>: require('./images/<span class="subst">$&#123;name&#125;</span>.png')`</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">',\n  '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> string = <span class="string">`const images = &#123;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;properties&#125;</span></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    export default images</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(<span class="string">'src/res/images.js'</span>, string, <span class="string">'utf8'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generate()</span><br></pre></td></tr></table></figure>

<p>The cool thing about Node is that we have access to the fs module, which is really good at file processing. Here we simply traverse through images, and update /src/res/images.js accordingly.</p>
<p>Whenever we add or change images, we can run:</p>
<pre><code>node scripts/images.js</code></pre><p>And we can also declare the script inside our main package.json :</p>
<pre><code>&quot;scripts&quot;: {
  &quot;start&quot;: &quot;node node_modules/react-native/local-cli/cli.js start&quot;,
  &quot;test&quot;: &quot;jest&quot;,
  &quot;lint&quot;: &quot;eslint *.js **/*.js&quot;,
  &quot;images&quot;: &quot;node scripts/images.js&quot;
}</code></pre><p>Now we can just run npm run images and we get an up-to-date images.js resource file.</p>
<h3 id="How-about-custom-fonts"><a href="#How-about-custom-fonts" class="headerlink" title="How about custom fonts"></a>How about custom fonts</h3><p>React Native has some <a href="https://medium.com/react-native-training/list-of-available-react-native-fonts-ed78b48bd45e">custom fonts</a> that may be good enough for your projects. You can also use custom fonts.</p>
<p>One thing to note is that Android uses the name of the font file, but iOS uses the full name. You can see the full name in Font Book app, or by inspecting in running app</p>
<pre><code>for (NSString* family in [UIFont familyNames]) {
  NSLog(@&quot;%@&quot;, family);

for (NSString* name in [UIFont fontNamesForFamilyName: family]) {
    NSLog(@&quot;Family name:  %@&quot;, name);
  }
}</code></pre><p>For custom fonts to be registered in iOS, we need to declare UIAppFonts in Info.plist using the file name of the fonts, and for Android, the fonts need to be placed at app/src/main/assets/fonts .</p>
<p>It is good practice to name the font file the same as full name. React Native is said to dynamically load custom fonts, but in case you get ‚ÄúUnrecognized font family‚Äù, then simply add those fonts to target within Xcode.</p>
<p>Doing this by hand takes time, luckily we have <a href="https://github.com/rnpm/rnpm">rnpm</a> that can help. First add all the fonts inside res/fonts folder. Then simply declare rnpm in package.json and run react-native link . This should declare UIAppFonts in iOS and move all the fonts into app/src/main/assets/fonts for Android.</p>
<pre><code>&quot;rnpm&quot;: {
  &quot;assets&quot;: [
    &quot;./src/res/fonts/&quot;
  ]
}</code></pre><p>Accessing fonts by name is error prone, we can create a script similar to what we have done with images to generate a safer accession. Add fonts.js to our scripts folder</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fontFileNames = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> array = fs</span><br><span class="line">        .readdirSync(<span class="string">'src/res/fonts'</span>)</span><br><span class="line">        .map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> file.replace(<span class="string">'.ttf'</span>, <span class="string">''</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(array))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> generate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> properties = fontFileNames()</span><br><span class="line">        .map(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> key = name.replace(<span class="regexp">/\s/g</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;key&#125;</span>: '<span class="subst">$&#123;name&#125;</span>'`</span></span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">',\n  '</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> string = <span class="string">`const fonts = &#123;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;properties&#125;</span></span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    export default fonts</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line"></span><br><span class="line">    fs.writeFileSync(<span class="string">'src/res/fonts.js'</span>, string, <span class="string">'utf8'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">generate()</span><br></pre></td></tr></table></figure>

<p>Now you can use custom font via R namespace.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> R <span class="keyword">from</span> <span class="string">'res/R'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">    text: &#123;</span><br><span class="line">        fontFamily: R.fonts.FireCodeNormal</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="The-R-namespace"><a href="#The-R-namespace" class="headerlink" title="The R namespace"></a>The R namespace</h2><p>This step depends on personal taste, but I find it more organised if we introduce the R namespace, just like how Android does for assets with the generated <a href="https://stackoverflow.com/questions/9408544/what-is-r-class-in-android/9408589">R class</a>.</p>
<blockquote>
<p>Once you externalize your app resources, you can access them using resource IDs that are generated in your project‚Äôs Rclass. This document shows you how to group your resources in your Android project and provide alternative resources for specific device configurations, and then access them from your app code or other XML files.</p>
</blockquote>
<p>This way, let‚Äôs make a file called R.js in src/res:</p>
<pre><code>import strings from &apos;./strings&apos;
import images from &apos;./images&apos;
import colors from &apos;./colors&apos;
import palette from &apos;./palette&apos;

const R = {
  strings,
  images,
  colors,
  palette
}

export default R</code></pre><p>And access it in the screen:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> R <span class="keyword">from</span> <span class="string">'res/R'</span></span><br><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;SafeAreaView style=&#123;styles.container&#125;&gt;</span><br><span class="line">      &lt;Image</span><br><span class="line">        style=&#123;styles.logo&#125;</span><br><span class="line">        source=&#123;R.images.logo&#125; /&gt;</span><br><span class="line">      &lt;Image</span><br><span class="line">        style=&#123;styles.image&#125;</span><br><span class="line">        source=&#123;R.images.placeholder&#125; /&gt;</span><br><span class="line">      &lt;Text style=&#123;styles.title&#125;&gt;&#123;R.strings.onboarding.welcome.title.toUpperCase()&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Replace strings with R.strings, colors with R.colors, and images with R.images. With the R annotation, it is clear that we are accessing static assets from the app bundle.</p>
<p>This also matches the Airbnb <a href="https://github.com/airbnb/javascript#naming--PascalCase-singleton">convention</a> for singleton, as our R is now like a global constant.</p>
<blockquote>
<p><a href="https://github.com/airbnb/javascript#naming--PascalCase-singleton">23.8</a> Use PascalCase when you export a constructor / class / singleton / function library / bare object.</p>
</blockquote>
<pre><code>const AirbnbStyleGuide = {
  es6: {
  },
}

export default AirbnbStyleGuide</code></pre><h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>In this post, I‚Äôve shown you how I think you should structure folders and files in a React Native project. We‚Äôve also learned how to manage resources and access them in a safer manner. I hope you‚Äôve found it useful. Here are some more resources to explore further:</p>
<ul>
<li><a href="https://medium.com/the-react-native-log/organizing-a-react-native-project-9514dfadaa0">Organizing a React Native Project</a></li>
<li><a href="https://hackernoon.com/structuring-projects-and-naming-components-in-react-1261b6e18d76">Structuring projects and naming components in React</a></li>
<li><a href="https://alligator.io/react/index-js-public-interfaces/">Using index.js for Fun and Public Interfaces</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-22T17:14:43.000Z" title="2019-05-22T17:14:43.000Z">2019-05-22</time><span class="level-item">a few seconds read (About 102 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-overlay-view-on-another-view-in-React-Native/">How to overlay view on another view in React Native</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/254">#254</a></strong></p>
<p>Original post <a href="https://stackoverflow.com/a/54108708/1418457">https://stackoverflow.com/a/54108708/1418457</a></p>
<hr>
<p>Make our own convenient OverlayContainer. The trick is to use <code>absolute</code> with <code>100%</code> size</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @flow</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, StyleSheet &#125; <span class="keyword">from</span> <span class="string">'react-native'</span></span><br><span class="line"></span><br><span class="line">type Props = &#123;</span><br><span class="line">  behind: React.Component,</span><br><span class="line">  front: React.Component,</span><br><span class="line">  under: React.Component</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Show something on top of other</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">OverlayContainer</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span>&lt;<span class="title">Props</span>&gt; </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; behind, front, under &#125; = <span class="keyword">this</span>.props</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">        &lt;View style=&#123;styles.center&#125;&gt;</span><br><span class="line">          &lt;View style=&#123;styles.behind&#125;&gt;</span><br><span class="line">            &#123;behind&#125;</span><br><span class="line">          &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">          &#123;front&#125;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>View&gt;</span><br><span class="line">        &#123;under&#125;</span><br><span class="line">      &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">  container: &#123;</span></span><br><span class="line"><span class="regexp">    flex: 1,</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    height: 100,</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  center: &#123;</span></span><br><span class="line"><span class="regexp">    width: '100%',</span></span><br><span class="line"><span class="regexp">    height: '100%',</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">  behind: &#123;</span></span><br><span class="line"><span class="regexp">    alignItems: 'center',</span></span><br><span class="line"><span class="regexp">    justifyContent: 'center',</span></span><br><span class="line"><span class="regexp">    position: 'absolute',</span></span><br><span class="line"><span class="regexp">    left: 0,</span></span><br><span class="line"><span class="regexp">    top: 0,</span></span><br><span class="line"><span class="regexp">    width: '100%',</span></span><br><span class="line"><span class="regexp">    height: '100%'</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;)</span></span><br></pre></td></tr></table></figure>

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T09:11:44.000Z" title="2019-05-21T09:11:44.000Z">2019-05-21</time><span class="level-item">6 minutes read (About 895 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-remove-Cartography-in-iOS/">How to remove Cartography in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/252">#252</a></strong></p>
<p>Read more <a href="https://medium.com/flawless-app-stories/how-to-make-auto-layout-more-convenient-in-ios-df3b42fed37f">https://medium.com/flawless-app-stories/how-to-make-auto-layout-more-convenient-in-ios-df3b42fed37f</a></p>
<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>This is a script to remove Cartography, and use plain NSLayoutAnchor syntax.<br>Use Constraint.on() from Sugar.<br>It will change all .swift files recursively under provided folder.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Constraint</span>.on(</span><br><span class="line">    logoImageView.widthAnchor.constraint(equalToConstant: <span class="number">74</span>),</span><br><span class="line">    view1.leftAnchor.constraint(equalTo: view2.leftAnchor, constant: <span class="number">20</span>),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h2 id="Features"><a href="#Features" class="headerlink" title="Features"></a>Features</h2><ul>
<li>Parse recursively</li>
<li>Parse a single file</li>
<li>Parse each constrain block separately</li>
<li>Handle ==, &gt;=, &lt;=</li>
<li>Handle center, edges</li>
<li>Infer indentation</li>
<li>Handle relation with other item</li>
<li>Handle relation with constant</li>
<li>Handle multiplier</li>
<li>Auto import Sugar</li>
<li>Infer superView</li>
</ul>
<h2 id="Prepare"><a href="#Prepare" class="headerlink" title="Prepare"></a>Prepare</h2><p>Install tool if needed</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install yarn</span><br></pre></td></tr></table></figure>

<p>How to use</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br><span class="line">yarn start &#x2F;Users&#x2F;khoa&#x2F;path&#x2F;to&#x2F;project</span><br></pre></td></tr></table></figure>

<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> Glob = <span class="built_in">require</span>(<span class="string">'glob'</span>)</span><br><span class="line"><span class="keyword">const</span> Fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> projectPath = getProjectPath()</span><br><span class="line">  <span class="keyword">const</span> files = getAllFiles(projectPath)</span><br><span class="line"></span><br><span class="line">  files.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">    handleFile(file)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// The 1st argument is node, 2nd is index.js, 3rd is path</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getProjectPath</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> process.argv[<span class="number">2</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Only select `swift` file</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getAllFiles</span>(<span class="params">projectPath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (projectPath.endsWith(<span class="string">'.swift'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> [projectPath]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> files = Glob.sync(<span class="string">`<span class="subst">$&#123;projectPath&#125;</span>/**/*.swift`</span>)</span><br><span class="line">    <span class="keyword">return</span> files</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Read file, replace by matches, and write again</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleFile</span>(<span class="params">file</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(file)</span><br><span class="line"></span><br><span class="line">  Fs.readFile(file, <span class="string">'utf8'</span>, (error, data) =&gt; &#123;</span><br><span class="line">    <span class="comment">// non greedy `*?`</span></span><br><span class="line">    <span class="keyword">const</span> pattern = <span class="string">'(.)*constrain\\(.+\\) &#123;\\s(\\s|.)*?\\n(\\s)*&#125;'</span></span><br><span class="line">    <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> matches = data.match(regex)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// RegEx only return the 1st match per execution, let's do a recursion</span></span><br><span class="line">    <span class="keyword">while</span> (matches != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> match = matches[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> indentationLength = findIndentationLength(match)</span><br><span class="line">      <span class="keyword">const</span> rawTransforms = handleMatch(match)</span><br><span class="line">      <span class="keyword">const</span> transforms = handleSuperview(rawTransforms, match)</span><br><span class="line">      <span class="keyword">const</span> statements = handleTransforms(transforms, indentationLength)</span><br><span class="line">      <span class="keyword">const</span> string = handleStatements(statements, indentationLength)</span><br><span class="line">      data = data.replace(match, string)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Examine again</span></span><br><span class="line">      matches = data.match(regex)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Handle import</span></span><br><span class="line">    data = handleImport(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Fs.writeFile(file, data, <span class="string">'utf8'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Replace or remove import</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleImport</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (data.includes(<span class="string">'import Sugar'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">'import Cartography'</span>, <span class="string">''</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">'import Cartography'</span>, <span class="string">'import Sugar'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Format transform to have `,` and linebreaks</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleTransforms</span>(<span class="params">transforms, indentationLength</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> string = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Expect the first is always line break</span></span><br><span class="line">  <span class="keyword">if</span> (transforms[<span class="number">0</span>] != <span class="string">'\n'</span>) &#123;</span><br><span class="line">    transforms.unshift(<span class="string">'\n'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> indentation = makeIndentation(indentationLength + <span class="number">2</span>)</span><br><span class="line">  </span><br><span class="line">  transforms.forEach(<span class="function">(<span class="params">line, index</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (line.length &gt; <span class="number">1</span>) &#123;</span><br><span class="line">      string = string.concat(indentation + line)</span><br><span class="line">      <span class="keyword">if</span> (index &lt; transforms.length - <span class="number">1</span>) &#123;</span><br><span class="line">        string = string.concat(<span class="string">',\n'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      string = string.concat(<span class="string">'\n'</span>)</span><br><span class="line">    &#125;    </span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Replace superView</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleSuperview</span>(<span class="params">transforms, match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> superView = findSuperview(match)</span><br><span class="line">  <span class="keyword">if</span> (superView == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> transforms</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> superViewPattern = <span class="string">' superView.'</span></span><br><span class="line">  transforms = transforms.map(<span class="function">(<span class="params">transform</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (transform.includes(superViewPattern)) &#123;</span><br><span class="line">      <span class="keyword">return</span> transform.replace(superViewPattern, <span class="string">` <span class="subst">$&#123;superView&#125;</span>.`</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> transform</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> transforms</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Embed the statements inside `Constraint.on`</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleStatements</span>(<span class="params">statements, indentationLength</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> indentation = makeIndentation(indentationLength)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;indentation&#125;</span>Constraint.on(<span class="subst">$&#123;statements&#125;</span>\n<span class="subst">$&#123;indentation&#125;</span>)`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Turn every line into flatten transformed line</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleMatch</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> lines = match.split(<span class="string">'\n'</span>)</span><br><span class="line">  lines = lines.map(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> handleLine(line.trim())</span><br><span class="line">  &#125;).filter(<span class="function">(<span class="params">transforms</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> transforms != <span class="literal">null</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> flatten = [].concat.apply([], lines)</span><br><span class="line">  <span class="keyword">return</span> flatten</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// Check to handle lines, turn them into `LayoutAnchor` statements</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleLine</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> itemPattern = <span class="string">'\\w*\\.\\w* (=|&lt;|&gt;)= \\w*\\.*\\..*'</span></span><br><span class="line">  <span class="keyword">const</span> sizePattern = <span class="string">'\w*\.\w* (=|&lt;|&gt;)= (\s|.)*'</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'edges == '</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleEdges(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'center == '</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleCenter(line) </span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasPattern(line, itemPattern) &amp;&amp; !hasSizeKeywords(line)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleItem(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hasPattern(line, sizePattern)) &#123;</span><br><span class="line">    <span class="keyword">return</span> handleSize(line)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&gt;='</span>) || line.includes(<span class="string">'&gt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'.'</span>)) &#123;</span><br><span class="line">    <span class="comment">// return the line itself to let the human fix</span></span><br><span class="line">    <span class="keyword">return</span> line</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.length == <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [<span class="string">'\n'</span>]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: listView.bottom == listView.superview!.bottom - 43</span></span><br><span class="line"><span class="comment">/// listView.bottom == listView.superview!.bottom - Metrics.BackButtonWidth</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleItem</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> equalSign = getEqualSign(line)</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">` <span class="subst">$&#123;equalSign&#125;</span> `</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> rightParts = parts[<span class="number">1</span>].trim()</span><br><span class="line">  <span class="keyword">let</span> right = rightParts.split(<span class="string">' '</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">let</span> number = rightParts.replace(right, <span class="string">''</span>).replace(<span class="string">'- '</span>, <span class="string">'-'</span>).trim()</span><br><span class="line">  <span class="keyword">if</span> (number.startsWith(<span class="string">'+ '</span>)) &#123;</span><br><span class="line">    number = number.slice(<span class="number">2</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> equal = getEqual(line)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (number == <span class="literal">null</span> || number.length == <span class="number">0</span> ) &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>: <span class="subst">$&#123;right&#125;</span>Anchor)`</span></span><br><span class="line">    ]</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> [</span><br><span class="line">      <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>: <span class="subst">$&#123;right&#125;</span>Anchor, constant: <span class="subst">$&#123;number&#125;</span>)`</span></span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: segmentedControl.height == 24</span></span><br><span class="line"><span class="comment">/// backButton.width == Metrics.BackButtonWidth</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleSize</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> equalSign = getEqualSign(line)</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">` <span class="subst">$&#123;equalSign&#125;</span> `</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = parts[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> equal = getEqual(line)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>Anchor.constraint(<span class="subst">$&#123;equal&#125;</span>Constant: <span class="subst">$&#123;right&#125;</span>)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: mapView.edges == listView.edges</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleEdges</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">' == '</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>].split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = removeLastPart(parts[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.topAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.topAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.bottomAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.bottomAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.leftAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.leftAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.rightAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.rightAnchor)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// For ex: mapView.center == listView.center</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleCenter</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = line.split(<span class="string">' == '</span>)</span><br><span class="line">  <span class="keyword">const</span> left = parts[<span class="number">0</span>].split(<span class="string">'.'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> right = removeLastPart(parts[<span class="number">1</span>])</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> [</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.centerXAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.centerXAnchor)`</span>,</span><br><span class="line">    <span class="string">`<span class="subst">$&#123;left&#125;</span>.centerYAnchor.constraint(equalTo: <span class="subst">$&#123;right&#125;</span>.centerYAnchor)`</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasPattern</span>(<span class="params">string, pattern</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">  <span class="keyword">let</span> matches = string.match(regex)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (matches == <span class="literal">null</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  matches = matches.filter(<span class="function">(<span class="params">match</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> match !== <span class="literal">undefined</span> &amp;&amp; match.length &gt; <span class="number">1</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> matches.length &gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeLastPart</span>(<span class="params">string</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> parts = string.split(<span class="string">'.'</span>)</span><br><span class="line">  parts.pop()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> parts.join(<span class="string">'.'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEqual</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'=='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'equalTo'</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&lt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'lessThanOrEqualTo'</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'greaterThanOrEqualTo'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getEqualSign</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (line.includes(<span class="string">'=='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'=='</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (line.includes(<span class="string">'&gt;='</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'&gt;='</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'&lt;='</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findIndentationLength</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> match.split(<span class="string">'constrain'</span>)[<span class="number">0</span>].length + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeIndentation</span>(<span class="params">length</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>(length).join(<span class="string">' '</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// For ex: constrain(tableView, headerView, view) &#123; tableView, headerView, superView in</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findSuperview</span>(<span class="params">match</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> line = match.split(<span class="string">'\n'</span>)[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">if</span> (!line.includes(<span class="string">' superView in'</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> pattern = <span class="string">', \\w*\\)'</span></span><br><span class="line">  <span class="keyword">const</span> regex = <span class="built_in">RegExp</span>(pattern)</span><br><span class="line">  <span class="keyword">const</span> string =  line.match(regex)[<span class="number">0</span>] <span class="comment">// `, view)</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> string.replace(<span class="string">', '</span>, <span class="string">''</span>).replace(<span class="string">')'</span>, <span class="string">''</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check special size keywords</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasSizeKeywords</span>(<span class="params">line</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> keywords = [<span class="string">'Metrics'</span>, <span class="string">'Dimensions'</span>, <span class="string">'UIScreen'</span>]</span><br><span class="line">  <span class="keyword">return</span> keywords.filter(<span class="function">(<span class="params">keyword</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> line.includes(keyword)</span><br><span class="line">  &#125;).length != <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T09:08:50.000Z" title="2019-05-21T09:08:50.000Z">2019-05-21</time><span class="level-item">a few seconds read (About 108 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-sort-strings-with-number-in-Javascript/">How to sort strings with number in Javascript</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/251">#251</a></strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sort</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> string = </span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="string">- Favorite WWDC 2017 sessions https://github.com/onmyway133/blog/issues/56</span></span><br><span class="line"><span class="string">- Favorite WWDC 2018 sessions https://github.com/onmyway133/blog/issues/245</span></span><br><span class="line"><span class="string">- How to do clustering with Google Maps in iOS https://github.com/onmyway133/blog/issues/191</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> lines = string</span><br><span class="line">        .split(<span class="string">'\n'</span>)</span><br><span class="line">        .filter(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123; <span class="keyword">return</span> line.length &gt; <span class="number">0</span> &#125;)</span><br><span class="line">        .map(<span class="function">(<span class="params">line</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> parts = line.trimEnd().split(<span class="string">' '</span>)</span><br><span class="line">            <span class="keyword">let</span> lastPart = parts[parts.length<span class="number">-1</span>]</span><br><span class="line">            <span class="keyword">let</span> number = lastPart.replace(<span class="string">'https://github.com/onmyway133/blog/issues/'</span>, <span class="string">''</span>)</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                line,</span><br><span class="line">                number: <span class="built_in">parseInt</span>(number)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    </span><br><span class="line">    lines.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (a.number &lt; b.number) ? <span class="number">-1</span> : <span class="number">1</span></span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> sortedString = lines</span><br><span class="line">        .map(<span class="function">(<span class="params">tuple</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> tuple.line</span><br><span class="line">        &#125;)</span><br><span class="line">        .join(<span class="string">'\n'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(sortedString)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then <code>node index.js</code></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T08:08:34.000Z" title="2019-05-21T08:08:34.000Z">2019-05-21</time><span class="level-item">a few seconds read (About 32 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-move-tab-bar-icons-down-in-iOS/">How to move tab bar icons down in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/250">#250</a></strong></p>
<p><code>UITabBarItem</code> subclasses from <code>UIBarItem</code> which has <code>imageInsets</code>. We need both <code>top</code> and <code>bottom</code> to avoid shrinking</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">viewController1.tabBarItem.imageInsets = <span class="type">UIEdgeInsets</span>(top: <span class="number">10</span>, <span class="keyword">left</span>: <span class="number">0</span>, bottom: -<span class="number">10</span>, <span class="keyword">right</span>: <span class="number">0</span>)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T06:48:44.000Z" title="2019-05-21T06:48:44.000Z">2019-05-21</time><span class="level-item">a minute read (About 142 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-test-LaunchScreen-in-iOS/">How to test LaunchScreen in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/249">#249</a></strong></p>
<p>Making splash screen with <code>LaunchScreen.storyboard</code> is now the default way to do in iOS. Testing it with UITests is a bit tricky as this screen is showed the system, and if we test that, we are just testing the system.</p>
<p>What we should test is the content we put in the LaunchScreen storyboard. Is it showing correctly on different screen sizes? Is it missing any texts or images?</p>
<p>One way to test that is via Unit Test. LaunchScreen storyboard always come with 1 <code>UIViewController</code> configured as an initial view controller</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LauncScreenTests</span>: <span class="title">XCTestCase</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">testLaunchScreen</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> launchScreen = <span class="type">UIStoryboard</span>(name: <span class="string">"LaunchScreen"</span>, bundle: <span class="literal">nil</span>)</span><br><span class="line">        <span class="keyword">let</span> viewController = launchScreen.instantiateInitialViewController()!</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> label = viewController.view.subviews.compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UILabel</span> &#125;).first!</span><br><span class="line">        <span class="type">XCTAssertEqual</span>(label.text, <span class="string">"Welcome to my app"</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> imageView = viewController.view.subviews.compactMap(&#123; $<span class="number">0</span> <span class="keyword">as</span>? <span class="type">UIImageView</span> &#125;).first!</span><br><span class="line">        <span class="type">XCTAssertNotNil</span>(imageView.image)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-21T05:40:26.000Z" title="2019-05-21T05:40:26.000Z">2019-05-21</time><span class="level-item">a minute read (About 121 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-remote-theme-for-GitHub-Pages/">How to use remote theme for GitHub Pages</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/248">#248</a></strong></p>
<p>Visit <a href="https://github.com/onmyway133/onmyway133.github.io">https://github.com/onmyway133/onmyway133.github.io</a></p>
<hr>
<p><a href="https://github.blog/2017-11-29-use-any-theme-with-github-pages/">https://github.blog/2017-11-29-use-any-theme-with-github-pages/</a></p>
<blockquote>
<p>Starting today, you can use any of the hundreds of community-curated themes on GitHub.com. To build your site with any public, GitHub-hosted theme, add the following to your site‚Äôs _config.yml file:</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">remote_theme: owner&#x2F;name</span><br></pre></td></tr></table></figure>

<p>Browse themes <a href="https://github.com/topics/jekyll-theme">https://github.com/topics/jekyll-theme</a><br>Example config file with navigation <a href="https://github.com/daviddarnes/alembic/blob/master/_config.yml">https://github.com/daviddarnes/alembic/blob/master/_config.yml</a></p>
<h2 id="Link-to-a-new-page"><a href="#Link-to-a-new-page" class="headerlink" title="Link to a new page"></a>Link to a new page</h2><p>Each page must have a description. Link must point to generated html file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apps: &#x2F;apps.html</span><br></pre></td></tr></table></figure>

<p>Do not specify <code>layout: default</code> to keep overall theme</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Another Page</span><br><span class="line">description:</span><br><span class="line">---</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-20T08:13:11.000Z" title="2019-05-20T08:13:11.000Z">2019-05-20</time><span class="level-item">a few seconds read (About 69 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-enable-black-mode-in-Google-Maps-in-iOS/">How to enable black mode in Google Maps in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/246">#246</a></strong></p>
<p>Use GMSMapStyle <a href="https://developers.google.com/maps/documentation/android-sdk/styling">https://developers.google.com/maps/documentation/android-sdk/styling</a><br>Export styling json from <a href="https://mapstyle.withgoogle.com/">https://mapstyle.withgoogle.com/</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mapStyleUrl = <span class="type">Bundle</span>.main.url(forResource: <span class="string">"mapStyle"</span>, withExtension: <span class="string">"json"</span>)!</span><br><span class="line">mapView.mapStyle = <span class="keyword">try</span>? <span class="type">GMSMapStyle</span>(contentsOfFileURL: mapStyleUrl)</span><br></pre></td></tr></table></figure>

<p>To change overall color, search for mostly <code>&quot;elementType&quot;: &quot;geometry&quot;</code> and <code>&quot;featureType&quot;: &quot;water&quot;</code></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"elementType"</span>: <span class="string">"geometry"</span>,</span><br><span class="line">    <span class="attr">"stylers"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"color"</span>: <span class="string">"#424242"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"featureType"</span>: <span class="string">"water"</span>,</span><br><span class="line">    <span class="attr">"elementType"</span>: <span class="string">"geometry"</span>,</span><br><span class="line">    <span class="attr">"stylers"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">"color"</span>: <span class="string">"#2E2E2E"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-19T16:33:17.000Z" title="2019-05-19T16:33:17.000Z">2019-05-19</time><span class="level-item">17 minutes read (About 2510 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Favorite-WWDC-2018-sessions/">Favorite WWDC 2018 sessions</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/245">#245</a></strong></p>
<p>Original post <a href="https://medium.com/fantageek/my-favourite-wwdc-2018-sessions-363d3fc9c9d5">https://medium.com/fantageek/my-favourite-wwdc-2018-sessions-363d3fc9c9d5</a></p>
<hr>
<h1 id="Favourite-WWDC-2018-sessions"><a href="#Favourite-WWDC-2018-sessions" class="headerlink" title="Favourite WWDC 2018 sessions"></a>Favourite WWDC 2018 sessions</h1><p>This year I failed the lottery ticket to WWDC, and I also missed the keynote live stream because I was <a href="https://twitter.com/onmyway133/status/1003584883116167169">sailing</a> on the Christian Radich outside Oslo fjord that day. Luckily all the videos are available on <a href="https://developer.apple.com/videos/wwdc2018/">Apple Developer site</a> very shortly, and we can watch them now on Chrome or the <a href="https://github.com/insidegui/WWDC">unofficial WWDC</a> app on macOS. I recommend the <a href="https://github.com/insidegui/WWDC">WWDC</a> macOS app as it allows to mark favourites and filter, also offers the ability to adjust play speed to 1.25 or 1.5 saves me some time watching.</p>
<p>This year WWDC focuses a lot on privacy, stability, and speed, which are all I wish, so many thanks to Apple engineers who made that happen, and the resit to install the so called <a href="https://twitter.com/bagelturf/status/1004444007424905216?s=21">more stable iOS 12</a> is real. As an iOS engineers, I like to focus more about the necessary things to me, that is about the Swift programming language, new changes in Cocoa Touch, enhancements in Xcode and testing tricks. I also like to explore more <a href="https://medium.com/flawless-app-stories/detecting-avengers-superheroes-in-your-ios-app-with-ibm-watson-and-coreml-fe38e493a4d1">about</a> <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-turi-create-and-coreml-5ddce0dc8e26">machine</a> <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-azure-custom-vision-and-coreml-645e93f35eee">learning</a> so I‚Äôm very glad that Apple is investing more into this technology with the introduction of Turi Create and Create ML.</p>
<p>To me, APIs come and get deprecated very often and it‚Äôs good to know them, but the most important thing is to invest in your programming, debugging and testing skill which you can apply in many other platforms.</p>
<p>Continued from last year <a href="https://medium.com/@onmyway133/my-favourite-wwdc-2017-sessions-a777fa5aabaf">favourites</a> list, below are my favourite sessions with personal notes. Things are listed in no particular order. Hope you find it useful.</p>
<h3 id="Platforms-State-of-the-Union"><a href="#Platforms-State-of-the-Union" class="headerlink" title="Platforms State of the Union"></a><a href="https://developer.apple.com/videos/play/wwdc2018/102/">Platforms State of the Union</a></h3><p>If you don‚Äôt have time, you should watch only this session. Platform State of the Union is like keynote for developers as it highlights important changes.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*5zkWPlmZ9oYfY9-O.jpg" alt=""></p>
<ul>
<li><p>Privacy: Apple confirms on its commitment in privacy and security, also introduces password management feature and auto fill on iOS 12. Generating strong password, integrating with 3rd password management and quickly populating OTP field from SMS message have never been easier. <a href="https://support.apple.com/en-us/HT202491">GateKeeper</a> gets some improvements as well and begins to require app to be notarised.</p>
</li>
<li><p>iOS 12: huge improvement in performance, Siri gets smarter with Shortcut support, group calling in FaceTime and grouped notification. Also for emoji fan, Memoji was introduced.</p>
</li>
<li><p>macOS 10.14 Mojave: more with Dark Mode. They demo mostly with Xcode in dark mode, which looks so cool. This year WWDC banner give hints about iOS and macOS cross-platform apps, which is partially true with <a href="https://www.imore.com/marzipan">Marzipan</a>, a way to allow iOS apps to run on the mac.</p>
</li>
<li><p>Xcode 10: with improvements in code editing and source control changes bar indicator. Debugging with memory debug tool, LLDB performance enhancement and particular the new build system completely rewritten in Swift with parallel tasks are exciting news.</p>
</li>
<li><p>Swift 4.2: if you follow swift repo then <a href="https://github.com/ole/whats-new-in-swift-4-2">Swift 4.2</a> may not be very surprising. There are also announcements for Swift 5 plan.</p>
</li>
<li><p>Machine Learning: is never hotter than this. This year we see huge investments in machine learning with Create ML, Turi Create, Natural Language frameworks, CoreML 2, new detection capabilities in Vision.</p>
</li>
<li><p>ARKit 2, watchOS 5, tvOS 12, AppStore Connect and AppStore Connect APIs are some other important news you don‚Äôt want to miss.</p>
</li>
</ul>
<h3 id="What‚Äôs-new-in-Swift"><a href="#What‚Äôs-new-in-Swift" class="headerlink" title="What‚Äôs new in Swift"></a><a href="https://developer.apple.com/videos/play/wwdc2018/401/">What‚Äôs new in Swift</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*JQCScM5dRcK9dX-_.jpg" alt=""></p>
<p>Together with this session, I recommend you to read <a href="https://www.hackingwithswift.com/articles/77/whats-new-in-swift-4-2">What‚Äôs new in Swift 4.2</a> summary which is very succinct. Besides improvement in complication and runtime, Swift 4.2 offers some new features: iterable enum case, synthesised Equatable and Hashable, handy functions for shuffling, random generating. To me, the need to explicitly handle Implicitly unwrapped optional is also a reasonable change.</p>
<h3 id="What‚Äôs-New-in-Cocoa-Touch"><a href="#What‚Äôs-New-in-Cocoa-Touch" class="headerlink" title="What‚Äôs New in Cocoa Touch"></a><a href="https://developer.apple.com/videos/play/wwdc2018/202/">What‚Äôs New in Cocoa Touch</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*n1X4HddAZ-4ZHpaf.jpg" alt=""></p>
<p>This is a brief introduction to all changes coming to iOS 12, together with tips on how to be a good iOS citizen. Learn what can affect scrolling experience and prefetching technique, memory consumption and automatic backing stores, how to get the best from UIImage and UIImageView . <a href="https://developer.apple.com/videos/play/wwdc2018/220/">AutoLayout</a> engine got a lot of performance improvement so it won‚Äôt bother you any more. To me the most satisfying is to get all the UIKit notifications and classes reorganised under nested types, which makes code reasoning very easy.</p>
<h3 id="Getting-the-Most-out-of-Playgrounds-in-Xcode"><a href="#Getting-the-Most-out-of-Playgrounds-in-Xcode" class="headerlink" title="Getting the Most out of Playgrounds in Xcode"></a><a href="https://developer.apple.com/videos/play/wwdc2018/402/">Getting the Most out of Playgrounds in Xcode</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*cl4xdnHojOq-PNBc.jpg" alt=""></p>
<p>I‚Äôve <a href="https://medium.com/flawless-app-stories/playground-driven-development-in-swift-cf167489fe7b">written about Playground</a> before and I‚Äôm very glad that Apple also invests a lot in it. The way people can interact and train model [Create ML](<a href="http://Introducing">http://Introducing</a> Create ML) in Playground is mesmerising. People may question how Playground works so well in session‚Äôs demos, but we can‚Äôt resist the new changes coming to Playground like Step by Step execution, markup rendering improvements and also how easy it is to consume custom frameworks. We can also now publish our own <a href="https://developer.apple.com/videos/play/wwdc2018/413/">Playground through subscription</a>.</p>
<h3 id="What‚Äôs-New-in-Core-ML"><a href="#What‚Äôs-New-in-Core-ML" class="headerlink" title="What‚Äôs New in Core ML"></a><a href="https://developer.apple.com/videos/play/wwdc2018/708/">What‚Äôs New in Core ML</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*1-xUL2gFr-Ys8WQT.jpg" alt=""></p>
<p>Apple starts the machine learning trend last year with the introduction of Core ML. We might be excited and frustrated at the same time as Core ML is powerful but there‚Äôs no way we can customise it. Now the <a href="https://developer.apple.com/videos/play/wwdc2018/708/">2</a> <a href="https://developer.apple.com/videos/play/wwdc2018/709/">parts</a> tell us how to implement custom layer and model, techniques to reduce model size like quantisation and flexible model. This makes the foundation for improvement in <a href="https://developer.apple.com/videos/play/wwdc2018/717/">Vision</a> in object tracking and the debut of <a href="https://developer.apple.com/videos/play/wwdc2018/713/">Natural Language</a> framework. Machine learning has never been easier.</p>
<h3 id="What‚Äôs-New-in-Testing"><a href="#What‚Äôs-New-in-Testing" class="headerlink" title="What‚Äôs New in Testing"></a><a href="https://developer.apple.com/videos/play/wwdc2018/403/">What‚Äôs New in Testing</a></h3><p>I can‚Äôt miss any testing sessions as it is part of every day‚Äôs work. How can your program avoids regression bugs and ready for refactoring without any tests?</p>
<p>This session shows improvement in coverage and the introduction of xccov tool to help us build automation on top of coverage report. Parallel distributed testing in Xcode 10 can save us some time to have coffee. Another wonderful news is that tests have multiple order execution mode to avoid bugs due to implicit dependencies.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*7Gw1utFOl4C3PKqV.jpg" alt=""></p>
<h3 id="Testing-Tips-amp-Tricks-üåü"><a href="#Testing-Tips-amp-Tricks-üåü" class="headerlink" title="Testing Tips &amp; Tricks üåü"></a><a href="https://developer.apple.com/videos/play/wwdc2018/417/">Testing Tips &amp; Tricks</a> üåü</h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*OHjJdWEhHj7Fc4rq.jpg" alt=""></p>
<p>This is my most favourite. The session starts with a pyramid of tests with unit integration and end-to-end test analogy explanation, then to some very cool tips and tricks.</p>
<ul>
<li>Testing network request: I like the separation of APIRequest and APIRequestLoader with URLSession , dependency injection with default parameter and the customisation of URLProtocol in URLSessionConfiguration</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2066/1*xJzqnw37CZKFhhMwym2HHQ.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2684/1*VUxjS-DpOfee7d5zTA1vrg.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2326/1*rgRwQla_YK3ADRwxZ4xpkg.png" alt=""></p>
<ul>
<li>Testing notification: Notification is system wide and I try to avoid it as much as possible. This shows how to inject dependency with default parameter and use of own NotificationCenter instead of NotificationCenter.default to ease testing</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2602/1*mXiNRzit8VcFM4_GNM3ebg.png" alt=""></p>
<ul>
<li><p>Testing location: build abstraction with LocationProvider and LocationFetcher . How to use custom protocol and protocol for delegate to mock during test</p>
</li>
<li><p>Testing timer: how to use and mock RunLoop behaviour with Timer</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*obf6GcsXcHAbGFy-lUENNw.png" alt=""></p>
<h3 id="Advanced-Debugging-with-Xcode-and-LLDB"><a href="#Advanced-Debugging-with-Xcode-and-LLDB" class="headerlink" title="Advanced Debugging with Xcode and LLDB"></a><a href="https://developer.apple.com/videos/play/wwdc2018/412/">Advanced Debugging with Xcode and LLDB</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*6c81NEXU7tKYPEbQ.jpg" alt=""></p>
<p>LLDB has been improved to enable to debugging reliability experience, issues with AST context corruption, Swift type resolution are now things in the past. We can review how to use some common LLDB commands with handy arguments, and how to use Xcode breakpoint to its best.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*ZtVpOaDnmt4VsDTHRiB6Ww.png" alt=""></p>
<h3 id="A-Tour-of-UICollectionView-üåü"><a href="#A-Tour-of-UICollectionView-üåü" class="headerlink" title="A Tour of UICollectionView üåü"></a><a href="https://developer.apple.com/videos/play/wwdc2018/225/">A Tour of UICollectionView</a> üåü</h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*skJgSTHlTohIj_DT.jpg" alt=""></p>
<p>I begin to use UICollectionView more than UITableView , and it also has same code as NSCollectionView,which is more comfortable solution than the horrible NSTableView .</p>
<ul>
<li>Item size in UICollectionViewLayout : I often rely on UICollectionViewDelegateFlowLayout to specify item size but after watching this session, I feel like moving size related code to Layout object feels more like a good way to go</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2718/1*FS6OykJZ_zIPTzaWPPYk6g.png" alt=""></p>
<ul>
<li><p>Mosaic layout: This is not new, but good to watch again. You learn how to implement custom layout using cached layout attributes</p>
</li>
<li><p>Data Source update: I didn‚Äôt expect Apple mentions this, but it is a good lesson on how UICollectionView handles batch update. I ‚Äòve written about this before in my <a href="https://medium.com/flawless-app-stories/a-better-way-to-update-uicollectionview-data-in-swift-with-diff-framework-924db158db86">A better way to update UICollectionView data in Swift with diff framework</a> and that post gets a lot of attractions. In this session we need to remember that *<em>ordering matters in data source update, but not in collection view update *</em>‚ùóÔ∏è‚ùóÔ∏è‚ùóÔ∏è</p>
</li>
</ul>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*VMqhNo3bXxI-79e-r9iNvA.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*KiWef6geZ3z0-jRaWNuqRg.png" alt=""></p>
<h3 id="Swift-Generics"><a href="#Swift-Generics" class="headerlink" title="Swift Generics"></a><a href="https://developer.apple.com/videos/play/wwdc2018/406/">Swift Generics</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*KWRTeiOV8FBNK3Mu.jpg" alt=""></p>
<p>Generic was a core feature of Swift since the beginning, we all know that it helps us to implement generic code that can work with many types in a type safe manner. This session reminds that I ‚Äòve never learned enough, especially the reasonable design behind it.</p>
<p>The sessions showcases Collection protocol and its protocol inheritances: MutableCollection , BidirectionalCollection , RandomAccessCollection and how they can be combined to provide generic functionalities for conformers. The associatedtype requirement in each protocol, especially Index and Element, is very minimal and has enough constraints for the protocol to implement lots of necessary functionalities in its protocol extension, which is eye opening for me. I very like to read open source, so looking at the <a href="https://github.com/apple/swift/blob/master/stdlib/public/core/BidirectionalCollection.swift">source code</a> for such protocols helps me understand more.</p>
<p><img src="https://cdn-images-1.medium.com/max/2102/1*QIepiAZqK4QmX2IbLFKz0w.png" alt=""></p>
<p>The part about <a href="https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle">Fisher Yates shuffle algorithm</a> details how we can come up with necessary protocol while still make them generic</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*actyrEg4E4qSFYu--K6uzA.png" alt=""></p>
<p>Pay attention to when they mention count and map , you can learn more how each concrete type can hook into the customisation point in protocol extension</p>
<p><img src="https://cdn-images-1.medium.com/max/2704/1*IG15tCSq49SqgvgJrXHDWw.png" alt=""></p>
<p>Finally learn the <a href="https://en.wikipedia.org/wiki/Liskov_substitution_principle">Liskov substitution principle</a> with protocol in class inheritance. You should also <a href="https://developer.apple.com/videos/play/wwdc2018/229/">Using Collections Effectively</a> for how to utilise handy functions in Collection.</p>
<p><img src="https://cdn-images-1.medium.com/max/2000/0*oIKcsw6-H37i2A1t.jpg" alt=""></p>
<h3 id="Data-You-Can-Trust"><a href="#Data-You-Can-Trust" class="headerlink" title="Data You Can Trust"></a><a href="https://developer.apple.com/videos/play/wwdc2018/222/">Data You Can Trust</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*Iv80a99O1g6k-oO4.jpg" alt=""></p>
<p>Although Codable has a lot to offers in term of data integrity, this is good to know about to make sure the data you receive is actually the right data in correct format and structure. <a href="https://twitter.com/mgratzer/status/1003882651038683136">CommonCrypto</a> is also part of new iOS SDK so you don‚Äôt need my <a href="https://github.com/onmyway133/Arcane">Arcane</a> library to handle encryption and hashing in your apps.</p>
<h3 id="Embracing-Algorithms"><a href="#Embracing-Algorithms" class="headerlink" title="Embracing Algorithms"></a><a href="https://developer.apple.com/videos/play/wwdc2018/223/">Embracing Algorithms</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*qocdXtZ8cCAJ0mKV.jpg" alt=""></p>
<p>This is the most pleasant to watch as it is like a conversation between the speaker and the imaginary manager Crusty. Here I learn how to be aware of algorithm complexity and also how to utilise built in Foundation functions which are already optimised for performance.</p>
<p>After this session I can‚Äôt help myself but going to Swift repo to read the <a href="https://github.com/apple/swift/blob/master/test/Prototypes/Algorithms.swift">Algorithms.swift</a> file immediately.</p>
<h3 id="Image-and-Graphics-Best-Practices"><a href="#Image-and-Graphics-Best-Practices" class="headerlink" title="Image and Graphics Best Practices"></a><a href="https://developer.apple.com/videos/play/wwdc2018/219/">Image and Graphics Best Practices</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*-qDMSLxL89PuOm-m.jpg" alt=""></p>
<p>Learn how image encoding and decoding works through data and image buffer and how that affects memory and performance. There are techniques like downsampling that can tackle this problem. This also recommends against using backing store, and instead, use UIImageView</p>
<p><img src="https://cdn-images-1.medium.com/max/2766/1*mt70wBlbwC9Kz18vXN5THQ.png" alt=""></p>
<p><img src="https://cdn-images-1.medium.com/max/2000/1*uV9Ata-pPnb-US3WrI6Y_A.png" alt=""></p>
<h3 id="A-Guide-to-Turi-Create"><a href="#A-Guide-to-Turi-Create" class="headerlink" title="A Guide to Turi Create"></a><a href="https://developer.apple.com/videos/play/wwdc2018/712/">A Guide to Turi Create</a></h3><p><img src="https://cdn-images-1.medium.com/max/2000/0*yWr3HKYpIslcV-Zz.jpg" alt=""></p>
<p>I‚Äôve <a href="https://medium.com/flawless-app-stories/machine-learning-in-ios-turi-create-and-coreml-5ddce0dc8e26">written about Turi Create</a> before, but it is just scratching the surface of the many tasks offered by Turi. This year Apple releases <a href="https://github.com/apple/turicreate/releases/tag/5.0b1">Turi Create 5</a> with style transfer task, Vision Feature Print, GPU acceleration and recommender model improvements. I can‚Äôt wait to explore. And if you take a look at MLDataTable in Create ML framework, it looks like this has Turi ‚Äòs SFrame under the hood.</p>
<p>That‚Äôs it. Thanks for reading. What are your favourite sessions this year? Please share in the comment section below</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-16T11:03:35.000Z" title="2019-05-16T11:03:35.000Z">2019-05-16</time><span class="level-item">a minute read (About 165 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-get-running-window-informations-in-macOS/">How to get running window informations in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/243">#243</a></strong></p>
<p>From <a href="https://developer.apple.com/documentation/coregraphics/1455137-cgwindowlistcopywindowinfo">https://developer.apple.com/documentation/coregraphics/1455137-cgwindowlistcopywindowinfo</a></p>
<blockquote>
<p>Generates and returns information about the selected windows in the current user session.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MyWindowInfo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> frame: <span class="type">CGRect</span></span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">let</span> pid: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">let</span> number: <span class="type">Int</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>?(json: [<span class="type">String</span>: <span class="type">Any</span>]) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> pid = json[<span class="string">"kCGWindowOwnerPID"</span>] <span class="keyword">as</span>? <span class="type">Int</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> name = json[<span class="string">"kCGWindowOwnerName"</span>] <span class="keyword">as</span>? <span class="type">String</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> rect = json[<span class="string">"kCGWindowBounds"</span>] <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> x = rect[<span class="string">"X"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> y = rect[<span class="string">"Y"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> height = rect[<span class="string">"Height"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> width = rect[<span class="string">"Width"</span>] <span class="keyword">as</span>? <span class="type">CGFloat</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> number = json[<span class="string">"kCGWindowNumber"</span>] <span class="keyword">as</span>? <span class="type">Int</span> <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">self</span>.pid = pid</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="keyword">self</span>.number = number</span><br><span class="line">        <span class="keyword">self</span>.frame = <span class="type">CGRect</span>(x: x, y: y, width: width, height: height)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">guard</span> <span class="keyword">let</span> jsons = <span class="type">CGWindowListCopyWindowInfo</span>(.optionAll, kCGNullWindowID) <span class="keyword">as</span>? [[<span class="type">String</span>: <span class="type">Any</span>]] <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> infos = jsons.compactMap(&#123; <span class="type">MyWindowInfo</span>(json: $<span class="number">0</span>) &#125;)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-16T10:20:45.000Z" title="2019-05-16T10:20:45.000Z">2019-05-16</time><span class="level-item">a few seconds read (About 42 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-show-full-screen-window-programmatically-in-macOS/">How to show full screen window programmatically in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/242">#242</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> window = <span class="type">NSWindow</span>(contentRect: mainScreen.frame, styleMask: .borderless, backing: .buffered, <span class="keyword">defer</span>: <span class="literal">false</span>)</span><br><span class="line">window.level = .floating</span><br><span class="line">window.contentView = <span class="type">NSView</span>()</span><br><span class="line">window.makeKeyAndOrderFront(<span class="type">NSApp</span>)</span><br><span class="line"><span class="type">NSApp</span>.activate(ignoringOtherApps: <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>

<p>and then later hide it</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.orderOut(<span class="type">NSApp</span>)</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-15T17:55:29.000Z" title="2019-05-15T17:55:29.000Z">2019-05-15</time><span class="level-item">11 minutes read (About 1661 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/Useful-git-commands-for-everyday-use!/">Useful git commands for everyday use!</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/239">#239</a></strong></p>
<p>Original post <a href="https://medium.com/flawless-app-stories/useful-git-commands-for-everyday-use-e1a4de64037d">https://medium.com/flawless-app-stories/useful-git-commands-for-everyday-use-e1a4de64037d</a></p>
<hr>
<p>Do you know that questions about <a href="https://stackoverflow.com/tags/git">git</a> get the most views on StackOverflow? I‚Äôve searched a lot on Google how to execute certain actions with git, and this actually slowed me down a lot. There are some actions that we tend to use a lot, so it‚Äôs good to learn them. Here are my favorites, learning from friends and internet, hope you find them useful.</p>
<p>Before we begin, you should run git ‚Äìversion to check your current git version, mine is 2.12.2 as in macOS High Sierra. <a href="https://git-scm.com/">Here</a> is the official git documentation, you can read details about git commands, parameters and new releases of git.</p>
<h2 id="Useful-commands"><a href="#Useful-commands" class="headerlink" title="Useful commands"></a>Useful commands</h2><h3 id="Diff"><a href="#Diff" class="headerlink" title="Diff"></a>Diff</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git diff feature&#x2F;my_branch develop &gt; file.diff</span><br><span class="line">git apply file.diff</span><br></pre></td></tr></table></figure>

<h3 id="üîç-Status"><a href="#üîç-Status" class="headerlink" title="üîç Status"></a>üîç Status</h3><p>Check the status of working directory and staging area:</p>
<pre><code>git status</code></pre><p>Show changes between HEAD and working directory:</p>
<pre><code>git diff</code></pre><p>Show the list of commits in one line format:</p>
<pre><code>git log --oneline</code></pre><p>Show commits that make add or remove a certain string:</p>
<pre><code>git log -S &apos;LoginViewController&apos;</code></pre><p>Search commits that contain a log message:</p>
<pre><code>git log ‚Äî all ‚Äî grep=‚Äôday of week‚Äô</code></pre><h3 id="üîç-Tag"><a href="#üîç-Tag" class="headerlink" title="üîç Tag"></a>üîç Tag</h3><p>List all tags:</p>
<pre><code>git tag</code></pre><p>Tag a commit:</p>
<pre><code>git tag -a 1.4 -m &quot;my version 1.4&quot;</code></pre><p>Delete remote tags:</p>
<pre><code>git push --delete origin tagname

git push origin :tagname</code></pre><p>Push tag to remote:</p>
<pre><code>git push origin tagname</code></pre><p>Rename tag:</p>
<pre><code>git tag new old
git tag -d old
git push origin :refs/tags/old
git push --tags</code></pre><p>Move tag from one commit to another commit:</p>
<pre><code>git push origin :refs/tags/&lt;tagname&gt;
git tag -fa tagname
git push origin master --tags</code></pre><h3 id="üîç-Remote"><a href="#üîç-Remote" class="headerlink" title="üîç Remote"></a>üîç Remote</h3><p>List all remote:</p>
<pre><code>git remote</code></pre><p>Rename remote:</p>
<pre><code>git remote rename old new</code></pre><p>Remove stale remote tracking branches:</p>
<pre><code>git remote prune origin</code></pre><h3 id="üîç-Branch"><a href="#üîç-Branch" class="headerlink" title="üîç Branch"></a>üîç Branch</h3><p>List all branches:</p>
<pre><code>git branch</code></pre><p>Create the branch on your local machine and switch in this branch:</p>
<pre><code>git checkout -b branch_name</code></pre><p>Create branch from commit:</p>
<pre><code>git branch branch_name sha1_of_commit</code></pre><p>Push the branch to remote:</p>
<pre><code>git push origin branch_name</code></pre><p>Rename other branch:</p>
<pre><code>git branch -m old new</code></pre><p>Rename current branch:</p>
<pre><code>git branch -m new</code></pre><p>Rename remote branch:</p>
<pre><code>git branch -m old new               # Rename branch locally    
git push origin :old                 # Delete the old branch    
git push --set-upstream origin new   # Push the new branch, set local branch to track the new remote</code></pre><p>Delete a branch:</p>
<pre><code>git branch -D the_local_branch

git push origin :the_remote_branch</code></pre><p>Delete all local branches but master</p>
<pre><code>git branch | grep -v &quot;master&quot; | xargs git branch -D</code></pre><h3 id="üîç-Commit"><a href="#üîç-Commit" class="headerlink" title="üîç Commit"></a>üîç Commit</h3><p>Undo last commit:</p>
<pre><code>git reset --hard HEAD~1</code></pre><p>Squash last n commits into one commit:</p>
<pre><code>git rebase -i HEAD~5

git reset --soft HEAD~5
git add .
git commit -m &quot;Update&quot;
git push -f origin master</code></pre><p>Move last commits into new branch:</p>
<pre><code>git branch newbranch
git reset --hard HEAD~3 # Go back 3 commits. You *will* lose uncommitted work.*1
git checkout newbranch</code></pre><p>Make changes to older commit</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git rebase -i HEAD^^^</span><br><span class="line">&#x2F;&#x2F; change from pick to edit, then :wq</span><br><span class="line">git add .</span><br><span class="line">git rebase --continue</span><br></pre></td></tr></table></figure>

<h3 id="üîç-Cherry-Pick"><a href="#üîç-Cherry-Pick" class="headerlink" title="üîç Cherry Pick"></a>üîç Cherry Pick</h3><p>Add some commits to the top of the current branch:</p>
<pre><code>git cherry-pick hash_commit_A hash_commit_B</code></pre><h3 id="üîç-Reflog"><a href="#üîç-Reflog" class="headerlink" title="üîç Reflog"></a>üîç Reflog</h3><p>Show reflog:</p>
<pre><code>git reflog</code></pre><p>Get commit:</p>
<pre><code>git reset --hard 0254ea7

git cherry-pick 12944d8</code></pre><h3 id="üîç-Revert"><a href="#üîç-Revert" class="headerlink" title="üîç Revert"></a>üîç Revert</h3><p>Revert the previous commit:</p>
<pre><code>git revert HEAD
git commit</code></pre><p>Revert the changes from previous 3 commits without making commit:</p>
<pre><code>git revert --no-commit HEAD~3..</code></pre><h3 id="üîç-Amend"><a href="#üîç-Amend" class="headerlink" title="üîç Amend"></a>üîç Amend</h3><p>Amend previous commit:</p>
<pre><code>git commit --amend

git commit --amend --no-edit

git commit --amend -m &quot;New commit message&quot;</code></pre><p><a href="http://stackoverflow.com/questions/8981194/changing-git-commit-message-after-push-given-that-no-one-pulled-from-remote">Changing git commit message after push</a>:</p>
<pre><code>git commit --amend -m &quot;New commit message&quot;
git push --force &lt;repository&gt; &lt;branch&gt;</code></pre><h3 id="üîç-Checkout"><a href="#üîç-Checkout" class="headerlink" title="üîç Checkout"></a>üîç Checkout</h3><p>Checkout a tag:</p>
<pre><code>git checkout tagname

git checkout -b newbranchname tagname</code></pre><p>Checkout a branch:</p>
<pre><code>git checkout destination_branch</code></pre><p>Use -m if there is merge conflict:</p>
<pre><code>git checkout -m master // from feature branch to master</code></pre><p>Checkout a commit:</p>
<pre><code>git checkout commit_hash

git checkout -b newbranchname HEAD~4

git checkout -b newbranchname commit_hash

git checkout commit_hash file</code></pre><p>Checkout a file:</p>
<pre><code>git checkout c5f567 -- Relative/Path/To/File</code></pre><h3 id="üîç-Stash"><a href="#üîç-Stash" class="headerlink" title="üîç Stash"></a>üîç Stash</h3><p>Save a change to stash:</p>
<pre><code>git stash save &quot;stash name&quot;

git stash</code></pre><p>List all stashes:</p>
<pre><code>git stash list</code></pre><p>Apply a stash:</p>
<pre><code>git stash pop

git stash apply

git stash apply stash@{2}</code></pre><h3 id="üîç-Rebase"><a href="#üîç-Rebase" class="headerlink" title="üîç Rebase"></a>üîç Rebase</h3><p>Rebase the current branch onto master:</p>
<pre><code>git rebase master // rebase the current branch onto master</code></pre><p>Continue rebase:</p>
<pre><code>git rebase --continue</code></pre><p>Abort rebase:</p>
<pre><code>git rebase --abort</code></pre><h3 id="üîç-gitignore"><a href="#üîç-gitignore" class="headerlink" title="üîç .gitignore"></a>üîç .gitignore</h3><p>Un-track files that have just been declared in .gitignore:</p>
<pre><code>git rm -r --cached .
git add .
git commit -am &quot;Remove ignored files&quot;</code></pre><h3 id="üîç-Index"><a href="#üîç-Index" class="headerlink" title="üîç Index"></a>üîç Index</h3><p>Remove untracked files:</p>
<pre><code>git clean</code></pre><p>Remove file from index:</p>
<pre><code>git reset file</code></pre><p>Reset the index to match the most recent commit:</p>
<pre><code>git reset</code></pre><p>Reset the index and the working directory to match the most recent commit:</p>
<pre><code>git reset --hard</code></pre><h3 id="üîç-Misc"><a href="#üîç-Misc" class="headerlink" title="üîç Misc"></a>üîç Misc</h3><p>Get their changes during git rebase:</p>
<pre><code>git checkout --ours foo/bar.java
git add foo/bar.java</code></pre><p>Get their changes during git merge:</p>
<pre><code>git pull -X theirs

git checkout --theirs path/to/the/conflicted_file.php

git checkout --theirs .
git add .

git checkout branchA
git merge -X theirs branchB</code></pre><p>Merge commits from master into feature branch:</p>
<pre><code>git checkout feature1
git merge --no-ff master</code></pre><p>Find bug in commit history in a binary search tree style:</p>
<pre><code>git bisect start

git bisect good

git bisect bad</code></pre><h2 id="Git-alias"><a href="#Git-alias" class="headerlink" title="Git alias"></a>Git alias</h2><p>If there are commands that you use a lot, then consider using git alias. This is how to make alias for git status, then you can just type git st:</p>
<pre><code>git config ‚Äî global alias.st status</code></pre><p>Alias configurations are stored in .gitconfig file, you can learn some cool aliases from <a href="https://github.com/thoughtbot/dotfiles/blob/master/gitconfig">thoughtbot</a> and <a href="https://github.com/mathiasbynens/dotfiles/blob/master/.gitconfig">mathiasbynens</a>.</p>
<h3 id="Delete-all-local-branches-except-master"><a href="#Delete-all-local-branches-except-master" class="headerlink" title="Delete all local branches except master"></a>Delete all local branches except master</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global alias.dlb &#39;!git branch | grep -v &quot;master&quot; | xargs git branch -D&#39;</span><br></pre></td></tr></table></figure>

<h3 id="Prune-upstream-branches"><a href="#Prune-upstream-branches" class="headerlink" title="Prune upstream branches"></a>Prune upstream branches</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global alias.pu &#39;remote prune upstream&#39;</span><br></pre></td></tr></table></figure>

<h2 id="GUI-clients"><a href="#GUI-clients" class="headerlink" title="GUI clients"></a>GUI clients</h2><p>Doing things in command line is cool and faster. However for viewing branches and commits, I find using a GUI client more visualizing and comfortable. You can see a list of all GUI clients <a href="https://git-scm.com/download/gui/mac">here</a>, I myself use <a href="https://www.sourcetreeapp.com/">SourceTree</a>.</p>
<p><img src="https://cdn-images-1.medium.com/max/2900/1*g2NL2JUXNAFWYrPydraqsg.png" alt=""></p>
<h2 id="Check-before-you-commit"><a href="#Check-before-you-commit" class="headerlink" title="Check before you commit"></a>Check before you commit</h2><p>We usually have some experiment code that we don‚Äôt want they to step into our commit. I usually mark my experiment with // <TEST> but sometimes forget to unstage that.</p>
<p>Starting with 2.9, Git has improvement on its commit hook which makes it globally using <strong><em>hooksPath.</em></strong></p>
<p>Firstly we nee to create a file called pre-commit, and place it into, for example, /Users/khoa/hooks:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># https://appventure.me/2016/04/04/prevent-accidental-test-code-commits/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> git rev-parse --verify HEAD &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">  against=HEAD</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="comment"># Initial commit: diff against an empty tree object</span></span><br><span class="line">  against=4b825dc642cb6eb9a060e54bf8d69288fbee4904</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The special marker tag to mark things which we still need to change</span></span><br><span class="line">marker=<span class="string">"&lt;TEST&gt;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Redirect output to stderr.</span></span><br><span class="line"><span class="built_in">exec</span> 1&gt;&amp;2</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> $(git diff --cached -z <span class="variable">$against</span> | grep <span class="variable">$marker</span> | wc -c) != 0 </span><br><span class="line"><span class="keyword">then</span></span><br><span class="line">    cat &lt;&lt;\EOF</span><br><span class="line">    Error: Still has invalid debug markers <span class="keyword">in</span> code:</span><br><span class="line">EOF</span><br><span class="line">    <span class="built_in">echo</span> `git diff --cached -z <span class="variable">$against</span> -G <span class="variable">$marker</span>`</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p>In your project, run git config core.hooksPath /Users/khoa/hooks.</p>
<p>Whenever you commit a file with that pattern, it won‚Äôt let you commit. For how to make this work in SourceTree, check:<br><a href="https://medium.com/@onmyway133/sourcetree-and-pre-commit-hook-52545f22fe10"><strong>SourceTree and pre commit hook</strong><br><em>Pre-commit file works perfectly in terminal, but SourceTree seems to ignore it. I use both terminal and SourceTree, as‚Ä¶</em>medium.com</a></p>
<h2 id="Where-to-go-from-here"><a href="#Where-to-go-from-here" class="headerlink" title="Where to go from here"></a>Where to go from here</h2><p>This is just scratching the surface of what git can do, if you want to learn more, here are some links to get started.</p>
<ul>
<li><a href="https://www.atlassian.com/git/tutorials/setting-up-a-repository">Atlassian Git Tutorial</a>: overview of how to set up a repository (repo) under Git version control</li>
<li><a href="https://github.com/arslanbilal/git-cheat-sheet">git-cheat-sheet</a>: Git cheat sheet saves you from learning all the commands by heart.</li>
<li><a href="http://www.learnenough.com/git-tutorial">Learn Enough Git to Be Dangerous</a></li>
<li><a href="http://www.toptal.com/git/git-workflows-for-pros-a-good-git-guide">Git Workflows for Pros: A Good Git Guide</a></li>
<li><a href="https://codewords.recurse.com/issues/two/git-from-the-inside-out">Git from the inside out</a>: The essay focuses on the graph structure that underpins Git</li>
<li><a href="https://github.com/git-game/git-game">git-game</a>: terminal game to test git skills</li>
<li><a href="https://www.youtube.com/watch?v=xbLVvrb2-fY">Introduction to Git ‚Äî talk by Scott Chacon</a></li>
<li><a href="http://www.raywenderlich.com/74258/git-tutorial-intermediate">Git Tutorial ‚Äî Git Fu With The Command Line</a></li>
<li><a href="http://gitimmersion.com/">Git Immersion</a>: The surest path to mastering Git is to immerse oneself in its utilities and operations, to experience it first-hand</li>
<li><a href="https://github.com/k88hudson/git-flight-rules">git-flight-rules</a> Flight rules for git</li>
<li><a href="https://github.com/nvie/gitflow">gitflow</a> Git extensions to provide high-level repository operations for Vincent Driessen‚Äôs branching model</li>
<li><a href="https://github.com/so-fancy/diff-so-fancy">diff-so-fancy</a> Good-lookin‚Äô diffs with diff-highlight and more</li>
<li><a href="https://github.com/tiimgreen/github-cheat-sheet">github-cheat-sheet</a> A list of cool features of Git and GitHub</li>
<li><a href="https://github.com/git-tips/tips">git tips</a> Most commonly used git tips and tricks</li>
<li><a href="https://csswizardry.com/2017/05/little-things-i-like-to-do-with-git/">Little Things I Like to Do with Git</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-15T17:46:15.000Z" title="2019-05-15T17:46:15.000Z">2019-05-15</time><span class="level-item">a few seconds read (About 46 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-work-around-app-damaged-warning-in-macOS/">How to work around app damaged warning in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/238">#238</a></strong></p>
<blockquote>
<p>‚ÄúApp‚Äù is damaged and can‚Äôt be opened. You should move it to the Trash. </p>
</blockquote>
<p>üëâ Disable gate keeper</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo spctl --master-disable</span><br><span class="line">spctl --status</span><br></pre></td></tr></table></figure>

<p>Current workaround is to remove Launch At Login handling code.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-15T06:00:57.000Z" title="2019-05-15T06:00:57.000Z">2019-05-15</time><span class="level-item">a minute read (About 142 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-shake-NSView-in-macOS/">How to shake NSView in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/233">#233</a></strong></p>
<h2 id="Animation-on-macOS-using-CAAnimation"><a href="#Animation-on-macOS-using-CAAnimation" class="headerlink" title="Animation on macOS using CAAnimation"></a>Animation on macOS using CAAnimation</h2><p>Shake</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> midX = box.layer?.position.x ?? <span class="number">0</span></span><br><span class="line"><span class="keyword">let</span> midY = box.layer?.position.y ?? <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: <span class="string">"position"</span>)</span><br><span class="line">animation.duration = <span class="number">0.06</span></span><br><span class="line">animation.repeatCount = <span class="number">4</span></span><br><span class="line">animation.autoreverses = <span class="literal">true</span></span><br><span class="line">animation.fromValue = <span class="type">CGPoint</span>(x: midX - <span class="number">10</span>, y: midY)</span><br><span class="line">animation.toValue = <span class="type">CGPoint</span>(x: midX + <span class="number">10</span>, y: midY)</span><br><span class="line">box.layer?.add(animation, forKey: <span class="string">"position"</span>)</span><br></pre></td></tr></table></figure>

<h2 id="Animation-on-macOS-using-NSAnimationContext"><a href="#Animation-on-macOS-using-NSAnimationContext" class="headerlink" title="Animation on macOS  using NSAnimationContext"></a>Animation on macOS  using NSAnimationContext</h2><p>Wiggle</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NSAnimationContext</span>.runAnimationGroup(&#123; context <span class="keyword">in</span></span><br><span class="line">    <span class="keyword">let</span> animation = <span class="type">CAKeyframeAnimation</span>(keyPath: <span class="string">"transform"</span>)</span><br><span class="line">    animation.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">5.0</span></span><br><span class="line">    animation.duration = <span class="number">0.1</span></span><br><span class="line">    animation.autoreverses = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">let</span> wobbleAngle: <span class="type">CGFloat</span> = <span class="number">0.08</span></span><br><span class="line">    animation.values = [</span><br><span class="line">        <span class="type">NSValue</span>(caTransform3D: <span class="type">CATransform3DMakeRotation</span>(wobbleAngle, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>)),</span><br><span class="line">        <span class="type">NSValue</span>(caTransform3D: <span class="type">CATransform3DMakeRotation</span>(-wobbleAngle, <span class="number">0.0</span>, <span class="number">0.0</span>, <span class="number">1.0</span>))</span><br><span class="line">    ]</span><br><span class="line">    view.layer?.add(animation, forKey: <span class="string">"transform"</span>)</span><br><span class="line">&#125;, completionHandler: &#123;</span><br><span class="line">    <span class="keyword">self</span>.makeAnimation(view: view)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="Animation-on-iOS-using-UIView-animation-block"><a href="#Animation-on-iOS-using-UIView-animation-block" class="headerlink" title="Animation on iOS using UIView animation  block"></a>Animation on iOS using UIView animation  block</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">shake</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.transform = <span class="type">CGAffineTransform</span>(translationX: <span class="number">16</span>, y: <span class="number">0</span>)</span><br><span class="line">        <span class="type">UIView</span>.animate(withDuration: <span class="number">0.4</span>, delay: <span class="number">0</span>, usingSpringWithDamping: <span class="number">0.2</span>, initialSpringVelocity: <span class="number">1</span>, options: .curveEaseInOut, animations: &#123;</span><br><span class="line">            <span class="keyword">self</span>.transform = <span class="type">CGAffineTransform</span>.identity</span><br><span class="line">        &#125;, completion: <span class="literal">nil</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-13T11:43:49.000Z" title="2019-05-13T11:43:49.000Z">2019-05-13</time><span class="level-item">a minute read (About 206 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-CAReplicatorLayer-to-make-activity-indicator-in-iOS/">How to use CAReplicatorLayer to make activity indicator in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/230">#230</a></strong></p>
<p><a href="https://developer.apple.com/documentation/quartzcore/careplicatorlayer">CAReplicatorLayer</a> is a layer that creates a specified number of sublayer copies with varying geometric, temporal, and color transformations</p>
<p>Here we use <code>instanceTransform</code> which applies transformation matrix around the center of the replicator layer</p>
<p>Below is how we use <code>replicatorLayer</code> to replicate lots of <code>line</code> and rotate them around the center.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> replicatorLayer = <span class="type">CAReplicatorLayer</span>()</span><br><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: #keyPath(<span class="type">CALayer</span>.opacity))</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> line = <span class="type">CALayer</span>()</span><br><span class="line"><span class="keyword">let</span> lineCount: <span class="type">Int</span> = <span class="number">12</span></span><br><span class="line"><span class="keyword">let</span> duration: <span class="type">TimeInterval</span> = <span class="number">1.0</span></span><br><span class="line"><span class="keyword">let</span> lineSize: <span class="type">CGSize</span> = <span class="type">CGSize</span>(width: <span class="number">20</span>, height: <span class="number">6</span>)</span><br><span class="line"><span class="keyword">let</span> lineColor: <span class="type">UIColor</span> = <span class="type">UIColor</span>.darkGray</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> angle = <span class="type">CGFloat</span>.pi * <span class="number">2</span> / <span class="type">CGFloat</span>(lineCount)</span><br><span class="line"><span class="keyword">let</span> rotation = <span class="type">CATransform3DMakeRotation</span>(angle, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1.0</span>)</span><br><span class="line"></span><br><span class="line">replicatorLayer.instanceTransform = rotation</span><br><span class="line">replicatorLayer.instanceCount = lineCount</span><br><span class="line">replicatorLayer.instanceDelay = duration / <span class="type">TimeInterval</span>(lineCount)</span><br><span class="line"></span><br><span class="line">line.backgroundColor = lineColor.cgColor</span><br><span class="line">line.frame.size = lineSize</span><br><span class="line">line.cornerRadius = lineSize.height / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">animation.fromValue = <span class="number">1.0</span></span><br><span class="line">animation.toValue = <span class="number">0.0</span></span><br><span class="line">animation.repeatCount = <span class="type">Float</span>.greatestFiniteMagnitude</span><br><span class="line">animation.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: .linear)</span><br><span class="line">animation.duration = duration</span><br><span class="line"></span><br><span class="line">replicatorLayer.addSublayer(line)</span><br><span class="line">layer.addSublayer(replicatorLayer)</span><br><span class="line"></span><br><span class="line"><span class="comment">// x: </span></span><br><span class="line"><span class="comment">// y: half the height, changing affects rotation of lines</span></span><br><span class="line">line.position = <span class="type">CGPoint</span>(x: <span class="number">48</span>, y: <span class="number">75</span>)</span><br><span class="line"></span><br><span class="line">line.add(animation, forKey: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure>

<p>Pay attention to <code>position</code> of the <code>line</code>. The larger the <code>x</code>, the closer to center. <code>y</code> should be half the height of the replicator layer size, changing it affects the skewness of the <code>line</code>.</p>
<img width="584" alt="indicator" src="https://user-images.githubusercontent.com/2284279/57626103-809f2100-7595-11e9-9851-2df8b6013757.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-13T10:20:29.000Z" title="2019-05-13T10:20:29.000Z">2019-05-13</time><span class="level-item">a minute read (About 114 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-do-rotation-for-CALayer-in-iOS/">How to do rotation for CALayer in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/229">#229</a></strong></p>
<h2 id="Use-keypath"><a href="#Use-keypath" class="headerlink" title="Use keypath"></a>Use keypath</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animation = <span class="type">CASpringAnimation</span>(keyPath: #keyPath(<span class="type">CALayer</span>.transform))</span><br><span class="line">animation.fromValue = <span class="number">0</span></span><br><span class="line">animation.valueFunction = <span class="type">CAValueFunction</span>(name: <span class="type">CAValueFunctionName</span>.rotateZ)</span><br><span class="line">animation.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: .easeIn)</span><br><span class="line"></span><br><span class="line">animation.toValue = <span class="type">CGFloat</span>.pi / <span class="number">4</span></span><br></pre></td></tr></table></figure>

<h2 id="Avoid-setting-frame-many-times"><a href="#Avoid-setting-frame-many-times" class="headerlink" title="Avoid setting frame many times"></a>Avoid setting frame many times</h2><p>Otherwise, <code>frame</code> is the box that covers the rotation transform, and <code>backgroundColor</code> now fills that huge box</p>
<p><img src="https://user-images.githubusercontent.com/2284279/57622665-67df3d00-758e-11e9-9e4c-f2baec78b4af.jpg" alt="abc"></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.layoutSubviews()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">guard</span> line.frame.width &lt;= <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">    	<span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    line.backgroundColor = <span class="type">UIColor</span>.red.cgColor</span><br><span class="line">    line.cornerRadius = <span class="number">3</span></span><br><span class="line">	line.frame.size = <span class="type">CGSize</span>(width: bounds.width*<span class="number">0.6</span>, height: <span class="number">6</span>)</span><br><span class="line">    line.position = layer.position</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Auto-Layout"><a href="#Auto-Layout" class="headerlink" title="Auto Layout"></a>Auto Layout</h2><p>Avoid using Auto Layout for the rotated view</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-13T09:17:43.000Z" title="2019-05-13T09:17:43.000Z">2019-05-13</time><span class="level-item">a minute read (About 171 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-not-use-isRemovedOnCompletion-for-CAAnimation-in-iOS/">How to not use isRemovedOnCompletion for CAAnimation in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/228">#228</a></strong></p>
<p>CAAnimation is about presentation layer, after animation completes, the view snaps back to its original state. If we want to keep the state after animation, then the wrong way is to use <code>CAMediaTimingFillMode.forward</code> and <code>isRemovedOnCompletion</code></p>
<h2 id="Animation-never-ends"><a href="#Animation-never-ends" class="headerlink" title="Animation never ends"></a>Animation never ends</h2><p><code>forwards</code> <a href="https://developer.apple.com/documentation/quartzcore/camediatimingfillmode/1427658-forwards">https://developer.apple.com/documentation/quartzcore/camediatimingfillmode/1427658-forwards</a></p>
<blockquote>
<p>The receiver remains visible in its final state when the animation is completed.</p>
</blockquote>
<p><code>isRemovedOnCompletion</code></p>
<p><a href="https://developer.apple.com/documentation/quartzcore/caanimation/1412458-isremovedoncompletion">https://developer.apple.com/documentation/quartzcore/caanimation/1412458-isremovedoncompletion</a></p>
<blockquote>
<p>When true, the animation is removed from the target layer‚Äôs animations once its active duration has passed. Defaults to true.</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">layer.fillMode = .forwards</span><br><span class="line">animation. isRemovedOnCompletion = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<p>This is to tell the animation to never ends and keep its last presentation state. Wrong approach ‚ùóÔ∏è</p>
<h2 id="Set-final-state-before-calling-animation"><a href="#Set-final-state-before-calling-animation" class="headerlink" title="Set final state before calling animation"></a>Set final state before calling animation</h2><p>The presentation state is just for animation, the source of truth lies in the layer itself. We need to set the final state before calling animation</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> animation = <span class="type">CABasicAnimation</span>(keyPath: #keyPath(<span class="type">CAShapeLayer</span>.strokeEnd))</span><br><span class="line"></span><br><span class="line">shapeLayer.strokeEnd = <span class="number">1.0</span></span><br><span class="line">shapeLayer.add(animation, forKey: <span class="string">""</span>)</span><br></pre></td></tr></table></figure>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T12:30:28.000Z" title="2019-05-07T12:30:28.000Z">2019-05-07</time><span class="level-item">a minute read (About 223 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-simple-search-box-in-iOS/">How to make simple search box in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/227">#227</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">SearchBox</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> textField: <span class="type">UITextField</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> textField = <span class="type">UITextField</span>()</span><br><span class="line">        <span class="keyword">let</span> imageView = <span class="type">UIImageView</span>(image: <span class="type">R</span>.image.search()!)</span><br><span class="line">        imageView.frame.size = <span class="type">CGSize</span>(width: <span class="number">20</span> + <span class="number">8</span>, height: <span class="number">20</span>)</span><br><span class="line">        imageView.contentMode = .scaleAspectFit</span><br><span class="line">        textField.leftView = imageView</span><br><span class="line">        textField.leftViewMode = .always</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> textField</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> filterButton: <span class="type">UIButton</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> button = <span class="type">UIButton</span>(type: .custom)</span><br><span class="line">        button.setImage(<span class="type">R</span>.image.<span class="built_in">filter</span>()!, <span class="keyword">for</span>: .normal)</span><br><span class="line">        button.imageEdgeInsets = <span class="type">UIEdgeInsets</span>(top: <span class="number">10</span>, <span class="keyword">left</span>: <span class="number">10</span>, bottom: <span class="number">10</span>, <span class="keyword">right</span>: <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> button</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> backView: <span class="type">UIView</span> = &#123;</span><br><span class="line">        <span class="keyword">let</span> view = <span class="type">UIView</span>()</span><br><span class="line">        view.backgroundColor = .white</span><br><span class="line">        view.layer.cornerRadius = <span class="number">10</span></span><br><span class="line">        view.layer.borderColor = <span class="type">R</span>.color.lightGray.cgColor</span><br><span class="line">        view.layer.borderWidth = <span class="number">0.5</span></span><br><span class="line">        view.layer.shadowOffset = <span class="type">CGSize</span>(width: <span class="number">1</span>, height: <span class="number">1</span>)</span><br><span class="line">        view.layer.shadowOpacity = <span class="number">0.8</span></span><br><span class="line">        view.layer.shadowColor = <span class="type">R</span>.color.lightGray.cgColor</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> view</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(frame: <span class="type">CGRect</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(frame: frame)</span><br><span class="line"></span><br><span class="line">        setup()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</span><br><span class="line">        <span class="built_in">fatalError</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">setup</span><span class="params">()</span></span> &#123;</span><br><span class="line">        addSubviews([backView, textField, filterButton])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            filterButton.rightAnchor.constraint(equalTo: rightAnchor, constant: -<span class="number">8</span>),</span><br><span class="line">            filterButton.centerYAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line">            filterButton.heightAnchor.constraint(equalToConstant: <span class="number">44</span>),</span><br><span class="line">            filterButton.widthAnchor.constraint(equalToConstant: <span class="number">44</span>),</span><br><span class="line"></span><br><span class="line">            textField.centerYAnchor.constraint(equalTo: centerYAnchor),</span><br><span class="line">            textField.leftAnchor.constraint(equalTo: leftAnchor, constant: <span class="number">16</span>),</span><br><span class="line">            textField.rightAnchor.constraint(equalTo: filterButton.leftAnchor, constant: -<span class="number">8</span>)</span><br><span class="line">        ])</span><br><span class="line"></span><br><span class="line">        <span class="type">NSLayoutConstraint</span>.on([</span><br><span class="line">            backView.pinEdges(view: <span class="keyword">self</span>, inset: <span class="type">UIEdgeInsets</span>(top: <span class="number">4</span>, <span class="keyword">left</span>: <span class="number">4</span>, bottom: -<span class="number">4</span>, <span class="keyword">right</span>: -<span class="number">4</span>))</span><br><span class="line">        ])</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>To apply padding to <code>leftView</code>, increase <code>width</code> and use <code>contentMode</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">imageView.frame.size = <span class="type">CGSize</span>(width: <span class="number">20</span> + <span class="number">8</span>, height: <span class="number">20</span>)</span><br><span class="line">imageView.contentMode = .scaleAspectFit</span><br></pre></td></tr></table></figure>

<p>To make image in button smaller, use <code>imageEdgeInsets</code> with all positive values<br>To have round and shadow, specify <code>shadowOpacity</code>, <code>cornerRadius</code>, <code>shadowOffset</code></p>
<img width="584" alt="searchbox" src="https://user-images.githubusercontent.com/2284279/57307753-6a045000-70e5-11e9-9f2d-db5835f5b21b.png">
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T10:43:16.000Z" title="2019-05-07T10:43:16.000Z">2019-05-07</time><span class="level-item">a few seconds read (About 27 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-capture-video-in-iOS-simulator/">How to capture video in iOS simulator</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/226">#226</a></strong></p>
<p>Take screenshot</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl io booted screenshot image.png</span><br></pre></td></tr></table></figure>

<p>Record video</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl io booted recordVideo video.mp4</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T07:17:28.000Z" title="2019-05-07T07:17:28.000Z">2019-05-07</time><span class="level-item">a minute read (About 127 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-use-custom-fonts-in-iOS/">How to use custom fonts in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/225">#225</a></strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>UIAppFonts<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Bold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-BoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-ExtraBold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-ExtraBoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Italic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Light.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-LightItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-Regular.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-SemiBold.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>OpenSans-SemiBoldItalic.ttf<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Read <a href="https://developer.apple.com/documentation/uikit/text_display_and_fonts/adding_a_custom_font_to_your_app">Adding a Custom Font to Your App</a></p>
<blockquote>
<p>The name of the font isn‚Äôt always obvious, and rarely matches the font file name. A quick way to find the font name is to get the list of fonts available to your app, which you can do with the following code:</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> family <span class="keyword">in</span> <span class="type">UIFont</span>.familyNames.sorted() &#123;</span><br><span class="line">    <span class="keyword">let</span> names = <span class="type">UIFont</span>.fontNames(forFamilyName: family)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Family: \(family) Font names: \(names)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-07T06:54:17.000Z" title="2019-05-07T06:54:17.000Z">2019-05-07</time><span class="level-item">a minute read (About 146 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-create-UITabBarController-programmatically-in-iOS/">How to create UITabBarController programmatically in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/224">#224</a></strong></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> tabBarController = <span class="type">UITabBarController</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> navigationController1 = <span class="type">UINavigationController</span>(rootViewController: viewController1)</span><br><span class="line"><span class="keyword">let</span> navigationController2 = <span class="type">UINavigationController</span>(rootViewController: viewController2)</span><br><span class="line"><span class="keyword">let</span> navigationController3 = <span class="type">UINavigationController</span>(rootViewController: viewController3)</span><br><span class="line"></span><br><span class="line">navigationController2.isNavigationBarHidden = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">navigationController1.tabBarItem.image = <span class="type">R</span>.image.profile()</span><br><span class="line">navigationController2.tabBarItem.image = <span class="type">R</span>.image.books()</span><br><span class="line">navigationController3.tabBarItem.image = <span class="type">R</span>.image.settings()</span><br><span class="line"></span><br><span class="line">tabBarController.tabBar.tintColor = .yellow</span><br><span class="line">tabBarController.viewControllers = [navigationController1, navigationController2, navigationController3]</span><br></pre></td></tr></table></figure>

<p>Use <code>tintColor</code> instead of the deprecated <code>selectedImageTintColor</code> to indicate selected item color.</p>
<p>For icon size, check <a href="https://developer.apple.com/design/human-interface-guidelines/ios/icons-and-images/custom-icons/">Tab Bar Icon Size</a>, usually 50x50 for 2x and 75x75 for 3x</p>
<blockquote>
<p>In portrait orientation, tab bar icons appear above tab titles. In landscape orientation, the icons and titles appear side-by-side. Depending on the device and orientation, the system displays either a regular or compact tab bar. Your app should include custom tab bar icons for both sizes.</p>
</blockquote>
<img width="769" alt="tab" src="https://user-images.githubusercontent.com/2284279/57286819-71f8cb80-70b6-11e9-937e-a3572fb3bb57.png">

</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-02T18:19:25.000Z" title="2019-05-02T18:19:25.000Z">2019-05-02</time><span class="level-item">a few seconds read (About 73 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-run-AppleScript-in-macOS/">How to run AppleScript in macOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/223">#223</a></strong></p>
<h2 id="Surround-script-by-single-quotes"><a href="#Surround-script-by-single-quotes" class="headerlink" title="Surround script by single quotes"></a>Surround script by single quotes</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> script = </span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">tell application "XcodeWay"</span></span><br><span class="line"><span class="string">    activate</span></span><br><span class="line"><span class="string">end tell</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> command = <span class="string">"osascript -e '\(script)'"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> process = <span class="type">Process</span>()</span><br><span class="line">process.launchPath = <span class="string">"/bin/bash"</span></span><br><span class="line">process.arguments = [<span class="string">"-c"</span>, command]</span><br></pre></td></tr></table></figure>

<h2 id="Run-as-administrator"><a href="#Run-as-administrator" class="headerlink" title="Run as administrator"></a>Run as administrator</h2><p>In terminal, we can</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~&#x2F;Library</span><br><span class="line">sudo mkdir MyNewFolder</span><br></pre></td></tr></table></figure>

<p>In code, we use <code>with administrator privileges</code>, this when run will ask for password or fingerprint</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">do shell script &quot;mkdir MyNewFolder&quot; with administrator privileges</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-05-02T05:57:54.000Z" title="2019-05-02T05:57:54.000Z">2019-05-02</time><span class="level-item">2 minutes read (About 270 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-make-simple-networking-client-in-Swift/">How to make simple networking client in Swift</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/222">#222</a></strong></p>
<p>For more mature networking, visit <a href="https://github.com/onmyway133/Miami">https://github.com/onmyway133/Miami</a></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">NetworkClient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> session: <span class="type">URLSession</span></span><br><span class="line">    <span class="keyword">let</span> baseUrl: <span class="type">URL</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">init</span>(session: <span class="type">URLSession</span> = .shared, baseUrl: <span class="type">URL</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.session = session</span><br><span class="line">        <span class="keyword">self</span>.baseUrl = baseUrl</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">make</span><span class="params">(options: Options, completion: @escaping <span class="params">(Result&lt;Data, Error&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> request = options.toRequest(baseUrl: baseUrl) <span class="keyword">else</span> &#123;</span><br><span class="line">            completion(.failure(<span class="type">AppError</span>.request))</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> task = session.dataTask(with: request, completionHandler: &#123; data, <span class="number">_</span>, error <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">let</span> data = data &#123;</span><br><span class="line">                completion(.success(data))</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</span><br><span class="line">                completion(.failure(error))</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                completion(.failure(<span class="type">AppError</span>.unknown))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        task.resume()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">makeJson</span><span class="params">(options: Options, completion: @escaping <span class="params">(Result&lt;[String: <span class="keyword">Any</span>], Error&gt;)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</span><br><span class="line">        make(options: options, completion: &#123; result <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">let</span> mapped = result.flatMap(&#123; data -&gt; <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt; <span class="keyword">in</span></span><br><span class="line">                <span class="keyword">do</span> &#123;</span><br><span class="line">                    <span class="keyword">let</span> json = <span class="keyword">try</span> <span class="type">JSONSerialization</span>.jsonObject(with: data, options: [])</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> json = json <span class="keyword">as</span>? [<span class="type">String</span>: <span class="type">Any</span>] &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt;.success(json)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt;.failure(<span class="type">AppError</span>.parse)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="type">Result</span>&lt;[<span class="type">String</span>: <span class="type">Any</span>], <span class="type">Error</span>&gt;.failure(error)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">            completion(mapped)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Options</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> path: <span class="type">String</span> = <span class="string">""</span></span><br><span class="line">    <span class="keyword">var</span> httpMethod: <span class="type">HttpMethod</span> = .<span class="keyword">get</span></span><br><span class="line">    <span class="keyword">var</span> parameters: [<span class="type">String</span>: <span class="type">Any</span>] = [:]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">toRequest</span><span class="params">(baseUrl: URL)</span></span> -&gt; <span class="type">URLRequest?</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> url = baseUrl.appendingPathComponent(path)</span><br><span class="line">        <span class="keyword">let</span> items: [<span class="type">URLQueryItem</span>] = parameters.<span class="built_in">map</span>(&#123; tuple -&gt; <span class="type">URLQueryItem</span> <span class="keyword">in</span></span><br><span class="line">            <span class="keyword">return</span> <span class="type">URLQueryItem</span>(name: tuple.key, value: <span class="string">"\(tuple.value)"</span>)</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> components = <span class="type">URLComponents</span>(url: url, resolvingAgainstBaseURL: <span class="literal">false</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> httpMethod == .<span class="keyword">get</span> &#123;</span><br><span class="line">            components?.queryItems = items</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> finalUrl = components?.url <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> request = <span class="type">URLRequest</span>(url: finalUrl)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> httpMethod == .post &#123;</span><br><span class="line">            <span class="keyword">let</span> data = <span class="keyword">try</span>? <span class="type">JSONSerialization</span>.data(withJSONObject: parameters, options: [])</span><br><span class="line">            request.httpBody = data</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        request.httpMethod = httpMethod.rawValue</span><br><span class="line">        <span class="keyword">return</span> request</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">AppError</span>: <span class="title">Error</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> request</span><br><span class="line">    <span class="keyword">case</span> unknown</span><br><span class="line">    <span class="keyword">case</span> parse</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">HttpMethod</span>: <span class="title">String</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="keyword">get</span> = <span class="string">"GET"</span></span><br><span class="line">    <span class="keyword">case</span> put = <span class="string">"PUT"</span></span><br><span class="line">    <span class="keyword">case</span> post = <span class="string">"POST"</span></span><br><span class="line">    <span class="keyword">case</span> patch = <span class="string">"PATCH"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2019-04-30T11:17:03.000Z" title="2019-04-30T11:17:03.000Z">2019-04-30</time><span class="level-item">a few seconds read (About 30 words)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/blog/How-to-ignore-App-Transport-Security-in-iOS/">How to ignore App Transport Security in iOS</a></h1><div class="content"><p><strong>Issue <a href="https://github.com/onmyway133/blog/issues/221">#221</a></strong></p>
<h2 id="Ignore-a-host"><a href="#Ignore-a-host" class="headerlink" title="Ignore a host"></a>Ignore a host</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAppTransportSecurity<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionDomains<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">key</span>&gt;</span>example.com<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSIncludesSubdomains<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionAllowsInsecureHTTPLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionRequiresForwardSecrecy<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSExceptionMinimumTLSVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>TLSv1.2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionAllowsInsecureHTTPLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionRequiresForwardSecrecy<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSThirdPartyExceptionMinimumTLSVersion<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">string</span>&gt;</span>TLSv1.2<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSRequiresCertificateTransparency<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Ignore-all"><a href="#Ignore-all" class="headerlink" title="Ignore all"></a>Ignore all</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAppTransportSecurity<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>NSAllowsArbitraryLoads<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure></div></article></div><nav class="pagination is-centered mt-4" role="navigation" aria-label="pagination"><div class="pagination-previous"><a href="/page/15/">Previous</a></div><div class="pagination-next"><a href="/page/17/">Next</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link" href="/">1</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/15/">15</a></li><li><a class="pagination-link is-current" href="/page/16/">16</a></li><li><a class="pagination-link" href="/page/17/">17</a></li><li><span class="pagination-ellipsis">&hellip;</span></li><li><a class="pagination-link" href="/page/23/">23</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="" src="https://avatars1.githubusercontent.com/u/2284279?s=460&amp;v=4" alt="onmyway133"></figure><p class="title is-size-4 is-block line-height-inherit">onmyway133</p><p class="is-size-6 is-block">iOS, macOS, Android, React. Serial maker. Writer. Speaker.</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Oslo, Norway</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">679</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">52</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/onmyway133" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com/onmyway133"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile is-mobile" href="https://onmyway133.com/apps" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Apps</span></span><span class="level-right"><span class="level-item tag">onmyway133.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://learntalks.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Learn Talks</span></span><span class="level-right"><span class="level-item tag">learntalks.com</span></span></a></li><li><a class="level is-mobile is-mobile" href="https://wwdctogether.com" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">WWDC Together</span></span><span class="level-right"><span class="level-item tag">wwdctogether.com</span></span></a></li></ul></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-31T06:45:13.000Z">2020-12-31</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-disable-scrolling-in-NSTextView-for-macOS/">How to disable scrolling in NSTextView for macOS</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-31T05:16:15.000Z">2020-12-31</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-override-attribute-string-in-Swift/">How to override attribute string in Swift</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-31T04:32:35.000Z">2020-12-31</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-make-view-appear-with-delay-in-SwiftUI/">How to make view appear with delay in SwiftUI</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-31T04:11:06.000Z">2020-12-31</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-make-attributed-string-Text-in-SwiftUI-for-macOS/">How to make attributed string Text in SwiftUI for macOS</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-12-30T04:30:52.000Z">2020-12-30</time></p><p class="title is-6"><a class="link-muted" href="/blog/How-to-do-copy-paste-delete-in-Swift-for-macOS/">How to do copy paste delete in Swift for macOS</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">December 2020</span></span><span class="level-end"><span class="level-item tag">29</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">15</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/10/"><span class="level-start"><span class="level-item">October 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/09/"><span class="level-start"><span class="level-item">September 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/08/"><span class="level-start"><span class="level-item">August 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">20</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">30</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">36</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/11/"><span class="level-start"><span class="level-item">November 2019</span></span><span class="level-end"><span class="level-item tag">38</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/10/"><span class="level-start"><span class="level-item">October 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/09/"><span class="level-start"><span class="level-item">September 2019</span></span><span class="level-end"><span class="level-item tag">50</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">39</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">41</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">49</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/04/"><span class="level-start"><span class="level-item">April 2019</span></span><span class="level-end"><span class="level-item tag">27</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/03/"><span class="level-start"><span class="level-item">March 2019</span></span><span class="level-end"><span class="level-item tag">24</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2019/02/"><span class="level-start"><span class="level-item">February 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/12/"><span class="level-start"><span class="level-item">December 2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/05/"><span class="level-start"><span class="level-item">May 2018</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/04/"><span class="level-start"><span class="level-item">April 2018</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/02/"><span class="level-start"><span class="level-item">February 2018</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2018/01/"><span class="level-start"><span class="level-item">January 2018</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/12/"><span class="level-start"><span class="level-item">December 2017</span></span><span class="level-end"><span class="level-item tag">14</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/11/"><span class="level-start"><span class="level-item">November 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/10/"><span class="level-start"><span class="level-item">October 2017</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/09/"><span class="level-start"><span class="level-item">September 2017</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/08/"><span class="level-start"><span class="level-item">August 2017</span></span><span class="level-end"><span class="level-item tag">9</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/07/"><span class="level-start"><span class="level-item">July 2017</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/06/"><span class="level-start"><span class="level-item">June 2017</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/05/"><span class="level-start"><span class="level-item">May 2017</span></span><span class="level-end"><span class="level-item tag">35</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2017/04/"><span class="level-start"><span class="level-item">April 2017</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/algorithm/"><span class="tag">algorithm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">android</span><span class="tag is-grey-lightest">34</span></a></div><div class="control"><a class="tags has-addons" href="/tags/apple-script/"><span class="tag">apple script</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/catalyst/"><span class="tag">catalyst</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ci/"><span class="tag">ci</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cloud/"><span class="tag">cloud</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cocoapods/"><span class="tag">cocoapods</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/combine/"><span class="tag">combine</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/core-data/"><span class="tag">core data</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/csharp/"><span class="tag">csharp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/css/"><span class="tag">css</span><span class="tag is-grey-lightest">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dart/"><span class="tag">dart</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/database/"><span class="tag">database</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/design/"><span class="tag">design</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/electron/"><span class="tag">electron</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/firebase/"><span class="tag">firebase</span><span class="tag is-grey-lightest">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/flutter/"><span class="tag">flutter</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/go/"><span class="tag">go</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/google/"><span class="tag">google</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/iOS/"><span class="tag">iOS</span><span class="tag is-grey-lightest">166</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag is-grey-lightest">50</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kotlin/"><span class="tag">kotlin</span><span class="tag is-grey-lightest">27</span></a></div><div class="control"><a class="tags has-addons" href="/tags/layout/"><span class="tag">layout</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/life/"><span class="tag">life</span><span class="tag is-grey-lightest">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/links/"><span class="tag">links</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/macOS/"><span class="tag">macOS</span><span class="tag is-grey-lightest">119</span></a></div><div class="control"><a class="tags has-addons" href="/tags/machine-learning/"><span class="tag">machine learning</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/maps/"><span class="tag">maps</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/networking/"><span class="tag">networking</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/node/"><span class="tag">node</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/objc/"><span class="tag">objc</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react/"><span class="tag">react</span><span class="tag is-grey-lightest">23</span></a></div><div class="control"><a class="tags has-addons" href="/tags/react-native/"><span class="tag">react native</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/realm/"><span class="tag">realm</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rx/"><span class="tag">rx</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/script/"><span class="tag">script</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spm/"><span class="tag">spm</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swift/"><span class="tag">swift</span><span class="tag is-grey-lightest">323</span></a></div><div class="control"><a class="tags has-addons" href="/tags/swiftUI/"><span class="tag">swiftUI</span><span class="tag is-grey-lightest">78</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tech/"><span class="tag">tech</span><span class="tag is-grey-lightest">14</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag is-grey-lightest">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag is-grey-lightest">17</span></a></div><div class="control"><a class="tags has-addons" href="/tags/tool/"><span class="tag">tool</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/unity/"><span class="tag">unity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/voip/"><span class="tag">voip</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/watchOS/"><span class="tag">watchOS</span><span class="tag is-grey-lightest">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/web/"><span class="tag">web</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/work/"><span class="tag">work</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/wwdc/"><span class="tag">wwdc</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xcode/"><span class="tag">xcode</span><span class="tag is-grey-lightest">24</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe to Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=c2r59mmt2n5k0o5dt5vv3nq4u4&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="c2r59mmt2n5k0o5dt5vv3nq4u4" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button is-primary" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/z.png" alt="onmyway133" height="28"></a><p class="size-small"><span>&copy; 2020 Khoa Pham</span>¬†¬†Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>¬†&amp;¬†<a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/onmyway133"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://onmyway133.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">√ó</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>